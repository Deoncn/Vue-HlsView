(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function Yn(e,t){const r=Object.create(null),i=e.split(",");for(let n=0;n<i.length;n++)r[i[n]]=!0;return t?n=>!!r[n.toLowerCase()]:n=>!!r[n]}function ot(e){if(fe(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],n=we(i)?Ka(i):ot(i);if(n)for(const s in n)t[s]=n[s]}return t}else{if(we(e))return e;if(Ae(e))return e}}const Ua=/;(?![^(]*\))/g,ja=/:([^]+)/,Ga=/\/\*.*?\*\//gs;function Ka(e){const t={};return e.replace(Ga,"").split(Ua).forEach(r=>{if(r){const i=r.split(ja);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function lt(e){let t="";if(we(e))t=e;else if(fe(e))for(let r=0;r<e.length;r++){const i=lt(e[r]);i&&(t+=i+" ")}else if(Ae(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Ha="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Va=Yn(Ha);function _s(e){return!!e||e===""}const De=e=>we(e)?e:e==null?"":fe(e)||Ae(e)&&(e.toString===Rs||!ge(e.toString))?JSON.stringify(e,As,2):String(e),As=(e,t)=>t&&t.__v_isRef?As(e,t.value):Jt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,n])=>(r[`${i} =>`]=n,r),{})}:Ls(t)?{[`Set(${t.size})`]:[...t.values()]}:Ae(t)&&!fe(t)&&!Ds(t)?String(t):t,_e={},Qt=[],et=()=>{},za=()=>!1,Wa=/^on[^a-z]/,Jr=e=>Wa.test(e),$n=e=>e.startsWith("onUpdate:"),Fe=Object.assign,Xn=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},qa=Object.prototype.hasOwnProperty,Ee=(e,t)=>qa.call(e,t),fe=Array.isArray,Jt=e=>Zr(e)==="[object Map]",Ls=e=>Zr(e)==="[object Set]",ge=e=>typeof e=="function",we=e=>typeof e=="string",Qn=e=>typeof e=="symbol",Ae=e=>e!==null&&typeof e=="object",ks=e=>Ae(e)&&ge(e.then)&&ge(e.catch),Rs=Object.prototype.toString,Zr=e=>Rs.call(e),Ya=e=>Zr(e).slice(8,-1),Ds=e=>Zr(e)==="[object Object]",Jn=e=>we(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,jr=Yn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),en=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},$a=/-(\w)/g,ut=en(e=>e.replace($a,(t,r)=>r?r.toUpperCase():"")),Xa=/\B([A-Z])/g,qt=en(e=>e.replace(Xa,"-$1").toLowerCase()),tn=en(e=>e.charAt(0).toUpperCase()+e.slice(1)),pn=en(e=>e?`on${tn(e)}`:""),Sr=(e,t)=>!Object.is(e,t),Gr=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},zr=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},_r=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ti;const Qa=()=>Ti||(Ti=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let it;class Ja{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=it,!t&&it&&(this.index=(it.scopes||(it.scopes=[])).push(this)-1)}run(t){if(this.active){const r=it;try{return it=this,t()}finally{it=r}}}on(){it=this}off(){it=this.parent}stop(t){if(this.active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this.active=!1}}}function Za(e,t=it){t&&t.active&&t.effects.push(e)}const Zn=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Cs=e=>(e.w&Rt)>0,ws=e=>(e.n&Rt)>0,eo=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Rt},to=e=>{const{deps:t}=e;if(t.length){let r=0;for(let i=0;i<t.length;i++){const n=t[i];Cs(n)&&!ws(n)?n.delete(e):t[r++]=n,n.w&=~Rt,n.n&=~Rt}t.length=r}},Dn=new WeakMap;let pr=0,Rt=1;const Cn=30;let Je;const zt=Symbol(""),wn=Symbol("");class ei{constructor(t,r=null,i){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,Za(this,i)}run(){if(!this.active)return this.fn();let t=Je,r=Lt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Je,Je=this,Lt=!0,Rt=1<<++pr,pr<=Cn?eo(this):bi(this),this.fn()}finally{pr<=Cn&&to(this),Rt=1<<--pr,Je=this.parent,Lt=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Je===this?this.deferStop=!0:this.active&&(bi(this),this.onStop&&this.onStop(),this.active=!1)}}function bi(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Lt=!0;const Is=[];function or(){Is.push(Lt),Lt=!1}function lr(){const e=Is.pop();Lt=e===void 0?!0:e}function ze(e,t,r){if(Lt&&Je){let i=Dn.get(e);i||Dn.set(e,i=new Map);let n=i.get(r);n||i.set(r,n=Zn()),xs(n)}}function xs(e,t){let r=!1;pr<=Cn?ws(e)||(e.n|=Rt,r=!Cs(e)):r=!e.has(Je),r&&(e.add(Je),Je.deps.push(e))}function pt(e,t,r,i,n,s){const f=Dn.get(e);if(!f)return;let _=[];if(t==="clear")_=[...f.values()];else if(r==="length"&&fe(e)){const b=_r(i);f.forEach((a,E)=>{(E==="length"||E>=b)&&_.push(a)})}else switch(r!==void 0&&_.push(f.get(r)),t){case"add":fe(e)?Jn(r)&&_.push(f.get("length")):(_.push(f.get(zt)),Jt(e)&&_.push(f.get(wn)));break;case"delete":fe(e)||(_.push(f.get(zt)),Jt(e)&&_.push(f.get(wn)));break;case"set":Jt(e)&&_.push(f.get(zt));break}if(_.length===1)_[0]&&In(_[0]);else{const b=[];for(const a of _)a&&b.push(...a);In(Zn(b))}}function In(e,t){const r=fe(e)?e:[...e];for(const i of r)i.computed&&Si(i);for(const i of r)i.computed||Si(i)}function Si(e,t){(e!==Je||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const ro=Yn("__proto__,__v_isRef,__isVue"),Os=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Qn)),no=ti(),io=ti(!1,!0),so=ti(!0),_i=ao();function ao(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=Te(this);for(let s=0,f=this.length;s<f;s++)ze(i,"get",s+"");const n=i[t](...r);return n===-1||n===!1?i[t](...r.map(Te)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){or();const i=Te(this)[t].apply(this,r);return lr(),i}}),e}function ti(e=!1,t=!1){return function(i,n,s){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&s===(e?t?_o:Bs:t?Ns:Ms).get(i))return i;const f=fe(i);if(!e&&f&&Ee(_i,n))return Reflect.get(_i,n,s);const _=Reflect.get(i,n,s);return(Qn(n)?Os.has(n):ro(n))||(e||ze(i,"get",n),t)?_:Ne(_)?f&&Jn(n)?_:_.value:Ae(_)?e?Us(_):vt(_):_}}const oo=Ps(),lo=Ps(!0);function Ps(e=!1){return function(r,i,n,s){let f=r[i];if(nr(f)&&Ne(f)&&!Ne(n))return!1;if(!e&&(!Wr(n)&&!nr(n)&&(f=Te(f),n=Te(n)),!fe(r)&&Ne(f)&&!Ne(n)))return f.value=n,!0;const _=fe(r)&&Jn(i)?Number(i)<r.length:Ee(r,i),b=Reflect.set(r,i,n,s);return r===Te(s)&&(_?Sr(n,f)&&pt(r,"set",i,n):pt(r,"add",i,n)),b}}function uo(e,t){const r=Ee(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&pt(e,"delete",t,void 0),i}function co(e,t){const r=Reflect.has(e,t);return(!Qn(t)||!Os.has(t))&&ze(e,"has",t),r}function fo(e){return ze(e,"iterate",fe(e)?"length":zt),Reflect.ownKeys(e)}const Fs={get:no,set:oo,deleteProperty:uo,has:co,ownKeys:fo},ho={get:so,set(e,t){return!0},deleteProperty(e,t){return!0}},go=Fe({},Fs,{get:io,set:lo}),ri=e=>e,rn=e=>Reflect.getPrototypeOf(e);function Pr(e,t,r=!1,i=!1){e=e.__v_raw;const n=Te(e),s=Te(t);r||(t!==s&&ze(n,"get",t),ze(n,"get",s));const{has:f}=rn(n),_=i?ri:r?si:Ar;if(f.call(n,t))return _(e.get(t));if(f.call(n,s))return _(e.get(s));e!==n&&e.get(t)}function Fr(e,t=!1){const r=this.__v_raw,i=Te(r),n=Te(e);return t||(e!==n&&ze(i,"has",e),ze(i,"has",n)),e===n?r.has(e):r.has(e)||r.has(n)}function Mr(e,t=!1){return e=e.__v_raw,!t&&ze(Te(e),"iterate",zt),Reflect.get(e,"size",e)}function Ai(e){e=Te(e);const t=Te(this);return rn(t).has.call(t,e)||(t.add(e),pt(t,"add",e,e)),this}function Li(e,t){t=Te(t);const r=Te(this),{has:i,get:n}=rn(r);let s=i.call(r,e);s||(e=Te(e),s=i.call(r,e));const f=n.call(r,e);return r.set(e,t),s?Sr(t,f)&&pt(r,"set",e,t):pt(r,"add",e,t),this}function ki(e){const t=Te(this),{has:r,get:i}=rn(t);let n=r.call(t,e);n||(e=Te(e),n=r.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return n&&pt(t,"delete",e,void 0),s}function Ri(){const e=Te(this),t=e.size!==0,r=e.clear();return t&&pt(e,"clear",void 0,void 0),r}function Nr(e,t){return function(i,n){const s=this,f=s.__v_raw,_=Te(f),b=t?ri:e?si:Ar;return!e&&ze(_,"iterate",zt),f.forEach((a,E)=>i.call(n,b(a),b(E),s))}}function Br(e,t,r){return function(...i){const n=this.__v_raw,s=Te(n),f=Jt(s),_=e==="entries"||e===Symbol.iterator&&f,b=e==="keys"&&f,a=n[e](...i),E=r?ri:t?si:Ar;return!t&&ze(s,"iterate",b?wn:zt),{next(){const{value:v,done:d}=a.next();return d?{value:v,done:d}:{value:_?[E(v[0]),E(v[1])]:E(v),done:d}},[Symbol.iterator](){return this}}}}function Et(e){return function(...t){return e==="delete"?!1:this}}function po(){const e={get(s){return Pr(this,s)},get size(){return Mr(this)},has:Fr,add:Ai,set:Li,delete:ki,clear:Ri,forEach:Nr(!1,!1)},t={get(s){return Pr(this,s,!1,!0)},get size(){return Mr(this)},has:Fr,add:Ai,set:Li,delete:ki,clear:Ri,forEach:Nr(!1,!0)},r={get(s){return Pr(this,s,!0)},get size(){return Mr(this,!0)},has(s){return Fr.call(this,s,!0)},add:Et("add"),set:Et("set"),delete:Et("delete"),clear:Et("clear"),forEach:Nr(!0,!1)},i={get(s){return Pr(this,s,!0,!0)},get size(){return Mr(this,!0)},has(s){return Fr.call(this,s,!0)},add:Et("add"),set:Et("set"),delete:Et("delete"),clear:Et("clear"),forEach:Nr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Br(s,!1,!1),r[s]=Br(s,!0,!1),t[s]=Br(s,!1,!0),i[s]=Br(s,!0,!0)}),[e,r,t,i]}const[vo,mo,yo,Eo]=po();function ni(e,t){const r=t?e?Eo:yo:e?mo:vo;return(i,n,s)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?i:Reflect.get(Ee(r,n)&&n in i?r:i,n,s)}const To={get:ni(!1,!1)},bo={get:ni(!1,!0)},So={get:ni(!0,!1)},Ms=new WeakMap,Ns=new WeakMap,Bs=new WeakMap,_o=new WeakMap;function Ao(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Lo(e){return e.__v_skip||!Object.isExtensible(e)?0:Ao(Ya(e))}function vt(e){return nr(e)?e:ii(e,!1,Fs,To,Ms)}function ko(e){return ii(e,!1,go,bo,Ns)}function Us(e){return ii(e,!0,ho,So,Bs)}function ii(e,t,r,i,n){if(!Ae(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=n.get(e);if(s)return s;const f=Lo(e);if(f===0)return e;const _=new Proxy(e,f===2?i:r);return n.set(e,_),_}function Zt(e){return nr(e)?Zt(e.__v_raw):!!(e&&e.__v_isReactive)}function nr(e){return!!(e&&e.__v_isReadonly)}function Wr(e){return!!(e&&e.__v_isShallow)}function js(e){return Zt(e)||nr(e)}function Te(e){const t=e&&e.__v_raw;return t?Te(t):e}function Gs(e){return zr(e,"__v_skip",!0),e}const Ar=e=>Ae(e)?vt(e):e,si=e=>Ae(e)?Us(e):e;function Ks(e){Lt&&Je&&(e=Te(e),xs(e.dep||(e.dep=Zn())))}function Hs(e,t){e=Te(e),e.dep&&In(e.dep)}function Ne(e){return!!(e&&e.__v_isRef===!0)}function ht(e){return Vs(e,!1)}function Ro(e){return Vs(e,!0)}function Vs(e,t){return Ne(e)?e:new Do(e,t)}class Do{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:Te(t),this._value=r?t:Ar(t)}get value(){return Ks(this),this._value}set value(t){const r=this.__v_isShallow||Wr(t)||nr(t);t=r?t:Te(t),Sr(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Ar(t),Hs(this))}}function re(e){return Ne(e)?e.value:e}const Co={get:(e,t,r)=>re(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const n=e[t];return Ne(n)&&!Ne(r)?(n.value=r,!0):Reflect.set(e,t,r,i)}};function zs(e){return Zt(e)?e:new Proxy(e,Co)}var Ws;class wo{constructor(t,r,i,n){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Ws]=!1,this._dirty=!0,this.effect=new ei(t,()=>{this._dirty||(this._dirty=!0,Hs(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const t=Te(this);return Ks(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Ws="__v_isReadonly";function Io(e,t,r=!1){let i,n;const s=ge(e);return s?(i=e,n=et):(i=e.get,n=e.set),new wo(i,n,s||!n,r)}function kt(e,t,r,i){let n;try{n=i?e(...i):e()}catch(s){nn(s,t,r)}return n}function Ye(e,t,r,i){if(ge(e)){const s=kt(e,t,r,i);return s&&ks(s)&&s.catch(f=>{nn(f,t,r)}),s}const n=[];for(let s=0;s<e.length;s++)n.push(Ye(e[s],t,r,i));return n}function nn(e,t,r,i=!0){const n=t?t.vnode:null;if(t){let s=t.parent;const f=t.proxy,_=r;for(;s;){const a=s.ec;if(a){for(let E=0;E<a.length;E++)if(a[E](e,f,_)===!1)return}s=s.parent}const b=t.appContext.config.errorHandler;if(b){kt(b,null,10,[e,f,_]);return}}xo(e,r,n,i)}function xo(e,t,r,i=!0){console.error(e)}let Lr=!1,xn=!1;const Me=[];let at=0;const er=[];let ft=null,jt=0;const qs=Promise.resolve();let ai=null;function sn(e){const t=ai||qs;return e?t.then(this?e.bind(this):e):t}function Oo(e){let t=at+1,r=Me.length;for(;t<r;){const i=t+r>>>1;kr(Me[i])<e?t=i+1:r=i}return t}function oi(e){(!Me.length||!Me.includes(e,Lr&&e.allowRecurse?at+1:at))&&(e.id==null?Me.push(e):Me.splice(Oo(e.id),0,e),Ys())}function Ys(){!Lr&&!xn&&(xn=!0,ai=qs.then(Xs))}function Po(e){const t=Me.indexOf(e);t>at&&Me.splice(t,1)}function Fo(e){fe(e)?er.push(...e):(!ft||!ft.includes(e,e.allowRecurse?jt+1:jt))&&er.push(e),Ys()}function Di(e,t=Lr?at+1:0){for(;t<Me.length;t++){const r=Me[t];r&&r.pre&&(Me.splice(t,1),t--,r())}}function $s(e){if(er.length){const t=[...new Set(er)];if(er.length=0,ft){ft.push(...t);return}for(ft=t,ft.sort((r,i)=>kr(r)-kr(i)),jt=0;jt<ft.length;jt++)ft[jt]();ft=null,jt=0}}const kr=e=>e.id==null?1/0:e.id,Mo=(e,t)=>{const r=kr(e)-kr(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function Xs(e){xn=!1,Lr=!0,Me.sort(Mo);const t=et;try{for(at=0;at<Me.length;at++){const r=Me[at];r&&r.active!==!1&&kt(r,null,14)}}finally{at=0,Me.length=0,$s(),Lr=!1,ai=null,(Me.length||er.length)&&Xs()}}function No(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||_e;let n=r;const s=t.startsWith("update:"),f=s&&t.slice(7);if(f&&f in i){const E=`${f==="modelValue"?"model":f}Modifiers`,{number:v,trim:d}=i[E]||_e;d&&(n=r.map(L=>we(L)?L.trim():L)),v&&(n=r.map(_r))}let _,b=i[_=pn(t)]||i[_=pn(ut(t))];!b&&s&&(b=i[_=pn(qt(t))]),b&&Ye(b,e,6,n);const a=i[_+"Once"];if(a){if(!e.emitted)e.emitted={};else if(e.emitted[_])return;e.emitted[_]=!0,Ye(a,e,6,n)}}function Qs(e,t,r=!1){const i=t.emitsCache,n=i.get(e);if(n!==void 0)return n;const s=e.emits;let f={},_=!1;if(!ge(e)){const b=a=>{const E=Qs(a,t,!0);E&&(_=!0,Fe(f,E))};!r&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!s&&!_?(Ae(e)&&i.set(e,null),null):(fe(s)?s.forEach(b=>f[b]=null):Fe(f,s),Ae(e)&&i.set(e,f),f)}function an(e,t){return!e||!Jr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ee(e,t[0].toLowerCase()+t.slice(1))||Ee(e,qt(t))||Ee(e,t))}let Pe=null,on=null;function qr(e){const t=Pe;return Pe=e,on=e&&e.type.__scopeId||null,t}function Ct(e){on=e}function wt(){on=null}function Re(e,t=Pe,r){if(!t||e._n)return e;const i=(...n)=>{i._d&&Bi(-1);const s=qr(t);let f;try{f=e(...n)}finally{qr(s),i._d&&Bi(1)}return f};return i._n=!0,i._c=!0,i._d=!0,i}function vn(e){const{type:t,vnode:r,proxy:i,withProxy:n,props:s,propsOptions:[f],slots:_,attrs:b,emit:a,render:E,renderCache:v,data:d,setupState:L,ctx:k,inheritAttrs:m}=e;let o,c;const l=qr(e);try{if(r.shapeFlag&4){const y=n||i;o=st(E.call(y,y,v,s,L,d,k)),c=b}else{const y=t;o=st(y.length>1?y(s,{attrs:b,slots:_,emit:a}):y(s,null)),c=t.props?b:Bo(b)}}catch(y){Er.length=0,nn(y,e,1),o=ue($e)}let p=o;if(c&&m!==!1){const y=Object.keys(c),{shapeFlag:h}=p;y.length&&h&7&&(f&&y.some($n)&&(c=Uo(c,f)),p=Dt(p,c))}return r.dirs&&(p=Dt(p),p.dirs=p.dirs?p.dirs.concat(r.dirs):r.dirs),r.transition&&(p.transition=r.transition),o=p,qr(l),o}const Bo=e=>{let t;for(const r in e)(r==="class"||r==="style"||Jr(r))&&((t||(t={}))[r]=e[r]);return t},Uo=(e,t)=>{const r={};for(const i in e)(!$n(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function jo(e,t,r){const{props:i,children:n,component:s}=e,{props:f,children:_,patchFlag:b}=t,a=s.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&b>=0){if(b&1024)return!0;if(b&16)return i?Ci(i,f,a):!!f;if(b&8){const E=t.dynamicProps;for(let v=0;v<E.length;v++){const d=E[v];if(f[d]!==i[d]&&!an(a,d))return!0}}}else return(n||_)&&(!_||!_.$stable)?!0:i===f?!1:i?f?Ci(i,f,a):!0:!!f;return!1}function Ci(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let n=0;n<i.length;n++){const s=i[n];if(t[s]!==e[s]&&!an(r,s))return!0}return!1}function Go({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const Ko=e=>e.__isSuspense;function Ho(e,t){t&&t.pendingBranch?fe(e)?t.effects.push(...e):t.effects.push(e):Fo(e)}function Kr(e,t){if(Oe){let r=Oe.provides;const i=Oe.parent&&Oe.parent.provides;i===r&&(r=Oe.provides=Object.create(i)),r[e]=t}}function gt(e,t,r=!1){const i=Oe||Pe;if(i){const n=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(n&&e in n)return n[e];if(arguments.length>1)return r&&ge(t)?t.call(i.proxy):t}}function Vo(e,t){return li(e,null,{flush:"post"})}const Ur={};function tr(e,t,r){return li(e,t,r)}function li(e,t,{immediate:r,deep:i,flush:n,onTrack:s,onTrigger:f}=_e){const _=Oe;let b,a=!1,E=!1;if(Ne(e)?(b=()=>e.value,a=Wr(e)):Zt(e)?(b=()=>e,i=!0):fe(e)?(E=!0,a=e.some(p=>Zt(p)||Wr(p)),b=()=>e.map(p=>{if(Ne(p))return p.value;if(Zt(p))return Ht(p);if(ge(p))return kt(p,_,2)})):ge(e)?t?b=()=>kt(e,_,2):b=()=>{if(!(_&&_.isUnmounted))return v&&v(),Ye(e,_,3,[d])}:b=et,t&&i){const p=b;b=()=>Ht(p())}let v,d=p=>{v=c.onStop=()=>{kt(p,_,4)}},L;if(Dr)if(d=et,t?r&&Ye(t,_,3,[b(),E?[]:void 0,d]):b(),n==="sync"){const p=Bl();L=p.__watcherHandles||(p.__watcherHandles=[])}else return et;let k=E?new Array(e.length).fill(Ur):Ur;const m=()=>{if(c.active)if(t){const p=c.run();(i||a||(E?p.some((y,h)=>Sr(y,k[h])):Sr(p,k)))&&(v&&v(),Ye(t,_,3,[p,k===Ur?void 0:E&&k[0]===Ur?[]:k,d]),k=p)}else c.run()};m.allowRecurse=!!t;let o;n==="sync"?o=m:n==="post"?o=()=>Ke(m,_&&_.suspense):(m.pre=!0,_&&(m.id=_.uid),o=()=>oi(m));const c=new ei(b,o);t?r?m():k=c.run():n==="post"?Ke(c.run.bind(c),_&&_.suspense):c.run();const l=()=>{c.stop(),_&&_.scope&&Xn(_.scope.effects,c)};return L&&L.push(l),l}function zo(e,t,r){const i=this.proxy,n=we(e)?e.includes(".")?Js(i,e):()=>i[e]:e.bind(i,i);let s;ge(t)?s=t:(s=t.handler,r=t);const f=Oe;ir(this);const _=li(n,s.bind(i),r);return f?ir(f):Wt(),_}function Js(e,t){const r=t.split(".");return()=>{let i=e;for(let n=0;n<r.length&&i;n++)i=i[r[n]];return i}}function Ht(e,t){if(!Ae(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Ne(e))Ht(e.value,t);else if(fe(e))for(let r=0;r<e.length;r++)Ht(e[r],t);else if(Ls(e)||Jt(e))e.forEach(r=>{Ht(r,t)});else if(Ds(e))for(const r in e)Ht(e[r],t);return e}function Wo(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return xr(()=>{e.isMounted=!0}),na(()=>{e.isUnmounting=!0}),e}const qe=[Function,Array],qo={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:qe,onEnter:qe,onAfterEnter:qe,onEnterCancelled:qe,onBeforeLeave:qe,onLeave:qe,onAfterLeave:qe,onLeaveCancelled:qe,onBeforeAppear:qe,onAppear:qe,onAfterAppear:qe,onAppearCancelled:qe},setup(e,{slots:t}){const r=fn(),i=Wo();let n;return()=>{const s=t.default&&ta(t.default(),!0);if(!s||!s.length)return;let f=s[0];if(s.length>1){for(const m of s)if(m.type!==$e){f=m;break}}const _=Te(e),{mode:b}=_;if(i.isLeaving)return mn(f);const a=wi(f);if(!a)return mn(f);const E=On(a,_,i,r);Pn(a,E);const v=r.subTree,d=v&&wi(v);let L=!1;const{getTransitionKey:k}=a.type;if(k){const m=k();n===void 0?n=m:m!==n&&(n=m,L=!0)}if(d&&d.type!==$e&&(!Gt(a,d)||L)){const m=On(d,_,i,r);if(Pn(d,m),b==="out-in")return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,r.update.active!==!1&&r.update()},mn(f);b==="in-out"&&a.type!==$e&&(m.delayLeave=(o,c,l)=>{const p=ea(i,d);p[String(d.key)]=d,o._leaveCb=()=>{c(),o._leaveCb=void 0,delete E.delayedLeave},E.delayedLeave=l})}return f}}},Zs=qo;function ea(e,t){const{leavingVNodes:r}=e;let i=r.get(t.type);return i||(i=Object.create(null),r.set(t.type,i)),i}function On(e,t,r,i){const{appear:n,mode:s,persisted:f=!1,onBeforeEnter:_,onEnter:b,onAfterEnter:a,onEnterCancelled:E,onBeforeLeave:v,onLeave:d,onAfterLeave:L,onLeaveCancelled:k,onBeforeAppear:m,onAppear:o,onAfterAppear:c,onAppearCancelled:l}=t,p=String(e.key),y=ea(r,e),h=(A,R)=>{A&&Ye(A,i,9,R)},S=(A,R)=>{const u=R[1];h(A,R),fe(A)?A.every(g=>g.length<=1)&&u():A.length<=1&&u()},D={mode:s,persisted:f,beforeEnter(A){let R=_;if(!r.isMounted)if(n)R=m||_;else return;A._leaveCb&&A._leaveCb(!0);const u=y[p];u&&Gt(e,u)&&u.el._leaveCb&&u.el._leaveCb(),h(R,[A])},enter(A){let R=b,u=a,g=E;if(!r.isMounted)if(n)R=o||b,u=c||a,g=l||E;else return;let T=!1;const C=A._enterCb=w=>{T||(T=!0,w?h(g,[A]):h(u,[A]),D.delayedLeave&&D.delayedLeave(),A._enterCb=void 0)};R?S(R,[A,C]):C()},leave(A,R){const u=String(e.key);if(A._enterCb&&A._enterCb(!0),r.isUnmounting)return R();h(v,[A]);let g=!1;const T=A._leaveCb=C=>{g||(g=!0,R(),C?h(k,[A]):h(L,[A]),A._leaveCb=void 0,y[u]===e&&delete y[u])};y[u]=e,d?S(d,[A,T]):T()},clone(A){return On(A,t,r,i)}};return D}function mn(e){if(ln(e))return e=Dt(e),e.children=null,e}function wi(e){return ln(e)?e.children?e.children[0]:void 0:e}function Pn(e,t){e.shapeFlag&6&&e.component?Pn(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ta(e,t=!1,r){let i=[],n=0;for(let s=0;s<e.length;s++){let f=e[s];const _=r==null?f.key:String(r)+String(f.key!=null?f.key:s);f.type===xe?(f.patchFlag&128&&n++,i=i.concat(ta(f.children,t,_))):(t||f.type!==$e)&&i.push(_!=null?Dt(f,{key:_}):f)}if(n>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function It(e){return ge(e)?{setup:e,name:e.name}:e}const vr=e=>!!e.type.__asyncLoader,ln=e=>e.type.__isKeepAlive;function Yo(e,t){ra(e,"a",t)}function $o(e,t){ra(e,"da",t)}function ra(e,t,r=Oe){const i=e.__wdc||(e.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(un(t,i,r),r){let n=r.parent;for(;n&&n.parent;)ln(n.parent.vnode)&&Xo(i,t,r,n),n=n.parent}}function Xo(e,t,r,i){const n=un(t,e,i,!0);Or(()=>{Xn(i[t],n)},r)}function un(e,t,r=Oe,i=!1){if(r){const n=r[e]||(r[e]=[]),s=t.__weh||(t.__weh=(...f)=>{if(r.isUnmounted)return;or(),ir(r);const _=Ye(t,r,e,f);return Wt(),lr(),_});return i?n.unshift(s):n.push(s),s}}const mt=e=>(t,r=Oe)=>(!Dr||e==="sp")&&un(e,(...i)=>t(...i),r),Qo=mt("bm"),xr=mt("m"),Jo=mt("bu"),Zo=mt("u"),na=mt("bum"),Or=mt("um"),el=mt("sp"),tl=mt("rtg"),rl=mt("rtc");function nl(e,t=Oe){un("ec",e,t)}function Ge(e,t){const r=Pe;if(r===null)return e;const i=hn(r)||r.proxy,n=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[f,_,b,a=_e]=t[s];f&&(ge(f)&&(f={mounted:f,updated:f}),f.deep&&Ht(_),n.push({dir:f,instance:i,value:_,oldValue:void 0,arg:b,modifiers:a}))}return e}function Ft(e,t,r,i){const n=e.dirs,s=t&&t.dirs;for(let f=0;f<n.length;f++){const _=n[f];s&&(_.oldValue=s[f].value);let b=_.dir[i];b&&(or(),Ye(b,r,8,[e.el,_,e,t]),lr())}}const ia="components";function sa(e,t){return sl(ia,e,!0,t)||e}const il=Symbol();function sl(e,t,r=!0,i=!1){const n=Pe||Oe;if(n){const s=n.type;if(e===ia){const _=Ol(s,!1);if(_&&(_===t||_===ut(t)||_===tn(ut(t))))return s}const f=Ii(n[e]||s[e],t)||Ii(n.appContext[e],t);return!f&&i?s:f}}function Ii(e,t){return e&&(e[t]||e[ut(t)]||e[tn(ut(t))])}function Yr(e,t,r,i){let n;const s=r&&r[i];if(fe(e)||we(e)){n=new Array(e.length);for(let f=0,_=e.length;f<_;f++)n[f]=t(e[f],f,void 0,s&&s[f])}else if(typeof e=="number"){n=new Array(e);for(let f=0;f<e;f++)n[f]=t(f+1,f,void 0,s&&s[f])}else if(Ae(e))if(e[Symbol.iterator])n=Array.from(e,(f,_)=>t(f,_,void 0,s&&s[_]));else{const f=Object.keys(e);n=new Array(f.length);for(let _=0,b=f.length;_<b;_++){const a=f[_];n[_]=t(e[a],a,_,s&&s[_])}}else n=[];return r&&(r[i]=n),n}function yn(e,t,r={},i,n){if(Pe.isCE||Pe.parent&&vr(Pe.parent)&&Pe.parent.isCE)return t!=="default"&&(r.name=t),ue("slot",r,i&&i());let s=e[t];s&&s._c&&(s._d=!1),he();const f=s&&aa(s(r)),_=di(xe,{key:r.key||f&&f.key||`_${t}`},f||(i?i():[]),f&&e._===1?64:-2);return!n&&_.scopeId&&(_.slotScopeIds=[_.scopeId+"-s"]),s&&s._c&&(s._d=!0),_}function aa(e){return e.some(t=>Xr(t)?!(t.type===$e||t.type===xe&&!aa(t.children)):!0)?e:null}const Fn=e=>e?ma(e)?hn(e)||e.proxy:Fn(e.parent):null,mr=Fe(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Fn(e.parent),$root:e=>Fn(e.root),$emit:e=>e.emit,$options:e=>ui(e),$forceUpdate:e=>e.f||(e.f=()=>oi(e.update)),$nextTick:e=>e.n||(e.n=sn.bind(e.proxy)),$watch:e=>zo.bind(e)}),En=(e,t)=>e!==_e&&!e.__isScriptSetup&&Ee(e,t),al={get({_:e},t){const{ctx:r,setupState:i,data:n,props:s,accessCache:f,type:_,appContext:b}=e;let a;if(t[0]!=="$"){const L=f[t];if(L!==void 0)switch(L){case 1:return i[t];case 2:return n[t];case 4:return r[t];case 3:return s[t]}else{if(En(i,t))return f[t]=1,i[t];if(n!==_e&&Ee(n,t))return f[t]=2,n[t];if((a=e.propsOptions[0])&&Ee(a,t))return f[t]=3,s[t];if(r!==_e&&Ee(r,t))return f[t]=4,r[t];Mn&&(f[t]=0)}}const E=mr[t];let v,d;if(E)return t==="$attrs"&&ze(e,"get",t),E(e);if((v=_.__cssModules)&&(v=v[t]))return v;if(r!==_e&&Ee(r,t))return f[t]=4,r[t];if(d=b.config.globalProperties,Ee(d,t))return d[t]},set({_:e},t,r){const{data:i,setupState:n,ctx:s}=e;return En(n,t)?(n[t]=r,!0):i!==_e&&Ee(i,t)?(i[t]=r,!0):Ee(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:n,propsOptions:s}},f){let _;return!!r[f]||e!==_e&&Ee(e,f)||En(t,f)||(_=s[0])&&Ee(_,f)||Ee(i,f)||Ee(mr,f)||Ee(n.config.globalProperties,f)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Ee(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Mn=!0;function ol(e){const t=ui(e),r=e.proxy,i=e.ctx;Mn=!1,t.beforeCreate&&xi(t.beforeCreate,e,"bc");const{data:n,computed:s,methods:f,watch:_,provide:b,inject:a,created:E,beforeMount:v,mounted:d,beforeUpdate:L,updated:k,activated:m,deactivated:o,beforeDestroy:c,beforeUnmount:l,destroyed:p,unmounted:y,render:h,renderTracked:S,renderTriggered:D,errorCaptured:A,serverPrefetch:R,expose:u,inheritAttrs:g,components:T,directives:C,filters:w}=t;if(a&&ll(a,i,null,e.appContext.config.unwrapInjectedRef),f)for(const x in f){const P=f[x];ge(P)&&(i[x]=P.bind(r))}if(n){const x=n.call(r,r);Ae(x)&&(e.data=vt(x))}if(Mn=!0,s)for(const x in s){const P=s[x],F=ge(P)?P.bind(r,r):ge(P.get)?P.get.bind(r,r):et,N=!ge(P)&&ge(P.set)?P.set.bind(r):et,U=Ce({get:F,set:N});Object.defineProperty(i,x,{enumerable:!0,configurable:!0,get:()=>U.value,set:G=>U.value=G})}if(_)for(const x in _)oa(_[x],i,r,x);if(b){const x=ge(b)?b.call(r):b;Reflect.ownKeys(x).forEach(P=>{Kr(P,x[P])})}E&&xi(E,e,"c");function O(x,P){fe(P)?P.forEach(F=>x(F.bind(r))):P&&x(P.bind(r))}if(O(Qo,v),O(xr,d),O(Jo,L),O(Zo,k),O(Yo,m),O($o,o),O(nl,A),O(rl,S),O(tl,D),O(na,l),O(Or,y),O(el,R),fe(u))if(u.length){const x=e.exposed||(e.exposed={});u.forEach(P=>{Object.defineProperty(x,P,{get:()=>r[P],set:F=>r[P]=F})})}else e.exposed||(e.exposed={});h&&e.render===et&&(e.render=h),g!=null&&(e.inheritAttrs=g),T&&(e.components=T),C&&(e.directives=C)}function ll(e,t,r=et,i=!1){fe(e)&&(e=Nn(e));for(const n in e){const s=e[n];let f;Ae(s)?"default"in s?f=gt(s.from||n,s.default,!0):f=gt(s.from||n):f=gt(s),Ne(f)&&i?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>f.value,set:_=>f.value=_}):t[n]=f}}function xi(e,t,r){Ye(fe(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function oa(e,t,r,i){const n=i.includes(".")?Js(r,i):()=>r[i];if(we(e)){const s=t[e];ge(s)&&tr(n,s)}else if(ge(e))tr(n,e.bind(r));else if(Ae(e))if(fe(e))e.forEach(s=>oa(s,t,r,i));else{const s=ge(e.handler)?e.handler.bind(r):t[e.handler];ge(s)&&tr(n,s,e)}}function ui(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:n,optionsCache:s,config:{optionMergeStrategies:f}}=e.appContext,_=s.get(t);let b;return _?b=_:!n.length&&!r&&!i?b=t:(b={},n.length&&n.forEach(a=>$r(b,a,f,!0)),$r(b,t,f)),Ae(t)&&s.set(t,b),b}function $r(e,t,r,i=!1){const{mixins:n,extends:s}=t;s&&$r(e,s,r,!0),n&&n.forEach(f=>$r(e,f,r,!0));for(const f in t)if(!(i&&f==="expose")){const _=ul[f]||r&&r[f];e[f]=_?_(e[f],t[f]):t[f]}return e}const ul={data:Oi,props:Ut,emits:Ut,methods:Ut,computed:Ut,beforeCreate:Ue,created:Ue,beforeMount:Ue,mounted:Ue,beforeUpdate:Ue,updated:Ue,beforeDestroy:Ue,beforeUnmount:Ue,destroyed:Ue,unmounted:Ue,activated:Ue,deactivated:Ue,errorCaptured:Ue,serverPrefetch:Ue,components:Ut,directives:Ut,watch:dl,provide:Oi,inject:cl};function Oi(e,t){return t?e?function(){return Fe(ge(e)?e.call(this,this):e,ge(t)?t.call(this,this):t)}:t:e}function cl(e,t){return Ut(Nn(e),Nn(t))}function Nn(e){if(fe(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Ue(e,t){return e?[...new Set([].concat(e,t))]:t}function Ut(e,t){return e?Fe(Fe(Object.create(null),e),t):t}function dl(e,t){if(!e)return t;if(!t)return e;const r=Fe(Object.create(null),e);for(const i in t)r[i]=Ue(e[i],t[i]);return r}function fl(e,t,r,i=!1){const n={},s={};zr(s,dn,1),e.propsDefaults=Object.create(null),la(e,t,n,s);for(const f in e.propsOptions[0])f in n||(n[f]=void 0);r?e.props=i?n:ko(n):e.type.props?e.props=n:e.props=s,e.attrs=s}function hl(e,t,r,i){const{props:n,attrs:s,vnode:{patchFlag:f}}=e,_=Te(n),[b]=e.propsOptions;let a=!1;if((i||f>0)&&!(f&16)){if(f&8){const E=e.vnode.dynamicProps;for(let v=0;v<E.length;v++){let d=E[v];if(an(e.emitsOptions,d))continue;const L=t[d];if(b)if(Ee(s,d))L!==s[d]&&(s[d]=L,a=!0);else{const k=ut(d);n[k]=Bn(b,_,k,L,e,!1)}else L!==s[d]&&(s[d]=L,a=!0)}}}else{la(e,t,n,s)&&(a=!0);let E;for(const v in _)(!t||!Ee(t,v)&&((E=qt(v))===v||!Ee(t,E)))&&(b?r&&(r[v]!==void 0||r[E]!==void 0)&&(n[v]=Bn(b,_,v,void 0,e,!0)):delete n[v]);if(s!==_)for(const v in s)(!t||!Ee(t,v))&&(delete s[v],a=!0)}a&&pt(e,"set","$attrs")}function la(e,t,r,i){const[n,s]=e.propsOptions;let f=!1,_;if(t)for(let b in t){if(jr(b))continue;const a=t[b];let E;n&&Ee(n,E=ut(b))?!s||!s.includes(E)?r[E]=a:(_||(_={}))[E]=a:an(e.emitsOptions,b)||(!(b in i)||a!==i[b])&&(i[b]=a,f=!0)}if(s){const b=Te(r),a=_||_e;for(let E=0;E<s.length;E++){const v=s[E];r[v]=Bn(n,b,v,a[v],e,!Ee(a,v))}}return f}function Bn(e,t,r,i,n,s){const f=e[r];if(f!=null){const _=Ee(f,"default");if(_&&i===void 0){const b=f.default;if(f.type!==Function&&ge(b)){const{propsDefaults:a}=n;r in a?i=a[r]:(ir(n),i=a[r]=b.call(null,t),Wt())}else i=b}f[0]&&(s&&!_?i=!1:f[1]&&(i===""||i===qt(r))&&(i=!0))}return i}function ua(e,t,r=!1){const i=t.propsCache,n=i.get(e);if(n)return n;const s=e.props,f={},_=[];let b=!1;if(!ge(e)){const E=v=>{b=!0;const[d,L]=ua(v,t,!0);Fe(f,d),L&&_.push(...L)};!r&&t.mixins.length&&t.mixins.forEach(E),e.extends&&E(e.extends),e.mixins&&e.mixins.forEach(E)}if(!s&&!b)return Ae(e)&&i.set(e,Qt),Qt;if(fe(s))for(let E=0;E<s.length;E++){const v=ut(s[E]);Pi(v)&&(f[v]=_e)}else if(s)for(const E in s){const v=ut(E);if(Pi(v)){const d=s[E],L=f[v]=fe(d)||ge(d)?{type:d}:Object.assign({},d);if(L){const k=Ni(Boolean,L.type),m=Ni(String,L.type);L[0]=k>-1,L[1]=m<0||k<m,(k>-1||Ee(L,"default"))&&_.push(v)}}}const a=[f,_];return Ae(e)&&i.set(e,a),a}function Pi(e){return e[0]!=="$"}function Fi(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Mi(e,t){return Fi(e)===Fi(t)}function Ni(e,t){return fe(t)?t.findIndex(r=>Mi(r,e)):ge(t)&&Mi(t,e)?0:-1}const ca=e=>e[0]==="_"||e==="$stable",ci=e=>fe(e)?e.map(st):[st(e)],gl=(e,t,r)=>{if(t._n)return t;const i=Re((...n)=>ci(t(...n)),r);return i._c=!1,i},da=(e,t,r)=>{const i=e._ctx;for(const n in e){if(ca(n))continue;const s=e[n];if(ge(s))t[n]=gl(n,s,i);else if(s!=null){const f=ci(s);t[n]=()=>f}}},fa=(e,t)=>{const r=ci(t);e.slots.default=()=>r},pl=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=Te(t),zr(t,"_",r)):da(t,e.slots={})}else e.slots={},t&&fa(e,t);zr(e.slots,dn,1)},vl=(e,t,r)=>{const{vnode:i,slots:n}=e;let s=!0,f=_e;if(i.shapeFlag&32){const _=t._;_?r&&_===1?s=!1:(Fe(n,t),!r&&_===1&&delete n._):(s=!t.$stable,da(t,n)),f=t}else t&&(fa(e,t),f={default:1});if(s)for(const _ in n)!ca(_)&&!(_ in f)&&delete n[_]};function ha(){return{app:null,config:{isNativeTag:za,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ml=0;function yl(e,t){return function(i,n=null){ge(i)||(i=Object.assign({},i)),n!=null&&!Ae(n)&&(n=null);const s=ha(),f=new Set;let _=!1;const b=s.app={_uid:ml++,_component:i,_props:n,_container:null,_context:s,_instance:null,version:Ul,get config(){return s.config},set config(a){},use(a,...E){return f.has(a)||(a&&ge(a.install)?(f.add(a),a.install(b,...E)):ge(a)&&(f.add(a),a(b,...E))),b},mixin(a){return s.mixins.includes(a)||s.mixins.push(a),b},component(a,E){return E?(s.components[a]=E,b):s.components[a]},directive(a,E){return E?(s.directives[a]=E,b):s.directives[a]},mount(a,E,v){if(!_){const d=ue(i,n);return d.appContext=s,E&&t?t(d,a):e(d,a,v),_=!0,b._container=a,a.__vue_app__=b,hn(d.component)||d.component.proxy}},unmount(){_&&(e(null,b._container),delete b._container.__vue_app__)},provide(a,E){return s.provides[a]=E,b}};return b}}function Un(e,t,r,i,n=!1){if(fe(e)){e.forEach((d,L)=>Un(d,t&&(fe(t)?t[L]:t),r,i,n));return}if(vr(i)&&!n)return;const s=i.shapeFlag&4?hn(i.component)||i.component.proxy:i.el,f=n?null:s,{i:_,r:b}=e,a=t&&t.r,E=_.refs===_e?_.refs={}:_.refs,v=_.setupState;if(a!=null&&a!==b&&(we(a)?(E[a]=null,Ee(v,a)&&(v[a]=null)):Ne(a)&&(a.value=null)),ge(b))kt(b,_,12,[f,E]);else{const d=we(b),L=Ne(b);if(d||L){const k=()=>{if(e.f){const m=d?Ee(v,b)?v[b]:E[b]:b.value;n?fe(m)&&Xn(m,s):fe(m)?m.includes(s)||m.push(s):d?(E[b]=[s],Ee(v,b)&&(v[b]=E[b])):(b.value=[s],e.k&&(E[e.k]=b.value))}else d?(E[b]=f,Ee(v,b)&&(v[b]=f)):L&&(b.value=f,e.k&&(E[e.k]=f))};f?(k.id=-1,Ke(k,r)):k()}}}const Ke=Ho;function El(e){return Tl(e)}function Tl(e,t){const r=Qa();r.__VUE__=!0;const{insert:i,remove:n,patchProp:s,createElement:f,createText:_,createComment:b,setText:a,setElementText:E,parentNode:v,nextSibling:d,setScopeId:L=et,insertStaticContent:k}=e,m=(M,B,K,H=null,q=null,J=null,ee=!1,Z=null,te=!!B.dynamicChildren)=>{if(M===B)return;M&&!Gt(M,B)&&(H=W(M),G(M,q,J,!0),M=null),B.patchFlag===-2&&(te=!1,B.dynamicChildren=null);const{type:Q,ref:oe,shapeFlag:ie}=B;switch(Q){case cn:o(M,B,K,H);break;case $e:c(M,B,K,H);break;case yr:M==null&&l(B,K,H,ee);break;case xe:T(M,B,K,H,q,J,ee,Z,te);break;default:ie&1?h(M,B,K,H,q,J,ee,Z,te):ie&6?C(M,B,K,H,q,J,ee,Z,te):(ie&64||ie&128)&&Q.process(M,B,K,H,q,J,ee,Z,te,ne)}oe!=null&&q&&Un(oe,M&&M.ref,J,B||M,!B)},o=(M,B,K,H)=>{if(M==null)i(B.el=_(B.children),K,H);else{const q=B.el=M.el;B.children!==M.children&&a(q,B.children)}},c=(M,B,K,H)=>{M==null?i(B.el=b(B.children||""),K,H):B.el=M.el},l=(M,B,K,H)=>{[M.el,M.anchor]=k(M.children,B,K,H,M.el,M.anchor)},p=({el:M,anchor:B},K,H)=>{let q;for(;M&&M!==B;)q=d(M),i(M,K,H),M=q;i(B,K,H)},y=({el:M,anchor:B})=>{let K;for(;M&&M!==B;)K=d(M),n(M),M=K;n(B)},h=(M,B,K,H,q,J,ee,Z,te)=>{ee=ee||B.type==="svg",M==null?S(B,K,H,q,J,ee,Z,te):R(M,B,q,J,ee,Z,te)},S=(M,B,K,H,q,J,ee,Z)=>{let te,Q;const{type:oe,props:ie,shapeFlag:se,transition:ce,dirs:de}=M;if(te=M.el=f(M.type,J,ie&&ie.is,ie),se&8?E(te,M.children):se&16&&A(M.children,te,null,H,q,J&&oe!=="foreignObject",ee,Z),de&&Ft(M,null,H,"created"),ie){for(const ye in ie)ye!=="value"&&!jr(ye)&&s(te,ye,null,ie[ye],J,M.children,H,q,z);"value"in ie&&s(te,"value",null,ie.value),(Q=ie.onVnodeBeforeMount)&&nt(Q,H,M)}D(te,M,M.scopeId,ee,H),de&&Ft(M,null,H,"beforeMount");const me=(!q||q&&!q.pendingBranch)&&ce&&!ce.persisted;me&&ce.beforeEnter(te),i(te,B,K),((Q=ie&&ie.onVnodeMounted)||me||de)&&Ke(()=>{Q&&nt(Q,H,M),me&&ce.enter(te),de&&Ft(M,null,H,"mounted")},q)},D=(M,B,K,H,q)=>{if(K&&L(M,K),H)for(let J=0;J<H.length;J++)L(M,H[J]);if(q){let J=q.subTree;if(B===J){const ee=q.vnode;D(M,ee,ee.scopeId,ee.slotScopeIds,q.parent)}}},A=(M,B,K,H,q,J,ee,Z,te=0)=>{for(let Q=te;Q<M.length;Q++){const oe=M[Q]=Z?_t(M[Q]):st(M[Q]);m(null,oe,B,K,H,q,J,ee,Z)}},R=(M,B,K,H,q,J,ee)=>{const Z=B.el=M.el;let{patchFlag:te,dynamicChildren:Q,dirs:oe}=B;te|=M.patchFlag&16;const ie=M.props||_e,se=B.props||_e;let ce;K&&Mt(K,!1),(ce=se.onVnodeBeforeUpdate)&&nt(ce,K,B,M),oe&&Ft(B,M,K,"beforeUpdate"),K&&Mt(K,!0);const de=q&&B.type!=="foreignObject";if(Q?u(M.dynamicChildren,Q,Z,K,H,de,J):ee||P(M,B,Z,null,K,H,de,J,!1),te>0){if(te&16)g(Z,B,ie,se,K,H,q);else if(te&2&&ie.class!==se.class&&s(Z,"class",null,se.class,q),te&4&&s(Z,"style",ie.style,se.style,q),te&8){const me=B.dynamicProps;for(let ye=0;ye<me.length;ye++){const Se=me[ye],Le=ie[Se],We=se[Se];(We!==Le||Se==="value")&&s(Z,Se,Le,We,q,M.children,K,H,z)}}te&1&&M.children!==B.children&&E(Z,B.children)}else!ee&&Q==null&&g(Z,B,ie,se,K,H,q);((ce=se.onVnodeUpdated)||oe)&&Ke(()=>{ce&&nt(ce,K,B,M),oe&&Ft(B,M,K,"updated")},H)},u=(M,B,K,H,q,J,ee)=>{for(let Z=0;Z<B.length;Z++){const te=M[Z],Q=B[Z],oe=te.el&&(te.type===xe||!Gt(te,Q)||te.shapeFlag&70)?v(te.el):K;m(te,Q,oe,null,H,q,J,ee,!0)}},g=(M,B,K,H,q,J,ee)=>{if(K!==H){if(K!==_e)for(const Z in K)!jr(Z)&&!(Z in H)&&s(M,Z,K[Z],null,ee,B.children,q,J,z);for(const Z in H){if(jr(Z))continue;const te=H[Z],Q=K[Z];te!==Q&&Z!=="value"&&s(M,Z,Q,te,ee,B.children,q,J,z)}"value"in H&&s(M,"value",K.value,H.value)}},T=(M,B,K,H,q,J,ee,Z,te)=>{const Q=B.el=M?M.el:_(""),oe=B.anchor=M?M.anchor:_("");let{patchFlag:ie,dynamicChildren:se,slotScopeIds:ce}=B;ce&&(Z=Z?Z.concat(ce):ce),M==null?(i(Q,K,H),i(oe,K,H),A(B.children,K,oe,q,J,ee,Z,te)):ie>0&&ie&64&&se&&M.dynamicChildren?(u(M.dynamicChildren,se,K,q,J,ee,Z),(B.key!=null||q&&B===q.subTree)&&ga(M,B,!0)):P(M,B,K,oe,q,J,ee,Z,te)},C=(M,B,K,H,q,J,ee,Z,te)=>{B.slotScopeIds=Z,M==null?B.shapeFlag&512?q.ctx.activate(B,K,H,ee,te):w(B,K,H,q,J,ee,te):I(M,B,te)},w=(M,B,K,H,q,J,ee)=>{const Z=M.component=Cl(M,H,q);if(ln(M)&&(Z.ctx.renderer=ne),wl(Z),Z.asyncDep){if(q&&q.registerDep(Z,O),!M.el){const te=Z.subTree=ue($e);c(null,te,B,K)}return}O(Z,M,B,K,q,J,ee)},I=(M,B,K)=>{const H=B.component=M.component;if(jo(M,B,K))if(H.asyncDep&&!H.asyncResolved){x(H,B,K);return}else H.next=B,Po(H.update),H.update();else B.el=M.el,H.vnode=B},O=(M,B,K,H,q,J,ee)=>{const Z=()=>{if(M.isMounted){let{next:oe,bu:ie,u:se,parent:ce,vnode:de}=M,me=oe,ye;Mt(M,!1),oe?(oe.el=de.el,x(M,oe,ee)):oe=de,ie&&Gr(ie),(ye=oe.props&&oe.props.onVnodeBeforeUpdate)&&nt(ye,ce,oe,de),Mt(M,!0);const Se=vn(M),Le=M.subTree;M.subTree=Se,m(Le,Se,v(Le.el),W(Le),M,q,J),oe.el=Se.el,me===null&&Go(M,Se.el),se&&Ke(se,q),(ye=oe.props&&oe.props.onVnodeUpdated)&&Ke(()=>nt(ye,ce,oe,de),q)}else{let oe;const{el:ie,props:se}=B,{bm:ce,m:de,parent:me}=M,ye=vr(B);if(Mt(M,!1),ce&&Gr(ce),!ye&&(oe=se&&se.onVnodeBeforeMount)&&nt(oe,me,B),Mt(M,!0),ie&&ae){const Se=()=>{M.subTree=vn(M),ae(ie,M.subTree,M,q,null)};ye?B.type.__asyncLoader().then(()=>!M.isUnmounted&&Se()):Se()}else{const Se=M.subTree=vn(M);m(null,Se,K,H,M,q,J),B.el=Se.el}if(de&&Ke(de,q),!ye&&(oe=se&&se.onVnodeMounted)){const Se=B;Ke(()=>nt(oe,me,Se),q)}(B.shapeFlag&256||me&&vr(me.vnode)&&me.vnode.shapeFlag&256)&&M.a&&Ke(M.a,q),M.isMounted=!0,B=K=H=null}},te=M.effect=new ei(Z,()=>oi(Q),M.scope),Q=M.update=()=>te.run();Q.id=M.uid,Mt(M,!0),Q()},x=(M,B,K)=>{B.component=M;const H=M.vnode.props;M.vnode=B,M.next=null,hl(M,B.props,H,K),vl(M,B.children,K),or(),Di(),lr()},P=(M,B,K,H,q,J,ee,Z,te=!1)=>{const Q=M&&M.children,oe=M?M.shapeFlag:0,ie=B.children,{patchFlag:se,shapeFlag:ce}=B;if(se>0){if(se&128){N(Q,ie,K,H,q,J,ee,Z,te);return}else if(se&256){F(Q,ie,K,H,q,J,ee,Z,te);return}}ce&8?(oe&16&&z(Q,q,J),ie!==Q&&E(K,ie)):oe&16?ce&16?N(Q,ie,K,H,q,J,ee,Z,te):z(Q,q,J,!0):(oe&8&&E(K,""),ce&16&&A(ie,K,H,q,J,ee,Z,te))},F=(M,B,K,H,q,J,ee,Z,te)=>{M=M||Qt,B=B||Qt;const Q=M.length,oe=B.length,ie=Math.min(Q,oe);let se;for(se=0;se<ie;se++){const ce=B[se]=te?_t(B[se]):st(B[se]);m(M[se],ce,K,null,q,J,ee,Z,te)}Q>oe?z(M,q,J,!0,!1,ie):A(B,K,H,q,J,ee,Z,te,ie)},N=(M,B,K,H,q,J,ee,Z,te)=>{let Q=0;const oe=B.length;let ie=M.length-1,se=oe-1;for(;Q<=ie&&Q<=se;){const ce=M[Q],de=B[Q]=te?_t(B[Q]):st(B[Q]);if(Gt(ce,de))m(ce,de,K,null,q,J,ee,Z,te);else break;Q++}for(;Q<=ie&&Q<=se;){const ce=M[ie],de=B[se]=te?_t(B[se]):st(B[se]);if(Gt(ce,de))m(ce,de,K,null,q,J,ee,Z,te);else break;ie--,se--}if(Q>ie){if(Q<=se){const ce=se+1,de=ce<oe?B[ce].el:H;for(;Q<=se;)m(null,B[Q]=te?_t(B[Q]):st(B[Q]),K,de,q,J,ee,Z,te),Q++}}else if(Q>se)for(;Q<=ie;)G(M[Q],q,J,!0),Q++;else{const ce=Q,de=Q,me=new Map;for(Q=de;Q<=se;Q++){const ke=B[Q]=te?_t(B[Q]):st(B[Q]);ke.key!=null&&me.set(ke.key,Q)}let ye,Se=0;const Le=se-de+1;let We=!1,ct=0;const Be=new Array(Le);for(Q=0;Q<Le;Q++)Be[Q]=0;for(Q=ce;Q<=ie;Q++){const ke=M[Q];if(Se>=Le){G(ke,q,J,!0);continue}let Ie;if(ke.key!=null)Ie=me.get(ke.key);else for(ye=de;ye<=se;ye++)if(Be[ye-de]===0&&Gt(ke,B[ye])){Ie=ye;break}Ie===void 0?G(ke,q,J,!0):(Be[Ie-de]=Q+1,Ie>=ct?ct=Ie:We=!0,m(ke,B[Ie],K,null,q,J,ee,Z,te),Se++)}const yt=We?bl(Be):Qt;for(ye=yt.length-1,Q=Le-1;Q>=0;Q--){const ke=de+Q,Ie=B[ke],Xe=ke+1<oe?B[ke+1].el:H;Be[Q]===0?m(null,Ie,K,Xe,q,J,ee,Z,te):We&&(ye<0||Q!==yt[ye]?U(Ie,K,Xe,2):ye--)}}},U=(M,B,K,H,q=null)=>{const{el:J,type:ee,transition:Z,children:te,shapeFlag:Q}=M;if(Q&6){U(M.component.subTree,B,K,H);return}if(Q&128){M.suspense.move(B,K,H);return}if(Q&64){ee.move(M,B,K,ne);return}if(ee===xe){i(J,B,K);for(let ie=0;ie<te.length;ie++)U(te[ie],B,K,H);i(M.anchor,B,K);return}if(ee===yr){p(M,B,K);return}if(H!==2&&Q&1&&Z)if(H===0)Z.beforeEnter(J),i(J,B,K),Ke(()=>Z.enter(J),q);else{const{leave:ie,delayLeave:se,afterLeave:ce}=Z,de=()=>i(J,B,K),me=()=>{ie(J,()=>{de(),ce&&ce()})};se?se(J,de,me):me()}else i(J,B,K)},G=(M,B,K,H=!1,q=!1)=>{const{type:J,props:ee,ref:Z,children:te,dynamicChildren:Q,shapeFlag:oe,patchFlag:ie,dirs:se}=M;if(Z!=null&&Un(Z,null,K,M,!0),oe&256){B.ctx.deactivate(M);return}const ce=oe&1&&se,de=!vr(M);let me;if(de&&(me=ee&&ee.onVnodeBeforeUnmount)&&nt(me,B,M),oe&6)j(M.component,K,H);else{if(oe&128){M.suspense.unmount(K,H);return}ce&&Ft(M,null,B,"beforeUnmount"),oe&64?M.type.remove(M,B,K,q,ne,H):Q&&(J!==xe||ie>0&&ie&64)?z(Q,B,K,!1,!0):(J===xe&&ie&384||!q&&oe&16)&&z(te,B,K),H&&V(M)}(de&&(me=ee&&ee.onVnodeUnmounted)||ce)&&Ke(()=>{me&&nt(me,B,M),ce&&Ft(M,null,B,"unmounted")},K)},V=M=>{const{type:B,el:K,anchor:H,transition:q}=M;if(B===xe){X(K,H);return}if(B===yr){y(M);return}const J=()=>{n(K),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(M.shapeFlag&1&&q&&!q.persisted){const{leave:ee,delayLeave:Z}=q,te=()=>ee(K,J);Z?Z(M.el,J,te):te()}else J()},X=(M,B)=>{let K;for(;M!==B;)K=d(M),n(M),M=K;n(B)},j=(M,B,K)=>{const{bum:H,scope:q,update:J,subTree:ee,um:Z}=M;H&&Gr(H),q.stop(),J&&(J.active=!1,G(ee,M,B,K)),Z&&Ke(Z,B),Ke(()=>{M.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},z=(M,B,K,H=!1,q=!1,J=0)=>{for(let ee=J;ee<M.length;ee++)G(M[ee],B,K,H,q)},W=M=>M.shapeFlag&6?W(M.component.subTree):M.shapeFlag&128?M.suspense.next():d(M.anchor||M.el),$=(M,B,K)=>{M==null?B._vnode&&G(B._vnode,null,null,!0):m(B._vnode||null,M,B,null,null,null,K),Di(),$s(),B._vnode=M},ne={p:m,um:G,m:U,r:V,mt:w,mc:A,pc:P,pbc:u,n:W,o:e};let le,ae;return t&&([le,ae]=t(ne)),{render:$,hydrate:le,createApp:yl($,le)}}function Mt({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function ga(e,t,r=!1){const i=e.children,n=t.children;if(fe(i)&&fe(n))for(let s=0;s<i.length;s++){const f=i[s];let _=n[s];_.shapeFlag&1&&!_.dynamicChildren&&((_.patchFlag<=0||_.patchFlag===32)&&(_=n[s]=_t(n[s]),_.el=f.el),r||ga(f,_)),_.type===cn&&(_.el=f.el)}}function bl(e){const t=e.slice(),r=[0];let i,n,s,f,_;const b=e.length;for(i=0;i<b;i++){const a=e[i];if(a!==0){if(n=r[r.length-1],e[n]<a){t[i]=n,r.push(i);continue}for(s=0,f=r.length-1;s<f;)_=s+f>>1,e[r[_]]<a?s=_+1:f=_;a<e[r[s]]&&(s>0&&(t[i]=r[s-1]),r[s]=i)}}for(s=r.length,f=r[s-1];s-- >0;)r[s]=f,f=t[f];return r}const Sl=e=>e.__isTeleport,xe=Symbol(void 0),cn=Symbol(void 0),$e=Symbol(void 0),yr=Symbol(void 0),Er=[];let Ze=null;function he(e=!1){Er.push(Ze=e?null:[])}function _l(){Er.pop(),Ze=Er[Er.length-1]||null}let Rr=1;function Bi(e){Rr+=e}function pa(e){return e.dynamicChildren=Rr>0?Ze||Qt:null,_l(),Rr>0&&Ze&&Ze.push(e),e}function ve(e,t,r,i,n,s){return pa(Y(e,t,r,i,n,s,!0))}function di(e,t,r,i,n){return pa(ue(e,t,r,i,n,!0))}function Xr(e){return e?e.__v_isVNode===!0:!1}function Gt(e,t){return e.type===t.type&&e.key===t.key}const dn="__vInternal",va=({key:e})=>e??null,Hr=({ref:e,ref_key:t,ref_for:r})=>e!=null?we(e)||Ne(e)||ge(e)?{i:Pe,r:e,k:t,f:!!r}:e:null;function Y(e,t=null,r=null,i=0,n=null,s=e===xe?0:1,f=!1,_=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&va(t),ref:t&&Hr(t),scopeId:on,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Pe};return _?(fi(b,r),s&128&&e.normalize(b)):r&&(b.shapeFlag|=we(r)?8:16),Rr>0&&!f&&Ze&&(b.patchFlag>0||s&6)&&b.patchFlag!==32&&Ze.push(b),b}const ue=Al;function Al(e,t=null,r=null,i=0,n=null,s=!1){if((!e||e===il)&&(e=$e),Xr(e)){const _=Dt(e,t,!0);return r&&fi(_,r),Rr>0&&!s&&Ze&&(_.shapeFlag&6?Ze[Ze.indexOf(e)]=_:Ze.push(_)),_.patchFlag|=-2,_}if(Pl(e)&&(e=e.__vccOpts),t){t=Ll(t);let{class:_,style:b}=t;_&&!we(_)&&(t.class=lt(_)),Ae(b)&&(js(b)&&!fe(b)&&(b=Fe({},b)),t.style=ot(b))}const f=we(e)?1:Ko(e)?128:Sl(e)?64:Ae(e)?4:ge(e)?2:0;return Y(e,t,r,i,n,f,s,!0)}function Ll(e){return e?js(e)||dn in e?Fe({},e):e:null}function Dt(e,t,r=!1){const{props:i,ref:n,patchFlag:s,children:f}=e,_=t?hi(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:_,key:_&&va(_),ref:t&&t.ref?r&&n?fe(n)?n.concat(Hr(t)):[n,Hr(t)]:Hr(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:f,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Dt(e.ssContent),ssFallback:e.ssFallback&&Dt(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function pe(e=" ",t=0){return ue(cn,null,e,t)}function kl(e,t){const r=ue(yr,null,e);return r.staticCount=t,r}function je(e="",t=!1){return t?(he(),di($e,null,e)):ue($e,null,e)}function st(e){return e==null||typeof e=="boolean"?ue($e):fe(e)?ue(xe,null,e.slice()):typeof e=="object"?_t(e):ue(cn,null,String(e))}function _t(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Dt(e)}function fi(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(fe(t))r=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),fi(e,n()),n._c&&(n._d=!0));return}else{r=32;const n=t._;!n&&!(dn in t)?t._ctx=Pe:n===3&&Pe&&(Pe.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ge(t)?(t={default:t,_ctx:Pe},r=32):(t=String(t),i&64?(r=16,t=[pe(t)]):r=8);e.children=t,e.shapeFlag|=r}function hi(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=lt([t.class,i.class]));else if(n==="style")t.style=ot([t.style,i.style]);else if(Jr(n)){const s=t[n],f=i[n];f&&s!==f&&!(fe(s)&&s.includes(f))&&(t[n]=s?[].concat(s,f):f)}else n!==""&&(t[n]=i[n])}return t}function nt(e,t,r,i=null){Ye(e,t,7,[r,i])}const Rl=ha();let Dl=0;function Cl(e,t,r){const i=e.type,n=(t?t.appContext:e.appContext)||Rl,s={uid:Dl++,vnode:e,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new Ja(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ua(i,n),emitsOptions:Qs(i,n),emit:null,emitted:null,propsDefaults:_e,inheritAttrs:i.inheritAttrs,ctx:_e,data:_e,props:_e,attrs:_e,slots:_e,refs:_e,setupState:_e,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=No.bind(null,s),e.ce&&e.ce(s),s}let Oe=null;const fn=()=>Oe||Pe,ir=e=>{Oe=e,e.scope.on()},Wt=()=>{Oe&&Oe.scope.off(),Oe=null};function ma(e){return e.vnode.shapeFlag&4}let Dr=!1;function wl(e,t=!1){Dr=t;const{props:r,children:i}=e.vnode,n=ma(e);fl(e,r,n,t),pl(e,i);const s=n?Il(e,t):void 0;return Dr=!1,s}function Il(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Gs(new Proxy(e.ctx,al));const{setup:i}=r;if(i){const n=e.setupContext=i.length>1?Ea(e):null;ir(e),or();const s=kt(i,e,0,[e.props,n]);if(lr(),Wt(),ks(s)){if(s.then(Wt,Wt),t)return s.then(f=>{Ui(e,f,t)}).catch(f=>{nn(f,e,0)});e.asyncDep=s}else Ui(e,s,t)}else ya(e,t)}function Ui(e,t,r){ge(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ae(t)&&(e.setupState=zs(t)),ya(e,r)}let ji;function ya(e,t,r){const i=e.type;if(!e.render){if(!t&&ji&&!i.render){const n=i.template||ui(e).template;if(n){const{isCustomElement:s,compilerOptions:f}=e.appContext.config,{delimiters:_,compilerOptions:b}=i,a=Fe(Fe({isCustomElement:s,delimiters:_},f),b);i.render=ji(n,a)}}e.render=i.render||et}ir(e),or(),ol(e),lr(),Wt()}function xl(e){return new Proxy(e.attrs,{get(t,r){return ze(e,"get","$attrs"),t[r]}})}function Ea(e){const t=i=>{e.exposed=i||{}};let r;return{get attrs(){return r||(r=xl(e))},slots:e.slots,emit:e.emit,expose:t}}function hn(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(zs(Gs(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in mr)return mr[r](e)},has(t,r){return r in t||r in mr}}))}function Ol(e,t=!0){return ge(e)?e.displayName||e.name:e.name||t&&e.__name}function Pl(e){return ge(e)&&"__vccOpts"in e}const Ce=(e,t)=>Io(e,t,Dr);function Fl(){return Ml().attrs}function Ml(){const e=fn();return e.setupContext||(e.setupContext=Ea(e))}function gi(e,t,r){const i=arguments.length;return i===2?Ae(t)&&!fe(t)?Xr(t)?ue(e,null,[t]):ue(e,t):ue(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Xr(r)&&(r=[r]),ue(e,t,r))}const Nl=Symbol(""),Bl=()=>gt(Nl),Ul="3.2.45",jl="http://www.w3.org/2000/svg",Kt=typeof document<"u"?document:null,Gi=Kt&&Kt.createElement("template"),Gl={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const n=t?Kt.createElementNS(jl,e):Kt.createElement(e,r?{is:r}:void 0);return e==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:e=>Kt.createTextNode(e),createComment:e=>Kt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Kt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,n,s){const f=r?r.previousSibling:t.lastChild;if(n&&(n===s||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),r),!(n===s||!(n=n.nextSibling)););else{Gi.innerHTML=i?`<svg>${e}</svg>`:e;const _=Gi.content;if(i){const b=_.firstChild;for(;b.firstChild;)_.appendChild(b.firstChild);_.removeChild(b)}t.insertBefore(_,r)}return[f?f.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function Kl(e,t,r){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function Hl(e,t,r){const i=e.style,n=we(r);if(r&&!n){for(const s in r)jn(i,s,r[s]);if(t&&!we(t))for(const s in t)r[s]==null&&jn(i,s,"")}else{const s=i.display;n?t!==r&&(i.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const Ki=/\s*!important$/;function jn(e,t,r){if(fe(r))r.forEach(i=>jn(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=Vl(e,t);Ki.test(r)?e.setProperty(qt(i),r.replace(Ki,""),"important"):e[i]=r}}const Hi=["Webkit","Moz","ms"],Tn={};function Vl(e,t){const r=Tn[t];if(r)return r;let i=ut(t);if(i!=="filter"&&i in e)return Tn[t]=i;i=tn(i);for(let n=0;n<Hi.length;n++){const s=Hi[n]+i;if(s in e)return Tn[t]=s}return t}const Vi="http://www.w3.org/1999/xlink";function zl(e,t,r,i,n){if(i&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Vi,t.slice(6,t.length)):e.setAttributeNS(Vi,t,r);else{const s=Va(t);r==null||s&&!_s(r)?e.removeAttribute(t):e.setAttribute(t,s?"":r)}}function Wl(e,t,r,i,n,s,f){if(t==="innerHTML"||t==="textContent"){i&&f(i,n,s),e[t]=r??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const b=r??"";(e.value!==b||e.tagName==="OPTION")&&(e.value=b),r==null&&e.removeAttribute(t);return}let _=!1;if(r===""||r==null){const b=typeof e[t];b==="boolean"?r=_s(r):r==null&&b==="string"?(r="",_=!0):b==="number"&&(r=0,_=!0)}try{e[t]=r}catch{}_&&e.removeAttribute(t)}function $t(e,t,r,i){e.addEventListener(t,r,i)}function ql(e,t,r,i){e.removeEventListener(t,r,i)}function Yl(e,t,r,i,n=null){const s=e._vei||(e._vei={}),f=s[t];if(i&&f)f.value=i;else{const[_,b]=$l(t);if(i){const a=s[t]=Jl(i,n);$t(e,_,a,b)}else f&&(ql(e,_,f,b),s[t]=void 0)}}const zi=/(?:Once|Passive|Capture)$/;function $l(e){let t;if(zi.test(e)){t={};let i;for(;i=e.match(zi);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):qt(e.slice(2)),t]}let bn=0;const Xl=Promise.resolve(),Ql=()=>bn||(Xl.then(()=>bn=0),bn=Date.now());function Jl(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Ye(Zl(i,r.value),t,5,[i])};return r.value=e,r.attached=Ql(),r}function Zl(e,t){if(fe(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>n=>!n._stopped&&i&&i(n))}else return t}const Wi=/^on[a-z]/,eu=(e,t,r,i,n=!1,s,f,_,b)=>{t==="class"?Kl(e,i,n):t==="style"?Hl(e,r,i):Jr(t)?$n(t)||Yl(e,t,r,i,f):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):tu(e,t,i,n))?Wl(e,t,i,s,f,_,b):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),zl(e,t,i,n))};function tu(e,t,r,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&Wi.test(t)&&ge(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Wi.test(t)&&we(r)?!1:t in e}function pi(e){const t=fn();if(!t)return;const r=t.ut=(n=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(s=>Kn(s,n))},i=()=>{const n=e(t.proxy);Gn(t.subTree,n),r(n)};Vo(i),xr(()=>{const n=new MutationObserver(i);n.observe(t.subTree.el.parentNode,{childList:!0}),Or(()=>n.disconnect())})}function Gn(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{Gn(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Kn(e.el,t);else if(e.type===xe)e.children.forEach(r=>Gn(r,t));else if(e.type===yr){let{el:r,anchor:i}=e;for(;r&&(Kn(r,t),r!==i);)r=r.nextSibling}}function Kn(e,t){if(e.nodeType===1){const r=e.style;for(const i in t)r.setProperty(`--${i}`,t[i])}}const Tt="transition",ur="animation",Cr=(e,{slots:t})=>gi(Zs,ru(e),t);Cr.displayName="Transition";const Ta={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Cr.props=Fe({},Zs.props,Ta);const Nt=(e,t=[])=>{fe(e)?e.forEach(r=>r(...t)):e&&e(...t)},qi=e=>e?fe(e)?e.some(t=>t.length>1):e.length>1:!1;function ru(e){const t={};for(const T in e)T in Ta||(t[T]=e[T]);if(e.css===!1)return t;const{name:r="v",type:i,duration:n,enterFromClass:s=`${r}-enter-from`,enterActiveClass:f=`${r}-enter-active`,enterToClass:_=`${r}-enter-to`,appearFromClass:b=s,appearActiveClass:a=f,appearToClass:E=_,leaveFromClass:v=`${r}-leave-from`,leaveActiveClass:d=`${r}-leave-active`,leaveToClass:L=`${r}-leave-to`}=e,k=nu(n),m=k&&k[0],o=k&&k[1],{onBeforeEnter:c,onEnter:l,onEnterCancelled:p,onLeave:y,onLeaveCancelled:h,onBeforeAppear:S=c,onAppear:D=l,onAppearCancelled:A=p}=t,R=(T,C,w)=>{Bt(T,C?E:_),Bt(T,C?a:f),w&&w()},u=(T,C)=>{T._isLeaving=!1,Bt(T,v),Bt(T,L),Bt(T,d),C&&C()},g=T=>(C,w)=>{const I=T?D:l,O=()=>R(C,T,w);Nt(I,[C,O]),Yi(()=>{Bt(C,T?b:s),bt(C,T?E:_),qi(I)||$i(C,i,m,O)})};return Fe(t,{onBeforeEnter(T){Nt(c,[T]),bt(T,s),bt(T,f)},onBeforeAppear(T){Nt(S,[T]),bt(T,b),bt(T,a)},onEnter:g(!1),onAppear:g(!0),onLeave(T,C){T._isLeaving=!0;const w=()=>u(T,C);bt(T,v),au(),bt(T,d),Yi(()=>{T._isLeaving&&(Bt(T,v),bt(T,L),qi(y)||$i(T,i,o,w))}),Nt(y,[T,w])},onEnterCancelled(T){R(T,!1),Nt(p,[T])},onAppearCancelled(T){R(T,!0),Nt(A,[T])},onLeaveCancelled(T){u(T),Nt(h,[T])}})}function nu(e){if(e==null)return null;if(Ae(e))return[Sn(e.enter),Sn(e.leave)];{const t=Sn(e);return[t,t]}}function Sn(e){return _r(e)}function bt(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function Bt(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function Yi(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let iu=0;function $i(e,t,r,i){const n=e._endId=++iu,s=()=>{n===e._endId&&i()};if(r)return setTimeout(s,r);const{type:f,timeout:_,propCount:b}=su(e,t);if(!f)return i();const a=f+"end";let E=0;const v=()=>{e.removeEventListener(a,d),s()},d=L=>{L.target===e&&++E>=b&&v()};setTimeout(()=>{E<b&&v()},_+1),e.addEventListener(a,d)}function su(e,t){const r=window.getComputedStyle(e),i=k=>(r[k]||"").split(", "),n=i(`${Tt}Delay`),s=i(`${Tt}Duration`),f=Xi(n,s),_=i(`${ur}Delay`),b=i(`${ur}Duration`),a=Xi(_,b);let E=null,v=0,d=0;t===Tt?f>0&&(E=Tt,v=f,d=s.length):t===ur?a>0&&(E=ur,v=a,d=b.length):(v=Math.max(f,a),E=v>0?f>a?Tt:ur:null,d=E?E===Tt?s.length:b.length:0);const L=E===Tt&&/\b(transform|all)(,|$)/.test(i(`${Tt}Property`).toString());return{type:E,timeout:v,propCount:d,hasTransform:L}}function Xi(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,i)=>Qi(r)+Qi(e[i])))}function Qi(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function au(){return document.body.offsetHeight}const Ji=e=>{const t=e.props["onUpdate:modelValue"]||!1;return fe(t)?r=>Gr(t,r):t};function ou(e){e.target.composing=!0}function Zi(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ba={created(e,{modifiers:{lazy:t,trim:r,number:i}},n){e._assign=Ji(n);const s=i||n.props&&n.props.type==="number";$t(e,t?"change":"input",f=>{if(f.target.composing)return;let _=e.value;r&&(_=_.trim()),s&&(_=_r(_)),e._assign(_)}),r&&$t(e,"change",()=>{e.value=e.value.trim()}),t||($t(e,"compositionstart",ou),$t(e,"compositionend",Zi),$t(e,"change",Zi))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:i,number:n}},s){if(e._assign=Ji(s),e.composing||document.activeElement===e&&e.type!=="range"&&(r||i&&e.value.trim()===t||(n||e.type==="number")&&_r(e.value)===t))return;const f=t??"";e.value!==f&&(e.value=f)}},lu=["ctrl","shift","alt","meta"],uu={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>lu.some(r=>e[`${r}Key`]&&!t.includes(r))},cu=(e,t)=>(r,...i)=>{for(let n=0;n<t.length;n++){const s=uu[t[n]];if(s&&s(r,t))return}return e(r,...i)},du={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},cr=(e,t)=>r=>{if(!("key"in r))return;const i=qt(r.key);if(t.some(n=>n===i||du[n]===i))return e(r)},Ve={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):dr(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:i}){!t!=!r&&(i?t?(i.beforeEnter(e),dr(e,!0),i.enter(e)):i.leave(e,()=>{dr(e,!1)}):dr(e,t))},beforeUnmount(e,{value:t}){dr(e,t)}};function dr(e,t){e.style.display=t?e._vod:"none"}const fu=Fe({patchProp:eu},Gl);let es;function hu(){return es||(es=El(fu))}const gu=(...e)=>{const t=hu().createApp(...e),{mount:r}=t;return t.mount=i=>{const n=pu(i);if(!n)return;const s=t._component;!ge(s)&&!s.render&&!s.template&&(s.template=n.innerHTML),n.innerHTML="";const f=r(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),f},t};function pu(e){return we(e)?document.querySelector(e):e}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Xt=typeof window<"u";function vu(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const be=Object.assign;function _n(e,t){const r={};for(const i in t){const n=t[i];r[i]=tt(n)?n.map(e):e(n)}return r}const Tr=()=>{},tt=Array.isArray,mu=/\/$/,yu=e=>e.replace(mu,"");function An(e,t,r="/"){let i,n={},s="",f="";const _=t.indexOf("#");let b=t.indexOf("?");return _<b&&_>=0&&(b=-1),b>-1&&(i=t.slice(0,b),s=t.slice(b+1,_>-1?_:t.length),n=e(s)),_>-1&&(i=i||t.slice(0,_),f=t.slice(_,t.length)),i=Su(i??t,r),{fullPath:i+(s&&"?")+s+f,path:i,query:n,hash:f}}function Eu(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function ts(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Tu(e,t,r){const i=t.matched.length-1,n=r.matched.length-1;return i>-1&&i===n&&sr(t.matched[i],r.matched[n])&&Sa(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function sr(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Sa(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!bu(e[r],t[r]))return!1;return!0}function bu(e,t){return tt(e)?rs(e,t):tt(t)?rs(t,e):e===t}function rs(e,t){return tt(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function Su(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/");let n=r.length-1,s,f;for(s=0;s<i.length;s++)if(f=i[s],f!==".")if(f==="..")n>1&&n--;else break;return r.slice(0,n).join("/")+"/"+i.slice(s-(s===i.length?1:0)).join("/")}var wr;(function(e){e.pop="pop",e.push="push"})(wr||(wr={}));var br;(function(e){e.back="back",e.forward="forward",e.unknown=""})(br||(br={}));function _u(e){if(!e)if(Xt){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),yu(e)}const Au=/^[^#]+#/;function Lu(e,t){return e.replace(Au,"#")+t}function ku(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const gn=()=>({left:window.pageXOffset,top:window.pageYOffset});function Ru(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),n=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!n)return;t=ku(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function ns(e,t){return(history.state?history.state.position-t:-1)+e}const Hn=new Map;function Du(e,t){Hn.set(e,t)}function Cu(e){const t=Hn.get(e);return Hn.delete(e),t}let wu=()=>location.protocol+"//"+location.host;function _a(e,t){const{pathname:r,search:i,hash:n}=t,s=e.indexOf("#");if(s>-1){let _=n.includes(e.slice(s))?e.slice(s).length:1,b=n.slice(_);return b[0]!=="/"&&(b="/"+b),ts(b,"")}return ts(r,e)+i+n}function Iu(e,t,r,i){let n=[],s=[],f=null;const _=({state:d})=>{const L=_a(e,location),k=r.value,m=t.value;let o=0;if(d){if(r.value=L,t.value=d,f&&f===k){f=null;return}o=m?d.position-m.position:0}else i(L);n.forEach(c=>{c(r.value,k,{delta:o,type:wr.pop,direction:o?o>0?br.forward:br.back:br.unknown})})};function b(){f=r.value}function a(d){n.push(d);const L=()=>{const k=n.indexOf(d);k>-1&&n.splice(k,1)};return s.push(L),L}function E(){const{history:d}=window;d.state&&d.replaceState(be({},d.state,{scroll:gn()}),"")}function v(){for(const d of s)d();s=[],window.removeEventListener("popstate",_),window.removeEventListener("beforeunload",E)}return window.addEventListener("popstate",_),window.addEventListener("beforeunload",E),{pauseListeners:b,listen:a,destroy:v}}function is(e,t,r,i=!1,n=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:n?gn():null}}function xu(e){const{history:t,location:r}=window,i={value:_a(e,r)},n={value:t.state};n.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(b,a,E){const v=e.indexOf("#"),d=v>-1?(r.host&&document.querySelector("base")?e:e.slice(v))+b:wu()+e+b;try{t[E?"replaceState":"pushState"](a,"",d),n.value=a}catch(L){console.error(L),r[E?"replace":"assign"](d)}}function f(b,a){const E=be({},t.state,is(n.value.back,b,n.value.forward,!0),a,{position:n.value.position});s(b,E,!0),i.value=b}function _(b,a){const E=be({},n.value,t.state,{forward:b,scroll:gn()});s(E.current,E,!0);const v=be({},is(i.value,b,null),{position:E.position+1},a);s(b,v,!1),i.value=b}return{location:i,state:n,push:_,replace:f}}function Ou(e){e=_u(e);const t=xu(e),r=Iu(e,t.state,t.location,t.replace);function i(s,f=!0){f||r.pauseListeners(),history.go(s)}const n=be({location:"",base:e,go:i,createHref:Lu.bind(null,e)},t,r);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function Pu(e){return typeof e=="string"||e&&typeof e=="object"}function Aa(e){return typeof e=="string"||typeof e=="symbol"}const St={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},La=Symbol("");var ss;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(ss||(ss={}));function ar(e,t){return be(new Error,{type:e,[La]:!0},t)}function dt(e,t){return e instanceof Error&&La in e&&(t==null||!!(e.type&t))}const as="[^/]+?",Fu={sensitive:!1,strict:!1,start:!0,end:!0},Mu=/[.+*?^${}()[\]/\\]/g;function Nu(e,t){const r=be({},Fu,t),i=[];let n=r.start?"^":"";const s=[];for(const a of e){const E=a.length?[]:[90];r.strict&&!a.length&&(n+="/");for(let v=0;v<a.length;v++){const d=a[v];let L=40+(r.sensitive?.25:0);if(d.type===0)v||(n+="/"),n+=d.value.replace(Mu,"\\$&"),L+=40;else if(d.type===1){const{value:k,repeatable:m,optional:o,regexp:c}=d;s.push({name:k,repeatable:m,optional:o});const l=c||as;if(l!==as){L+=10;try{new RegExp(`(${l})`)}catch(y){throw new Error(`Invalid custom RegExp for param "${k}" (${l}): `+y.message)}}let p=m?`((?:${l})(?:/(?:${l}))*)`:`(${l})`;v||(p=o&&a.length<2?`(?:/${p})`:"/"+p),o&&(p+="?"),n+=p,L+=20,o&&(L+=-8),m&&(L+=-20),l===".*"&&(L+=-50)}E.push(L)}i.push(E)}if(r.strict&&r.end){const a=i.length-1;i[a][i[a].length-1]+=.7000000000000001}r.strict||(n+="/?"),r.end?n+="$":r.strict&&(n+="(?:/|$)");const f=new RegExp(n,r.sensitive?"":"i");function _(a){const E=a.match(f),v={};if(!E)return null;for(let d=1;d<E.length;d++){const L=E[d]||"",k=s[d-1];v[k.name]=L&&k.repeatable?L.split("/"):L}return v}function b(a){let E="",v=!1;for(const d of e){(!v||!E.endsWith("/"))&&(E+="/"),v=!1;for(const L of d)if(L.type===0)E+=L.value;else if(L.type===1){const{value:k,repeatable:m,optional:o}=L,c=k in a?a[k]:"";if(tt(c)&&!m)throw new Error(`Provided param "${k}" is an array but it is not repeatable (* or + modifiers)`);const l=tt(c)?c.join("/"):c;if(!l)if(o)d.length<2&&(E.endsWith("/")?E=E.slice(0,-1):v=!0);else throw new Error(`Missing required param "${k}"`);E+=l}}return E||"/"}return{re:f,score:i,keys:s,parse:_,stringify:b}}function Bu(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Uu(e,t){let r=0;const i=e.score,n=t.score;for(;r<i.length&&r<n.length;){const s=Bu(i[r],n[r]);if(s)return s;r++}if(Math.abs(n.length-i.length)===1){if(os(i))return 1;if(os(n))return-1}return n.length-i.length}function os(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const ju={type:0,value:""},Gu=/[a-zA-Z0-9_]/;function Ku(e){if(!e)return[[]];if(e==="/")return[[ju]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(L){throw new Error(`ERR (${r})/"${a}": ${L}`)}let r=0,i=r;const n=[];let s;function f(){s&&n.push(s),s=[]}let _=0,b,a="",E="";function v(){a&&(r===0?s.push({type:0,value:a}):r===1||r===2||r===3?(s.length>1&&(b==="*"||b==="+")&&t(`A repeatable param (${a}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:a,regexp:E,repeatable:b==="*"||b==="+",optional:b==="*"||b==="?"})):t("Invalid state to consume buffer"),a="")}function d(){a+=b}for(;_<e.length;){if(b=e[_++],b==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:b==="/"?(a&&v(),f()):b===":"?(v(),r=1):d();break;case 4:d(),r=i;break;case 1:b==="("?r=2:Gu.test(b)?d():(v(),r=0,b!=="*"&&b!=="?"&&b!=="+"&&_--);break;case 2:b===")"?E[E.length-1]=="\\"?E=E.slice(0,-1)+b:r=3:E+=b;break;case 3:v(),r=0,b!=="*"&&b!=="?"&&b!=="+"&&_--,E="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${a}"`),v(),f(),n}function Hu(e,t,r){const i=Nu(Ku(e.path),r),n=be(i,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Vu(e,t){const r=[],i=new Map;t=cs({strict:!1,end:!0,sensitive:!1},t);function n(E){return i.get(E)}function s(E,v,d){const L=!d,k=zu(E);k.aliasOf=d&&d.record;const m=cs(t,E),o=[k];if("alias"in E){const p=typeof E.alias=="string"?[E.alias]:E.alias;for(const y of p)o.push(be({},k,{components:d?d.record.components:k.components,path:y,aliasOf:d?d.record:k}))}let c,l;for(const p of o){const{path:y}=p;if(v&&y[0]!=="/"){const h=v.record.path,S=h[h.length-1]==="/"?"":"/";p.path=v.record.path+(y&&S+y)}if(c=Hu(p,v,m),d?d.alias.push(c):(l=l||c,l!==c&&l.alias.push(c),L&&E.name&&!us(c)&&f(E.name)),k.children){const h=k.children;for(let S=0;S<h.length;S++)s(h[S],c,d&&d.children[S])}d=d||c,(c.record.components&&Object.keys(c.record.components).length||c.record.name||c.record.redirect)&&b(c)}return l?()=>{f(l)}:Tr}function f(E){if(Aa(E)){const v=i.get(E);v&&(i.delete(E),r.splice(r.indexOf(v),1),v.children.forEach(f),v.alias.forEach(f))}else{const v=r.indexOf(E);v>-1&&(r.splice(v,1),E.record.name&&i.delete(E.record.name),E.children.forEach(f),E.alias.forEach(f))}}function _(){return r}function b(E){let v=0;for(;v<r.length&&Uu(E,r[v])>=0&&(E.record.path!==r[v].record.path||!ka(E,r[v]));)v++;r.splice(v,0,E),E.record.name&&!us(E)&&i.set(E.record.name,E)}function a(E,v){let d,L={},k,m;if("name"in E&&E.name){if(d=i.get(E.name),!d)throw ar(1,{location:E});m=d.record.name,L=be(ls(v.params,d.keys.filter(l=>!l.optional).map(l=>l.name)),E.params&&ls(E.params,d.keys.map(l=>l.name))),k=d.stringify(L)}else if("path"in E)k=E.path,d=r.find(l=>l.re.test(k)),d&&(L=d.parse(k),m=d.record.name);else{if(d=v.name?i.get(v.name):r.find(l=>l.re.test(v.path)),!d)throw ar(1,{location:E,currentLocation:v});m=d.record.name,L=be({},v.params,E.params),k=d.stringify(L)}const o=[];let c=d;for(;c;)o.unshift(c.record),c=c.parent;return{name:m,path:k,params:L,matched:o,meta:qu(o)}}return e.forEach(E=>s(E)),{addRoute:s,resolve:a,removeRoute:f,getRoutes:_,getRecordMatcher:n}}function ls(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function zu(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Wu(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Wu(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="boolean"?r:r[i];return t}function us(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function qu(e){return e.reduce((t,r)=>be(t,r.meta),{})}function cs(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function ka(e,t){return t.children.some(r=>r===e||ka(e,r))}const Ra=/#/g,Yu=/&/g,$u=/\//g,Xu=/=/g,Qu=/\?/g,Da=/\+/g,Ju=/%5B/g,Zu=/%5D/g,Ca=/%5E/g,ec=/%60/g,wa=/%7B/g,tc=/%7C/g,Ia=/%7D/g,rc=/%20/g;function vi(e){return encodeURI(""+e).replace(tc,"|").replace(Ju,"[").replace(Zu,"]")}function nc(e){return vi(e).replace(wa,"{").replace(Ia,"}").replace(Ca,"^")}function Vn(e){return vi(e).replace(Da,"%2B").replace(rc,"+").replace(Ra,"%23").replace(Yu,"%26").replace(ec,"`").replace(wa,"{").replace(Ia,"}").replace(Ca,"^")}function ic(e){return Vn(e).replace(Xu,"%3D")}function sc(e){return vi(e).replace(Ra,"%23").replace(Qu,"%3F")}function ac(e){return e==null?"":sc(e).replace($u,"%2F")}function Qr(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function oc(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<i.length;++n){const s=i[n].replace(Da," "),f=s.indexOf("="),_=Qr(f<0?s:s.slice(0,f)),b=f<0?null:Qr(s.slice(f+1));if(_ in t){let a=t[_];tt(a)||(a=t[_]=[a]),a.push(b)}else t[_]=b}return t}function ds(e){let t="";for(let r in e){const i=e[r];if(r=ic(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(tt(i)?i.map(s=>s&&Vn(s)):[i&&Vn(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+r,s!=null&&(t+="="+s))})}return t}function lc(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=tt(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return t}const uc=Symbol(""),fs=Symbol(""),mi=Symbol(""),xa=Symbol(""),zn=Symbol("");function fr(){let e=[];function t(i){return e.push(i),()=>{const n=e.indexOf(i);n>-1&&e.splice(n,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function At(e,t,r,i,n){const s=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((f,_)=>{const b=v=>{v===!1?_(ar(4,{from:r,to:t})):v instanceof Error?_(v):Pu(v)?_(ar(2,{from:t,to:v})):(s&&i.enterCallbacks[n]===s&&typeof v=="function"&&s.push(v),f())},a=e.call(i&&i.instances[n],t,r,b);let E=Promise.resolve(a);e.length<3&&(E=E.then(b)),E.catch(v=>_(v))})}function Ln(e,t,r,i){const n=[];for(const s of e)for(const f in s.components){let _=s.components[f];if(!(t!=="beforeRouteEnter"&&!s.instances[f]))if(cc(_)){const a=(_.__vccOpts||_)[t];a&&n.push(At(a,r,i,s,f))}else{let b=_();n.push(()=>b.then(a=>{if(!a)return Promise.reject(new Error(`Couldn't resolve component "${f}" at "${s.path}"`));const E=vu(a)?a.default:a;s.components[f]=E;const d=(E.__vccOpts||E)[t];return d&&At(d,r,i,s,f)()}))}}return n}function cc(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hs(e){const t=gt(mi),r=gt(xa),i=Ce(()=>t.resolve(re(e.to))),n=Ce(()=>{const{matched:b}=i.value,{length:a}=b,E=b[a-1],v=r.matched;if(!E||!v.length)return-1;const d=v.findIndex(sr.bind(null,E));if(d>-1)return d;const L=gs(b[a-2]);return a>1&&gs(E)===L&&v[v.length-1].path!==L?v.findIndex(sr.bind(null,b[a-2])):d}),s=Ce(()=>n.value>-1&&gc(r.params,i.value.params)),f=Ce(()=>n.value>-1&&n.value===r.matched.length-1&&Sa(r.params,i.value.params));function _(b={}){return hc(b)?t[re(e.replace)?"replace":"push"](re(e.to)).catch(Tr):Promise.resolve()}return{route:i,href:Ce(()=>i.value.href),isActive:s,isExactActive:f,navigate:_}}const dc=It({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:hs,setup(e,{slots:t}){const r=vt(hs(e)),{options:i}=gt(mi),n=Ce(()=>({[ps(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[ps(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const s=t.default&&t.default(r);return e.custom?s:gi("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:n.value},s)}}}),fc=dc;function hc(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function gc(e,t){for(const r in t){const i=t[r],n=e[r];if(typeof i=="string"){if(i!==n)return!1}else if(!tt(n)||n.length!==i.length||i.some((s,f)=>s!==n[f]))return!1}return!0}function gs(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ps=(e,t,r)=>e??t??r,pc=It({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=gt(zn),n=Ce(()=>e.route||i.value),s=gt(fs,0),f=Ce(()=>{let a=re(s);const{matched:E}=n.value;let v;for(;(v=E[a])&&!v.components;)a++;return a}),_=Ce(()=>n.value.matched[f.value]);Kr(fs,Ce(()=>f.value+1)),Kr(uc,_),Kr(zn,n);const b=ht();return tr(()=>[b.value,_.value,e.name],([a,E,v],[d,L,k])=>{E&&(E.instances[v]=a,L&&L!==E&&a&&a===d&&(E.leaveGuards.size||(E.leaveGuards=L.leaveGuards),E.updateGuards.size||(E.updateGuards=L.updateGuards))),a&&E&&(!L||!sr(E,L)||!d)&&(E.enterCallbacks[v]||[]).forEach(m=>m(a))},{flush:"post"}),()=>{const a=n.value,E=e.name,v=_.value,d=v&&v.components[E];if(!d)return vs(r.default,{Component:d,route:a});const L=v.props[E],k=L?L===!0?a.params:typeof L=="function"?L(a):L:null,o=gi(d,be({},k,t,{onVnodeUnmounted:c=>{c.component.isUnmounted&&(v.instances[E]=null)},ref:b}));return vs(r.default,{Component:o,route:a})||o}}});function vs(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const vc=pc;function mc(e){const t=Vu(e.routes,e),r=e.parseQuery||oc,i=e.stringifyQuery||ds,n=e.history,s=fr(),f=fr(),_=fr(),b=Ro(St);let a=St;Xt&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const E=_n.bind(null,j=>""+j),v=_n.bind(null,ac),d=_n.bind(null,Qr);function L(j,z){let W,$;return Aa(j)?(W=t.getRecordMatcher(j),$=z):$=j,t.addRoute($,W)}function k(j){const z=t.getRecordMatcher(j);z&&t.removeRoute(z)}function m(){return t.getRoutes().map(j=>j.record)}function o(j){return!!t.getRecordMatcher(j)}function c(j,z){if(z=be({},z||b.value),typeof j=="string"){const M=An(r,j,z.path),B=t.resolve({path:M.path},z),K=n.createHref(M.fullPath);return be(M,B,{params:d(B.params),hash:Qr(M.hash),redirectedFrom:void 0,href:K})}let W;if("path"in j)W=be({},j,{path:An(r,j.path,z.path).path});else{const M=be({},j.params);for(const B in M)M[B]==null&&delete M[B];W=be({},j,{params:v(j.params)}),z.params=v(z.params)}const $=t.resolve(W,z),ne=j.hash||"";$.params=E(d($.params));const le=Eu(i,be({},j,{hash:nc(ne),path:$.path})),ae=n.createHref(le);return be({fullPath:le,hash:ne,query:i===ds?lc(j.query):j.query||{}},$,{redirectedFrom:void 0,href:ae})}function l(j){return typeof j=="string"?An(r,j,b.value.path):be({},j)}function p(j,z){if(a!==j)return ar(8,{from:z,to:j})}function y(j){return D(j)}function h(j){return y(be(l(j),{replace:!0}))}function S(j){const z=j.matched[j.matched.length-1];if(z&&z.redirect){const{redirect:W}=z;let $=typeof W=="function"?W(j):W;return typeof $=="string"&&($=$.includes("?")||$.includes("#")?$=l($):{path:$},$.params={}),be({query:j.query,hash:j.hash,params:"path"in $?{}:j.params},$)}}function D(j,z){const W=a=c(j),$=b.value,ne=j.state,le=j.force,ae=j.replace===!0,M=S(W);if(M)return D(be(l(M),{state:typeof M=="object"?be({},ne,M.state):ne,force:le,replace:ae}),z||W);const B=W;B.redirectedFrom=z;let K;return!le&&Tu(i,$,W)&&(K=ar(16,{to:B,from:$}),N($,$,!0,!1)),(K?Promise.resolve(K):R(B,$)).catch(H=>dt(H)?dt(H,2)?H:F(H):x(H,B,$)).then(H=>{if(H){if(dt(H,2))return D(be({replace:ae},l(H.to),{state:typeof H.to=="object"?be({},ne,H.to.state):ne,force:le}),z||B)}else H=g(B,$,!0,ae,ne);return u(B,$,H),H})}function A(j,z){const W=p(j,z);return W?Promise.reject(W):Promise.resolve()}function R(j,z){let W;const[$,ne,le]=yc(j,z);W=Ln($.reverse(),"beforeRouteLeave",j,z);for(const M of $)M.leaveGuards.forEach(B=>{W.push(At(B,j,z))});const ae=A.bind(null,j,z);return W.push(ae),Yt(W).then(()=>{W=[];for(const M of s.list())W.push(At(M,j,z));return W.push(ae),Yt(W)}).then(()=>{W=Ln(ne,"beforeRouteUpdate",j,z);for(const M of ne)M.updateGuards.forEach(B=>{W.push(At(B,j,z))});return W.push(ae),Yt(W)}).then(()=>{W=[];for(const M of j.matched)if(M.beforeEnter&&!z.matched.includes(M))if(tt(M.beforeEnter))for(const B of M.beforeEnter)W.push(At(B,j,z));else W.push(At(M.beforeEnter,j,z));return W.push(ae),Yt(W)}).then(()=>(j.matched.forEach(M=>M.enterCallbacks={}),W=Ln(le,"beforeRouteEnter",j,z),W.push(ae),Yt(W))).then(()=>{W=[];for(const M of f.list())W.push(At(M,j,z));return W.push(ae),Yt(W)}).catch(M=>dt(M,8)?M:Promise.reject(M))}function u(j,z,W){for(const $ of _.list())$(j,z,W)}function g(j,z,W,$,ne){const le=p(j,z);if(le)return le;const ae=z===St,M=Xt?history.state:{};W&&($||ae?n.replace(j.fullPath,be({scroll:ae&&M&&M.scroll},ne)):n.push(j.fullPath,ne)),b.value=j,N(j,z,W,ae),F()}let T;function C(){T||(T=n.listen((j,z,W)=>{if(!X.listening)return;const $=c(j),ne=S($);if(ne){D(be(ne,{replace:!0}),$).catch(Tr);return}a=$;const le=b.value;Xt&&Du(ns(le.fullPath,W.delta),gn()),R($,le).catch(ae=>dt(ae,12)?ae:dt(ae,2)?(D(ae.to,$).then(M=>{dt(M,20)&&!W.delta&&W.type===wr.pop&&n.go(-1,!1)}).catch(Tr),Promise.reject()):(W.delta&&n.go(-W.delta,!1),x(ae,$,le))).then(ae=>{ae=ae||g($,le,!1),ae&&(W.delta&&!dt(ae,8)?n.go(-W.delta,!1):W.type===wr.pop&&dt(ae,20)&&n.go(-1,!1)),u($,le,ae)}).catch(Tr)}))}let w=fr(),I=fr(),O;function x(j,z,W){F(j);const $=I.list();return $.length?$.forEach(ne=>ne(j,z,W)):console.error(j),Promise.reject(j)}function P(){return O&&b.value!==St?Promise.resolve():new Promise((j,z)=>{w.add([j,z])})}function F(j){return O||(O=!j,C(),w.list().forEach(([z,W])=>j?W(j):z()),w.reset()),j}function N(j,z,W,$){const{scrollBehavior:ne}=e;if(!Xt||!ne)return Promise.resolve();const le=!W&&Cu(ns(j.fullPath,0))||($||!W)&&history.state&&history.state.scroll||null;return sn().then(()=>ne(j,z,le)).then(ae=>ae&&Ru(ae)).catch(ae=>x(ae,j,z))}const U=j=>n.go(j);let G;const V=new Set,X={currentRoute:b,listening:!0,addRoute:L,removeRoute:k,hasRoute:o,getRoutes:m,resolve:c,options:e,push:y,replace:h,go:U,back:()=>U(-1),forward:()=>U(1),beforeEach:s.add,beforeResolve:f.add,afterEach:_.add,onError:I.add,isReady:P,install(j){const z=this;j.component("RouterLink",fc),j.component("RouterView",vc),j.config.globalProperties.$router=z,Object.defineProperty(j.config.globalProperties,"$route",{enumerable:!0,get:()=>re(b)}),Xt&&!G&&b.value===St&&(G=!0,y(n.location).catch(ne=>{}));const W={};for(const ne in St)W[ne]=Ce(()=>b.value[ne]);j.provide(mi,z),j.provide(xa,vt(W)),j.provide(zn,b);const $=j.unmount;V.add(j),j.unmount=function(){V.delete(j),V.size<1&&(a=St,T&&T(),T=null,b.value=St,G=!1,O=!1),$()}}};return X}function Yt(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function yc(e,t){const r=[],i=[],n=[],s=Math.max(t.matched.length,e.matched.length);for(let f=0;f<s;f++){const _=t.matched[f];_&&(e.matched.find(a=>sr(a,_))?i.push(_):r.push(_));const b=e.matched[f];b&&(t.matched.find(a=>sr(a,b))||n.push(b))}return[r,i,n]}const xt=(e,t)=>{const r=e.__vccOpts||e;for(const[i,n]of t)r[i]=n;return r},Ec={data(){return{count:0,NewSrc:"",M3u8Video:{width:"800px",height:"450px",color:"#409eff",title:"",type:"m3u8",src:"https://s-bj-2339-mydisk1.oss.dogecdn.com/testvideo/test.m3u8",newsrc:"",muted:!1,webFullScreen:!1,speedRate:["1.0","1.25"],autoPlay:!1,loop:!1,mirror:!1,ligthOff:!1,volume:.3,control:!0,controlBtns:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},Mp4Video:{width:"800px",height:"450px",color:"#409eff",title:"",src:"https://s-bj-2339-mydisk1.oss.dogecdn.com/Im%20Nothing%20Without%20You.mp4",muted:!1,webFullScreen:!1,speedRate:["1.0","1.25"],autoPlay:!1,loop:!1,mirror:!1,ligthOff:!1,volume:.3,control:!0,controlBtns:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},VideoObject:{}}},methods:{increment(){this.count++},GetIt(){console.log("干甚呢？",this.NewSrc)},ChangeVideo(){this.NewSrc.substring(this.NewSrc.lastIndexOf(".")+1)=="m3u8"?(this.M3u8Video.src=this.NewSrc,this.VideoObject=this.M3u8Video,console.log("实现 M3U8 对象")):this.NewSrc.substring(this.NewSrc.lastIndexOf(".")+1)=="mp4"?(this.Mp4Video.src=this.NewSrc,this.VideoObject=this.Mp4Video,console.log("MP4,MP4,MP4,MP4,MP4")):(console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),alert("未知后缀！！！！！"))}},mounted(){console.log(`The initial count is ${this.count}.`),this.VideoObject=this.M3u8Video}},Tc={align:"center"},bc=kl('<p> JwPlayer <a href="https://www.jwplayer.com/" target="_blank">JwPlayer</a> | <a href="https://github.com/jwplayer/jwplayer" target="_blank"> Github </a></p><p> DPlayer <a href="https://dplayer.diygod.dev/" target="_blank"> DPlayer </a> |👉 <a href="https://github.com/DIYgod/DPlayer" target="_blank"> Github </a></p><p> hello-muiplayer <a href="https://muiplayer.js.org/" target="_blank"> muiplayer </a> | <a href="https://github.com/muiplayer/hello-muiplayer" target="_blank"> muiplayer </a></p><p> v-videos.js <a href="https://videojs.com/" target="_blank"> videojs </a> | <a href="https://github.com/videojs/video.js" target="_blank"> videojs </a></p><p> v-videos.js <a href="https://codelife.cc/vue3-video-play/" target="_blank"> vue3-video-play </a> | <a href="https://github.com/xdlumia/vue3-video-play" target="_blank"> videojs </a></p>',5);function Sc(e,t,r,i,n,s){const f=sa("vue3VideoPlay");return he(),ve("div",Tc,[Y("p",null,[Ge(Y("input",{style:{width:"800px"},type:"text","onUpdate:modelValue":t[0]||(t[0]=_=>n.NewSrc=_)},null,512),[[ba,n.NewSrc]])]),Y("button",{onClick:t[1]||(t[1]=(..._)=>s.GetIt&&s.GetIt(..._))},"获取"),Y("button",{onClick:t[2]||(t[2]=(..._)=>s.ChangeVideo&&s.ChangeVideo(..._))},"应用"),Y("p",null,[ue(f,hi({width:"800px"},n.VideoObject),null,16)]),bc])}const _c=xt(Ec,[["render",Sc]]);const Ac={components:{Mp4Page:_c},setup(){},name:"App",data(){return{context:JSON.parse(localStorage.getItem("context"))||`本地数据为空：
  https://s-bj-2339-mydisk1.oss.dogecdn.com/%E3%81%82%E3%81%AE%E3%81%AF%E3%81%AA.mp4,
 https://s-bj-2339-mydisk1.oss.dogecdn.com/test/TE.m3u8 ,
 https://s-bj-2339-mydisk1.oss.dogecdn.com/movie/yrcy_m3u8/YRCY_m3u8.m3u8`}},methods:{datatoContext(e){localStorage.setItem("context",JSON.stringify(e)),alert("保存成功")}},watch:{}},yi=e=>(Ct("data-v-816de660"),e=e(),wt(),e),Lc={id:"app"},kc=yi(()=>Y("header",null,[Y("h1",null,"👺"),Y("img",{src:"https://avatars.githubusercontent.com/u/51418619?v=4",alt:""})],-1)),Rc=yi(()=>Y("h1",null,"简易视频播放器",-1)),Dc=yi(()=>Y("footer",null,[Y("h1",null,"🥥")],-1));function Cc(e,t,r,i,n,s){const f=sa("Mp4Page");return he(),ve("div",Lc,[Y("main",null,[kc,Y("main",null,[Rc,Y("p",null,[Ge(Y("textarea",{cols:"85",rows:"30","onUpdate:modelValue":t[0]||(t[0]=_=>n.context=_)},null,512),[[ba,n.context]])]),Y("p",null,[Y("button",{onClick:t[1]||(t[1]=_=>s.datatoContext(n.context))}," 保存文字区，到 localStorge ")]),ue(f)]),Dc])])}const wc=xt(Ac,[["render",Cc],["__scopeId","data-v-816de660"]]),Ic="modulepreload",xc=function(e){return"/Vue-HlsView/"+e},ms={},Oc=function(t,r,i){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=xc(s),s in ms)return;ms[s]=!0;const f=s.endsWith(".css"),_=f?'[rel="stylesheet"]':"";if(!!i)for(let E=n.length-1;E>=0;E--){const v=n[E];if(v.href===s&&(!f||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${_}`))return;const a=document.createElement("link");if(a.rel=f?"stylesheet":Ic,f||(a.as="script",a.crossOrigin=""),a.href=s,document.head.appendChild(a),f)return new Promise((E,v)=>{a.addEventListener("load",E),a.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};const Pc={},Fc={class:"item"},Mc={class:"details"};function Nc(e,t){return he(),ve("div",Fc,[Y("i",null,[yn(e.$slots,"icon",{},void 0,!0)]),Y("div",Mc,[Y("h3",null,[yn(e.$slots,"heading",{},void 0,!0)]),yn(e.$slots,"default",{},void 0,!0)])])}const hr=xt(Pc,[["render",Nc],["__scopeId","data-v-b362a3d3"]]),Bc={},Uc={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"17",fill:"currentColor"},jc=Y("path",{d:"M11 2.253a1 1 0 1 0-2 0h2zm-2 13a1 1 0 1 0 2 0H9zm.447-12.167a1 1 0 1 0 1.107-1.666L9.447 3.086zM1 2.253L.447 1.42A1 1 0 0 0 0 2.253h1zm0 13H0a1 1 0 0 0 1.553.833L1 15.253zm8.447.833a1 1 0 1 0 1.107-1.666l-1.107 1.666zm0-14.666a1 1 0 1 0 1.107 1.666L9.447 1.42zM19 2.253h1a1 1 0 0 0-.447-.833L19 2.253zm0 13l-.553.833A1 1 0 0 0 20 15.253h-1zm-9.553-.833a1 1 0 1 0 1.107 1.666L9.447 14.42zM9 2.253v13h2v-13H9zm1.553-.833C9.203.523 7.42 0 5.5 0v2c1.572 0 2.961.431 3.947 1.086l1.107-1.666zM5.5 0C3.58 0 1.797.523.447 1.42l1.107 1.666C2.539 2.431 3.928 2 5.5 2V0zM0 2.253v13h2v-13H0zm1.553 13.833C2.539 15.431 3.928 15 5.5 15v-2c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM5.5 15c1.572 0 2.961.431 3.947 1.086l1.107-1.666C9.203 13.523 7.42 13 5.5 13v2zm5.053-11.914C11.539 2.431 12.928 2 14.5 2V0c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM14.5 2c1.573 0 2.961.431 3.947 1.086l1.107-1.666C18.203.523 16.421 0 14.5 0v2zm3.5.253v13h2v-13h-2zm1.553 12.167C18.203 13.523 16.421 13 14.5 13v2c1.573 0 2.961.431 3.947 1.086l1.107-1.666zM14.5 13c-1.92 0-3.703.523-5.053 1.42l1.107 1.666C11.539 15.431 12.928 15 14.5 15v-2z"},null,-1),Gc=[jc];function Kc(e,t){return he(),ve("svg",Uc,Gc)}const Hc=xt(Bc,[["render",Kc]]),Vc={},zc={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--mdi",width:"24",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},Wc=Y("path",{d:"M20 18v-4h-3v1h-2v-1H9v1H7v-1H4v4h16M6.33 8l-1.74 4H7v-1h2v1h6v-1h2v1h2.41l-1.74-4H6.33M9 5v1h6V5H9m12.84 7.61c.1.22.16.48.16.8V18c0 .53-.21 1-.6 1.41c-.4.4-.85.59-1.4.59H4c-.55 0-1-.19-1.4-.59C2.21 19 2 18.53 2 18v-4.59c0-.32.06-.58.16-.8L4.5 7.22C4.84 6.41 5.45 6 6.33 6H7V5c0-.55.18-1 .57-1.41C7.96 3.2 8.44 3 9 3h6c.56 0 1.04.2 1.43.59c.39.41.57.86.57 1.41v1h.67c.88 0 1.49.41 1.83 1.22l2.34 5.39z",fill:"currentColor"},null,-1),qc=[Wc];function Yc(e,t){return he(),ve("svg",zc,qc)}const $c=xt(Vc,[["render",Yc]]),Xc={},Qc={xmlns:"http://www.w3.org/2000/svg",width:"18",height:"20",fill:"currentColor"},Jc=Y("path",{d:"M11.447 8.894a1 1 0 1 0-.894-1.789l.894 1.789zm-2.894-.789a1 1 0 1 0 .894 1.789l-.894-1.789zm0 1.789a1 1 0 1 0 .894-1.789l-.894 1.789zM7.447 7.106a1 1 0 1 0-.894 1.789l.894-1.789zM10 9a1 1 0 1 0-2 0h2zm-2 2.5a1 1 0 1 0 2 0H8zm9.447-5.606a1 1 0 1 0-.894-1.789l.894 1.789zm-2.894-.789a1 1 0 1 0 .894 1.789l-.894-1.789zm2 .789a1 1 0 1 0 .894-1.789l-.894 1.789zm-1.106-2.789a1 1 0 1 0-.894 1.789l.894-1.789zM18 5a1 1 0 1 0-2 0h2zm-2 2.5a1 1 0 1 0 2 0h-2zm-5.447-4.606a1 1 0 1 0 .894-1.789l-.894 1.789zM9 1l.447-.894a1 1 0 0 0-.894 0L9 1zm-2.447.106a1 1 0 1 0 .894 1.789l-.894-1.789zm-6 3a1 1 0 1 0 .894 1.789L.553 4.106zm2.894.789a1 1 0 1 0-.894-1.789l.894 1.789zm-2-.789a1 1 0 1 0-.894 1.789l.894-1.789zm1.106 2.789a1 1 0 1 0 .894-1.789l-.894 1.789zM2 5a1 1 0 1 0-2 0h2zM0 7.5a1 1 0 1 0 2 0H0zm8.553 12.394a1 1 0 1 0 .894-1.789l-.894 1.789zm-1.106-2.789a1 1 0 1 0-.894 1.789l.894-1.789zm1.106 1a1 1 0 1 0 .894 1.789l-.894-1.789zm2.894.789a1 1 0 1 0-.894-1.789l.894 1.789zM8 19a1 1 0 1 0 2 0H8zm2-2.5a1 1 0 1 0-2 0h2zm-7.447.394a1 1 0 1 0 .894-1.789l-.894 1.789zM1 15H0a1 1 0 0 0 .553.894L1 15zm1-2.5a1 1 0 1 0-2 0h2zm12.553 2.606a1 1 0 1 0 .894 1.789l-.894-1.789zM17 15l.447.894A1 1 0 0 0 18 15h-1zm1-2.5a1 1 0 1 0-2 0h2zm-7.447-5.394l-2 1 .894 1.789 2-1-.894-1.789zm-1.106 1l-2-1-.894 1.789 2 1 .894-1.789zM8 9v2.5h2V9H8zm8.553-4.894l-2 1 .894 1.789 2-1-.894-1.789zm.894 0l-2-1-.894 1.789 2 1 .894-1.789zM16 5v2.5h2V5h-2zm-4.553-3.894l-2-1-.894 1.789 2 1 .894-1.789zm-2.894-1l-2 1 .894 1.789 2-1L8.553.106zM1.447 5.894l2-1-.894-1.789-2 1 .894 1.789zm-.894 0l2 1 .894-1.789-2-1-.894 1.789zM0 5v2.5h2V5H0zm9.447 13.106l-2-1-.894 1.789 2 1 .894-1.789zm0 1.789l2-1-.894-1.789-2 1 .894 1.789zM10 19v-2.5H8V19h2zm-6.553-3.894l-2-1-.894 1.789 2 1 .894-1.789zM2 15v-2.5H0V15h2zm13.447 1.894l2-1-.894-1.789-2 1 .894 1.789zM18 15v-2.5h-2V15h2z"},null,-1),Zc=[Jc];function ed(e,t){return he(),ve("svg",Qc,Zc)}const td=xt(Xc,[["render",ed]]),rd={},nd={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"},id=Y("path",{d:"M15 4a1 1 0 1 0 0 2V4zm0 11v-1a1 1 0 0 0-1 1h1zm0 4l-.707.707A1 1 0 0 0 16 19h-1zm-4-4l.707-.707A1 1 0 0 0 11 14v1zm-4.707-1.293a1 1 0 0 0-1.414 1.414l1.414-1.414zm-.707.707l-.707-.707.707.707zM9 11v-1a1 1 0 0 0-.707.293L9 11zm-4 0h1a1 1 0 0 0-1-1v1zm0 4H4a1 1 0 0 0 1.707.707L5 15zm10-9h2V4h-2v2zm2 0a1 1 0 0 1 1 1h2a3 3 0 0 0-3-3v2zm1 1v6h2V7h-2zm0 6a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2zm-1 1h-2v2h2v-2zm-3 1v4h2v-4h-2zm1.707 3.293l-4-4-1.414 1.414 4 4 1.414-1.414zM11 14H7v2h4v-2zm-4 0c-.276 0-.525-.111-.707-.293l-1.414 1.414C5.42 15.663 6.172 16 7 16v-2zm-.707 1.121l3.414-3.414-1.414-1.414-3.414 3.414 1.414 1.414zM9 12h4v-2H9v2zm4 0a3 3 0 0 0 3-3h-2a1 1 0 0 1-1 1v2zm3-3V3h-2v6h2zm0-6a3 3 0 0 0-3-3v2a1 1 0 0 1 1 1h2zm-3-3H3v2h10V0zM3 0a3 3 0 0 0-3 3h2a1 1 0 0 1 1-1V0zM0 3v6h2V3H0zm0 6a3 3 0 0 0 3 3v-2a1 1 0 0 1-1-1H0zm3 3h2v-2H3v2zm1-1v4h2v-4H4zm1.707 4.707l.586-.586-1.414-1.414-.586.586 1.414 1.414z"},null,-1),sd=[id];function ad(e,t){return he(),ve("svg",nd,sd)}const od=xt(rd,[["render",ad]]),ld={},ud={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"},cd=Y("path",{d:"M10 3.22l-.61-.6a5.5 5.5 0 0 0-7.666.105 5.5 5.5 0 0 0-.114 7.665L10 18.78l8.39-8.4a5.5 5.5 0 0 0-.114-7.665 5.5 5.5 0 0 0-7.666-.105l-.61.61z"},null,-1),dd=[cd];function fd(e,t){return he(),ve("svg",ud,dd)}const hd=xt(ld,[["render",fd]]),gd=Y("a",{href:"https://vuejs.org/",target:"_blank",rel:"noopener"},"official documentation",-1),pd=Y("a",{href:"https://vitejs.dev/guide/features.html",target:"_blank",rel:"noopener"},"Vite",-1),vd=Y("a",{href:"https://code.visualstudio.com/",target:"_blank",rel:"noopener"},"VSCode",-1),md=Y("a",{href:"https://github.com/johnsoncodehk/volar",target:"_blank",rel:"noopener"},"Volar",-1),yd=Y("a",{href:"https://www.cypress.io/",target:"_blank",rel:"noopener"},"Cypress",-1),Ed=Y("a",{href:"https://on.cypress.io/component",target:"_blank"},"Cypress Component Testing",-1),Td=Y("br",null,null,-1),bd=Y("code",null,"README.md",-1),Sd=Y("a",{href:"https://pinia.vuejs.org/",target:"_blank",rel:"noopener"},"Pinia",-1),_d=Y("a",{href:"https://router.vuejs.org/",target:"_blank",rel:"noopener"},"Vue Router",-1),Ad=Y("a",{href:"https://test-utils.vuejs.org/",target:"_blank",rel:"noopener"},"Vue Test Utils",-1),Ld=Y("a",{href:"https://github.com/vuejs/devtools",target:"_blank",rel:"noopener"},"Vue Dev Tools",-1),kd=Y("a",{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"},"Awesome Vue",-1),Rd=Y("a",{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"},"Vue Land",-1),Dd=Y("a",{href:"https://stackoverflow.com/questions/tagged/vue.js",target:"_blank",rel:"noopener"},"StackOverflow",-1),Cd=Y("a",{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"},"our mailing list",-1),wd=Y("a",{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"},"@vuejs",-1),Id=Y("a",{href:"https://vuejs.org/sponsor/",target:"_blank",rel:"noopener"},"becoming a sponsor",-1),xd={__name:"TheWelcome",setup(e){return(t,r)=>(he(),ve(xe,null,[ue(hr,null,{icon:Re(()=>[ue(Hc)]),heading:Re(()=>[pe("Documentation")]),default:Re(()=>[pe(" Vue’s "),gd,pe(" provides you with all information you need to get started. ")]),_:1}),ue(hr,null,{icon:Re(()=>[ue($c)]),heading:Re(()=>[pe("Tooling")]),default:Re(()=>[pe(" This project is served and bundled with "),pd,pe(". The recommended IDE setup is "),vd,pe(" + "),md,pe(". If you need to test your components and web pages, check out "),yd,pe(" and "),Ed,pe(". "),Td,pe(" More instructions are available in "),bd,pe(". ")]),_:1}),ue(hr,null,{icon:Re(()=>[ue(td)]),heading:Re(()=>[pe("Ecosystem")]),default:Re(()=>[pe(" Get official tools and libraries for your project: "),Sd,pe(", "),_d,pe(", "),Ad,pe(", and "),Ld,pe(". If you need more resources, we suggest paying "),kd,pe(" a visit. ")]),_:1}),ue(hr,null,{icon:Re(()=>[ue(od)]),heading:Re(()=>[pe("Community")]),default:Re(()=>[pe(" Got stuck? Ask your question on "),Rd,pe(", our official Discord server, or "),Dd,pe(". You should also subscribe to "),Cd,pe(" and follow the official "),wd,pe(" twitter account for latest news in the Vue world. ")]),_:1}),ue(hr,null,{icon:Re(()=>[ue(hd)]),heading:Re(()=>[pe("Support Vue")]),default:Re(()=>[pe(" As an independent project, Vue relies on community backing for its sustainability. You can help us by "),Id,pe(". ")]),_:1})],64))}},Od={__name:"HomeView",setup(e){return(t,r)=>(he(),ve("main",null,[ue(xd)]))}},Pd=mc({history:Ou("/Vue-HlsView/"),routes:[{path:"/",name:"home",component:Od},{path:"/about",name:"about",component:()=>Oc(()=>import("./AboutView-a2849418.js"),["assets/AboutView-a2849418.js","assets/AboutView-4d995ba2.css"])}]});var Fd=Object.defineProperty,Md=Object.defineProperties,Nd=Object.getOwnPropertyDescriptors,ys=Object.getOwnPropertySymbols,Bd=Object.prototype.hasOwnProperty,Ud=Object.prototype.propertyIsEnumerable,Es=(e,t,r)=>t in e?Fd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Wn=(e,t)=>{for(var r in t||(t={}))Bd.call(t,r)&&Es(e,r,t[r]);if(ys)for(var r of ys(t))Ud.call(t,r)&&Es(e,r,t[r]);return e},qn=(e,t)=>Md(e,Nd(t));function Ts(e,t,r,i){var n,s=!1,f=0;function _(){n&&clearTimeout(n)}function b(){for(var a=arguments.length,E=new Array(a),v=0;v<a;v++)E[v]=arguments[v];var d=this,L=Date.now()-f;function k(){f=Date.now(),r.apply(d,E)}function m(){n=void 0}s||(i&&!n&&k(),_(),i===void 0&&L>e?k():t!==!0&&(n=setTimeout(i?m:k,i===void 0?e-L:e)))}return typeof t!="boolean"&&(i=r,r=t,t=void 0),b.cancel=function(){_(),s=!0},b}function bs(e,t,r){return r===void 0?Ts(e,t,!1):Ts(e,r,t!==!1)}function jd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Oa={exports:{}};typeof window<"u"&&(Oa.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,s){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:s})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(1&n&&(i=r(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var f in i)r.d(s,f,function(_){return i[_]}.bind(null,f));return s},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,r){var i=Object.prototype.hasOwnProperty,n="~";function s(){}function f(E,v,d){this.fn=E,this.context=v,this.once=d||!1}function _(E,v,d,L,k){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new f(d,L||E,k),o=n?n+v:v;return E._events[o]?E._events[o].fn?E._events[o]=[E._events[o],m]:E._events[o].push(m):(E._events[o]=m,E._eventsCount++),E}function b(E,v){--E._eventsCount==0?E._events=new s:delete E._events[v]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1)),a.prototype.eventNames=function(){var E,v,d=[];if(this._eventsCount===0)return d;for(v in E=this._events)i.call(E,v)&&d.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(E)):d},a.prototype.listeners=function(E){var v=n?n+E:E,d=this._events[v];if(!d)return[];if(d.fn)return[d.fn];for(var L=0,k=d.length,m=new Array(k);L<k;L++)m[L]=d[L].fn;return m},a.prototype.listenerCount=function(E){var v=n?n+E:E,d=this._events[v];return d?d.fn?1:d.length:0},a.prototype.emit=function(E,v,d,L,k,m){var o=n?n+E:E;if(!this._events[o])return!1;var c,l,p=this._events[o],y=arguments.length;if(p.fn){switch(p.once&&this.removeListener(E,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,v),!0;case 3:return p.fn.call(p.context,v,d),!0;case 4:return p.fn.call(p.context,v,d,L),!0;case 5:return p.fn.call(p.context,v,d,L,k),!0;case 6:return p.fn.call(p.context,v,d,L,k,m),!0}for(l=1,c=new Array(y-1);l<y;l++)c[l-1]=arguments[l];p.fn.apply(p.context,c)}else{var h,S=p.length;for(l=0;l<S;l++)switch(p[l].once&&this.removeListener(E,p[l].fn,void 0,!0),y){case 1:p[l].fn.call(p[l].context);break;case 2:p[l].fn.call(p[l].context,v);break;case 3:p[l].fn.call(p[l].context,v,d);break;case 4:p[l].fn.call(p[l].context,v,d,L);break;default:if(!c)for(h=1,c=new Array(y-1);h<y;h++)c[h-1]=arguments[h];p[l].fn.apply(p[l].context,c)}}return!0},a.prototype.on=function(E,v,d){return _(this,E,v,d,!1)},a.prototype.once=function(E,v,d){return _(this,E,v,d,!0)},a.prototype.removeListener=function(E,v,d,L){var k=n?n+E:E;if(!this._events[k])return this;if(!v)return b(this,k),this;var m=this._events[k];if(m.fn)m.fn!==v||L&&!m.once||d&&m.context!==d||b(this,k);else{for(var o=0,c=[],l=m.length;o<l;o++)(m[o].fn!==v||L&&!m[o].once||d&&m[o].context!==d)&&c.push(m[o]);c.length?this._events[k]=c.length===1?c[0]:c:b(this,k)}return this},a.prototype.removeAllListeners=function(E){var v;return E?(v=n?n+E:E,this._events[v]&&b(this,v)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,n,s,f,_;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,n=/^([^\/?#]*)([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,_={buildAbsoluteURL:function(b,a,E){if(E=E||{},b=b.trim(),!(a=a.trim())){if(!E.alwaysNormalize)return b;var v=_.parseURL(b);if(!v)throw new Error("Error trying to parse base URL.");return v.path=_.normalizePath(v.path),_.buildURLFromParts(v)}var d=_.parseURL(a);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return E.alwaysNormalize?(d.path=_.normalizePath(d.path),_.buildURLFromParts(d)):a;var L=_.parseURL(b);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var k=n.exec(L.path);L.netLoc=k[1],L.path=k[2]}L.netLoc&&!L.path&&(L.path="/");var m={scheme:L.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(m.netLoc=L.netLoc,d.path[0]!=="/"))if(d.path){var o=L.path,c=o.substring(0,o.lastIndexOf("/")+1)+d.path;m.path=_.normalizePath(c)}else m.path=L.path,d.params||(m.params=L.params,d.query||(m.query=L.query));return m.path===null&&(m.path=E.alwaysNormalize?_.normalizePath(d.path):d.path),_.buildURLFromParts(m)},parseURL:function(b){var a=i.exec(b);return a?{scheme:a[1]||"",netLoc:a[2]||"",path:a[3]||"",params:a[4]||"",query:a[5]||"",fragment:a[6]||""}:null},normalizePath:function(b){for(b=b.split("").reverse().join("").replace(s,"");b.length!==(b=b.replace(f,"")).length;);return b.split("").reverse().join("")},buildURLFromParts:function(b){return b.scheme+b.netLoc+b.path+b.params+b.query+b.fragment}},e.exports=_},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(a){var E={};function v(L){if(E[L])return E[L].exports;var k=E[L]={i:L,l:!1,exports:{}};return a[L].call(k.exports,k,k.exports,v),k.l=!0,k.exports}v.m=a,v.c=E,v.i=function(L){return L},v.d=function(L,k,m){v.o(L,k)||Object.defineProperty(L,k,{configurable:!1,enumerable:!0,get:m})},v.r=function(L){Object.defineProperty(L,"__esModule",{value:!0})},v.n=function(L){var k=L&&L.__esModule?function(){return L.default}:function(){return L};return v.d(k,"a",k),k},v.o=function(L,k){return Object.prototype.hasOwnProperty.call(L,k)},v.p="/",v.oe=function(L){throw console.error(L),L};var d=v(v.s=ENTRY_MODULE);return d.default||d}var n="[\\.|\\-|\\+|\\w|/|@]+",s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function f(a){return(a+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function _(a,E,v){var d={};d[v]=[];var L=E.toString(),k=L.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!k)return d;for(var m,o=k[1],c=new RegExp("(\\\\n|\\W)"+f(o)+s,"g");m=c.exec(L);)m[3]!=="dll-reference"&&d[v].push(m[3]);for(c=new RegExp("\\("+f(o)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+s,"g");m=c.exec(L);)a[m[2]]||(d[v].push(m[1]),a[m[2]]=r(m[1]).m),d[m[2]]=d[m[2]]||[],d[m[2]].push(m[4]);for(var l,p=Object.keys(d),y=0;y<p.length;y++)for(var h=0;h<d[p[y]].length;h++)l=d[p[y]][h],isNaN(1*l)||(d[p[y]][h]=1*d[p[y]][h]);return d}function b(a){return Object.keys(a).reduce(function(E,v){return E||a[v].length>0},!1)}e.exports=function(a,E){E=E||{};var v={main:r.m},d=E.all?{main:Object.keys(v.main)}:function(c,l){for(var p={main:[l]},y={main:[]},h={main:{}};b(p);)for(var S=Object.keys(p),D=0;D<S.length;D++){var A=S[D],R=p[A].pop();if(h[A]=h[A]||{},!h[A][R]&&c[A][R]){h[A][R]=!0,y[A]=y[A]||[],y[A].push(R);for(var u=_(c,c[A][R],A),g=Object.keys(u),T=0;T<g.length;T++)p[g[T]]=p[g[T]]||[],p[g[T]]=p[g[T]].concat(u[g[T]])}}return y}(v,a),L="";Object.keys(d).filter(function(c){return c!=="main"}).forEach(function(c){for(var l=0;d[c][l];)l++;d[c].push(l),v[c][l]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",L=L+"var "+c+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+d[c].map(function(p){return JSON.stringify(p)+": "+v[c][p].toString()}).join(",")+`});
`}),L=L+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(a))+")({"+d.main.map(function(c){return JSON.stringify(c)+": "+v.main[c].toString()}).join(",")+"}))(self);";var k=new window.Blob([L],{type:"text/javascript"});if(E.bare)return k;var m=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(k),o=new window.Worker(m);return o.objectURL=m,o}},"./src/config.ts":function(e,t,r){r.r(t),r.d(t,"hlsDefaultConfig",function(){return S}),r.d(t,"mergeConfig",function(){return D}),r.d(t,"enableStreamingMode",function(){return A});var i=r("./src/controller/abr-controller.ts"),n=r("./src/controller/audio-stream-controller.ts"),s=r("./src/controller/audio-track-controller.ts"),f=r("./src/controller/subtitle-stream-controller.ts"),_=r("./src/controller/subtitle-track-controller.ts"),b=r("./src/controller/buffer-controller.ts"),a=r("./src/controller/timeline-controller.ts"),E=r("./src/controller/cap-level-controller.ts"),v=r("./src/controller/fps-controller.ts"),d=r("./src/controller/eme-controller.ts"),L=r("./src/utils/xhr-loader.ts"),k=r("./src/utils/fetch-loader.ts"),m=r("./src/utils/cues.ts"),o=r("./src/utils/mediakeys-helper.ts"),c=r("./src/utils/logger.ts");function l(){return(l=Object.assign||function(R){for(var u=1;u<arguments.length;u++){var g=arguments[u];for(var T in g)Object.prototype.hasOwnProperty.call(g,T)&&(R[T]=g[T])}return R}).apply(this,arguments)}function p(R,u){var g=Object.keys(R);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(R);u&&(T=T.filter(function(C){return Object.getOwnPropertyDescriptor(R,C).enumerable})),g.push.apply(g,T)}return g}function y(R){for(var u=1;u<arguments.length;u++){var g=arguments[u]!=null?arguments[u]:{};u%2?p(Object(g),!0).forEach(function(T){h(R,T,g[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(g)):p(Object(g)).forEach(function(T){Object.defineProperty(R,T,Object.getOwnPropertyDescriptor(g,T))})}return R}function h(R,u,g){return u in R?Object.defineProperty(R,u,{value:g,enumerable:!0,configurable:!0,writable:!0}):R[u]=g,R}var S=y(y({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:L.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:i.default,bufferController:b.default,capLevelController:E.default,fpsController:v.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:o.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:m.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:f.SubtitleStreamController,subtitleTrackController:_.default,timelineController:a.TimelineController,audioStreamController:n.default,audioTrackController:s.default,emeController:d.default});function D(R,u){if((u.liveSyncDurationCount||u.liveMaxLatencyDurationCount)&&(u.liveSyncDuration||u.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(u.liveMaxLatencyDurationCount!==void 0&&(u.liveSyncDurationCount===void 0||u.liveMaxLatencyDurationCount<=u.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(u.liveMaxLatencyDuration!==void 0&&(u.liveSyncDuration===void 0||u.liveMaxLatencyDuration<=u.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return l({},R,u)}function A(R){var u=R.loader;u!==k.default&&u!==L.default?(c.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),R.progressive=!1):Object(k.fetchSupported)()&&(R.loader=k.default,R.progressive=!0,R.enableSoftwareAES=!0,c.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/utils/ewma-bandwidth-estimator.ts"),s=r("./src/events.ts"),f=r("./src/utils/buffer-helper.ts"),_=r("./src/errors.ts"),b=r("./src/types/loader.ts"),a=r("./src/utils/logger.ts");function E(d,L){for(var k=0;k<L.length;k++){var m=L[k];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(d,m.key,m)}}var v=function(){function d(o){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=o;var c=o.config;this.bwEstimator=new n.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var L,k,m=d.prototype;return m.registerListeners=function(){var o=this.hls;o.on(s.Events.FRAG_LOADING,this.onFragLoading,this),o.on(s.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(s.Events.ERROR,this.onError,this)},m.unregisterListeners=function(){var o=this.hls;o.off(s.Events.FRAG_LOADING,this.onFragLoading,this),o.off(s.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(s.Events.ERROR,this.onError,this)},m.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},m.onFragLoading=function(o,c){var l,p=c.frag;p.type===b.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=p,this.partCurrent=(l=c.part)!=null?l:null,this.timer=self.setInterval(this.onCheck,100)))},m.onLevelLoaded=function(o,c){var l=this.hls.config;c.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},m._abandonRulesCheck=function(){var o=this.fragCurrent,c=this.partCurrent,l=this.hls,p=l.autoLevelEnabled,y=l.config,h=l.media;if(o&&h){var S=c?c.stats:o.stats,D=c?c.duration:o.duration;if(S.aborted)return a.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(p&&!h.paused&&h.playbackRate&&h.readyState){var A=performance.now()-S.loading.start,R=Math.abs(h.playbackRate);if(!(A<=500*D/R)){var u=l.levels,g=l.minAutoLevel,T=u[o.level],C=S.total||Math.max(S.loaded,Math.round(D*T.maxBitrate/8)),w=Math.max(1,S.bwEstimate?S.bwEstimate/8:1e3*S.loaded/A),I=(C-S.loaded)/w,O=h.currentTime,x=(f.BufferHelper.bufferInfo(h,O,y.maxBufferHole).end-O)/R;if(!(x>=2*D/R||I<=x)){var P,F=Number.POSITIVE_INFINITY;for(P=o.level-1;P>g&&!((F=D*u[P].maxBitrate/(6.4*w))<x);P--);if(!(F>=I)){var N=this.bwEstimator.getEstimate();a.logger.warn("Fragment "+o.sn+(c?" part "+c.index:"")+" of level "+o.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+P+`
      Current BW estimate: `+(Object(i.isFiniteNumber)(N)?(N/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+I.toFixed(3)+` s
      Estimated load time for the next fragment: `+F.toFixed(3)+` s
      Time to underbuffer: `+x.toFixed(3)+" s"),l.nextLoadLevel=P,this.bwEstimator.sample(A,S.loaded),this.clearTimer(),o.loader&&(this.fragCurrent=this.partCurrent=null,o.loader.abort()),l.trigger(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:c,stats:S})}}}}}},m.onFragLoaded=function(o,c){var l=c.frag,p=c.part;if(l.type===b.PlaylistLevelType.MAIN&&Object(i.isFiniteNumber)(l.sn)){var y=p?p.stats:l.stats,h=p?p.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var S=this.hls.levels[l.level],D=(S.loaded?S.loaded.bytes:0)+y.loaded,A=(S.loaded?S.loaded.duration:0)+h;S.loaded={bytes:D,duration:A},S.realBitrate=Math.round(8*D/A)}if(l.bitrateTest){var R={stats:y,frag:l,part:p,id:l.type};this.onFragBuffered(s.Events.FRAG_BUFFERED,R),l.bitrateTest=!1}}},m.onFragBuffered=function(o,c){var l=c.frag,p=c.part,y=p?p.stats:l.stats;if(!y.aborted&&l.type===b.PlaylistLevelType.MAIN&&l.sn!=="initSegment"){var h=y.parsing.end-y.loading.start;this.bwEstimator.sample(h,y.loaded),y.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=h/1e3:this.bitrateTestDelay=0}},m.onError=function(o,c){switch(c.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},m.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},m.getNextABRAutoLevel=function(){var o=this.fragCurrent,c=this.partCurrent,l=this.hls,p=l.maxAutoLevel,y=l.config,h=l.minAutoLevel,S=l.media,D=c?c.duration:o?o.duration:0,A=S?S.currentTime:0,R=S&&S.playbackRate!==0?Math.abs(S.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():y.abrEwmaDefaultEstimate,g=(f.BufferHelper.bufferInfo(S,A,y.maxBufferHole).end-A)/R,T=this.findBestLevel(u,h,p,g,y.abrBandWidthFactor,y.abrBandWidthUpFactor);if(T>=0)return T;a.logger.trace((g?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var C=D?Math.min(D,y.maxStarvationDelay):y.maxStarvationDelay,w=y.abrBandWidthFactor,I=y.abrBandWidthUpFactor;if(!g){var O=this.bitrateTestDelay;O&&(C=(D?Math.min(D,y.maxLoadingDelay):y.maxLoadingDelay)-O,a.logger.trace("bitrate test took "+Math.round(1e3*O)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*C)+" ms"),w=I=1)}return T=this.findBestLevel(u,h,p,g+C,w,I),Math.max(T,0)},m.findBestLevel=function(o,c,l,p,y,h){for(var S,D=this.fragCurrent,A=this.partCurrent,R=this.lastLoadedFragLevel,u=this.hls.levels,g=u[R],T=!(g==null||(S=g.details)===null||S===void 0||!S.live),C=g==null?void 0:g.codecSet,w=A?A.duration:D?D.duration:0,I=l;I>=c;I--){var O=u[I];if(O&&(!C||O.codecSet===C)){var x=O.details,P=(A?x==null?void 0:x.partTarget:x==null?void 0:x.averagetargetduration)||w,F=void 0;F=I<=R?y*o:h*o;var N=u[I].maxBitrate,U=N*P/F;if(a.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+I+"/"+Math.round(F)+"/"+N+"/"+P+"/"+p+"/"+U),F>N&&(!U||T&&!this.bitrateTestDelay||U<p))return I}}return-1},L=d,(k=[{key:"nextAutoLevel",get:function(){var o=this._nextAutoLevel,c=this.bwEstimator;if(!(o===-1||c&&c.canEstimate()))return o;var l=this.getNextABRAutoLevel();return o!==-1&&(l=Math.min(o,l)),l},set:function(o){this._nextAutoLevel=o}}])&&E(L.prototype,k),d}();t.default=v},"./src/controller/audio-stream-controller.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/controller/base-stream-controller.ts"),s=r("./src/events.ts"),f=r("./src/utils/buffer-helper.ts"),_=r("./src/controller/fragment-tracker.ts"),b=r("./src/types/level.ts"),a=r("./src/types/loader.ts"),E=r("./src/loader/fragment.ts"),v=r("./src/demux/chunk-cache.ts"),d=r("./src/demux/transmuxer-interface.ts"),L=r("./src/types/transmuxer.ts"),k=r("./src/controller/fragment-finders.ts"),m=r("./src/utils/discontinuities.ts"),o=r("./src/errors.ts"),c=r("./src/utils/logger.ts");function l(){return(l=Object.assign||function(h){for(var S=1;S<arguments.length;S++){var D=arguments[S];for(var A in D)Object.prototype.hasOwnProperty.call(D,A)&&(h[A]=D[A])}return h}).apply(this,arguments)}function p(h,S){return(p=Object.setPrototypeOf||function(D,A){return D.__proto__=A,D})(h,S)}var y=function(h){var S,D;function A(u,g){var T;return(T=h.call(this,u,g,"[audio-stream-controller]")||this).videoBuffer=null,T.videoTrackCC=-1,T.waitingVideoCC=-1,T.audioSwitch=!1,T.trackId=-1,T.waitingData=null,T.mainDetails=null,T.bufferFlushed=!1,T._registerListeners(),T}D=h,(S=A).prototype=Object.create(D.prototype),S.prototype.constructor=S,p(S,D);var R=A.prototype;return R.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},R._registerListeners=function(){var u=this.hls;u.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.on(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),u.on(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),u.on(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.on(s.Events.ERROR,this.onError,this),u.on(s.Events.BUFFER_RESET,this.onBufferReset,this),u.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this),u.on(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),u.on(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),u.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R._unregisterListeners=function(){var u=this.hls;u.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.off(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),u.off(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),u.off(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.off(s.Events.ERROR,this.onError,this),u.off(s.Events.BUFFER_RESET,this.onBufferReset,this),u.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),u.off(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),u.off(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),u.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R.onInitPtsFound=function(u,g){var T=g.frag,C=g.id,w=g.initPTS;if(C==="main"){var I=T.cc;this.initPTS[T.cc]=w,this.log("InitPTS for cc: "+I+" found from main: "+w),this.videoTrackCC=I,this.state===n.State.WAITING_INIT_PTS&&this.tick()}},R.startLoad=function(u){if(!this.levels)return this.startPosition=u,void(this.state=n.State.STOPPED);var g=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,g>0&&u===-1?(this.log("Override startPosition with lastCurrentTime @"+g.toFixed(3)),this.state=n.State.IDLE):(this.loadedmetadata=!1,this.state=n.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=u,this.tick()},R.doTick=function(){switch(this.state){case n.State.IDLE:this.doTickIdle();break;case n.State.WAITING_TRACK:var u,g=this.levels,T=this.trackId,C=g==null||(u=g[T])===null||u===void 0?void 0:u.details;if(C){if(this.waitForCdnTuneIn(C))break;this.state=n.State.WAITING_INIT_PTS}break;case n.State.FRAG_LOADING_WAITING_RETRY:var w,I=performance.now(),O=this.retryDate;(!O||I>=O||(w=this.media)!==null&&w!==void 0&&w.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=n.State.IDLE);break;case n.State.WAITING_INIT_PTS:var x=this.waitingData;if(x){var P=x.frag,F=x.part,N=x.cache,U=x.complete;if(this.initPTS[P.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=n.State.FRAG_LOADING;var G={frag:P,part:F,payload:N.flush(),networkDetails:null};this._handleFragmentLoadProgress(G),U&&h.prototype._handleFragmentLoadComplete.call(this,G)}else if(this.videoTrackCC!==this.waitingVideoCC)c.logger.log("Waiting fragment cc ("+P.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var V=this.getLoadPosition(),X=f.BufferHelper.bufferInfo(this.mediaBuffer,V,this.config.maxBufferHole);Object(k.fragmentWithinToleranceTest)(X.end,this.config.maxFragLookUpTolerance,P)<0&&(c.logger.log("Waiting fragment cc ("+P.cc+") @ "+P.start+" cancelled because another fragment at "+X.end+" is needed"),this.clearWaitingFragment())}}else this.state=n.State.IDLE}this.onTickEnd()},R.clearWaitingFragment=function(){var u=this.waitingData;u&&(this.fragmentTracker.removeFragment(u.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=n.State.IDLE)},R.onTickEnd=function(){var u=this.media;if(u&&u.readyState){var g=(this.mediaBuffer?this.mediaBuffer:u).buffered;!this.loadedmetadata&&g.length&&(this.loadedmetadata=!0),this.lastCurrentTime=u.currentTime}},R.doTickIdle=function(){var u,g,T=this.hls,C=this.levels,w=this.media,I=this.trackId,O=T.config;if(C&&C[I]&&(w||!this.startFragRequested&&O.startFragPrefetch)){var x=C[I].details;if(!x||x.live&&this.levelLastLoaded!==I||this.waitForCdnTuneIn(x))this.state=n.State.WAITING_TRACK;else{this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,E.ElementaryStreamTypes.AUDIO,a.PlaylistLevelType.AUDIO));var P=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,a.PlaylistLevelType.AUDIO);if(P!==null){var F=P.len,N=this.getMaxBufferLength(),U=this.audioSwitch;if(!(F>=N)||U){if(!U&&this._streamEnded(P,x))return T.trigger(s.Events.BUFFER_EOS,{type:"audio"}),void(this.state=n.State.ENDED);var G=x.fragments[0].start,V=P.end;if(U){var X=this.getLoadPosition();V=X,x.PTSKnown&&X<G&&(P.end>G||P.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),w.currentTime=G+.05)}var j=this.getNextFragment(V,x);j?((u=j.decryptdata)===null||u===void 0?void 0:u.keyFormat)!=="identity"||(g=j.decryptdata)!==null&&g!==void 0&&g.key?this.loadFragment(j,x,V):this.loadKey(j,x):this.bufferFlushed=!0}}}}},R.getMaxBufferLength=function(){var u=h.prototype.getMaxBufferLength.call(this),g=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,a.PlaylistLevelType.MAIN);return g===null?u:Math.max(u,g.len)},R.onMediaDetaching=function(){this.videoBuffer=null,h.prototype.onMediaDetaching.call(this)},R.onAudioTracksUpdated=function(u,g){var T=g.audioTracks;this.resetTransmuxer(),this.levels=T.map(function(C){return new b.Level(C)})},R.onAudioTrackSwitching=function(u,g){var T=!!g.url;this.trackId=g.id;var C=this.fragCurrent;C!=null&&C.loader&&C.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),T?this.setInterval(100):this.resetTransmuxer(),T?(this.audioSwitch=!0,this.state=n.State.IDLE):this.state=n.State.STOPPED,this.tick()},R.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},R.onLevelLoaded=function(u,g){this.mainDetails=g.details},R.onAudioTrackLoaded=function(u,g){var T,C=this.levels,w=g.details,I=g.id;if(C){this.log("Track "+I+" loaded ["+w.startSN+","+w.endSN+"],duration:"+w.totalduration);var O=C[I],x=0;if(w.live||(T=O.details)!==null&&T!==void 0&&T.live){var P=this.mainDetails;if(w.fragments[0]||(w.deltaUpdateFailed=!0),w.deltaUpdateFailed||!P)return;!O.details&&w.hasProgramDateTime&&P.hasProgramDateTime?(Object(m.alignPDT)(w,P),x=w.fragments[0].start):x=this.alignPlaylists(w,O.details)}O.details=w,this.levelLastLoaded=I,this.startFragRequested||!this.mainDetails&&w.live||this.setStartPosition(O.details,x),this.state!==n.State.WAITING_TRACK||this.waitForCdnTuneIn(w)||(this.state=n.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+I)},R._handleFragmentLoadProgress=function(u){var g,T=u.frag,C=u.part,w=u.payload,I=this.config,O=this.trackId,x=this.levels;if(x){var P=x[O];console.assert(P,"Audio track is defined on fragment load progress");var F=P.details;console.assert(F,"Audio track details are defined on fragment load progress");var N=I.defaultAudioCodec||P.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new d.default(this.hls,a.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var G=this.initPTS[T.cc],V=(g=T.initSegment)===null||g===void 0?void 0:g.data;if(G!==void 0){var X=C?C.index:-1,j=X!==-1,z=new L.ChunkMetadata(T.level,T.sn,T.stats.chunkCount,w.byteLength,X,j);U.push(w,V,N,"",T,C,F.totalduration,!1,z,G)}else c.logger.log("Unknown video PTS for cc "+T.cc+", waiting for video PTS before demuxing audio frag "+T.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+O),(this.waitingData=this.waitingData||{frag:T,part:C,cache:new v.default,complete:!1}).cache.push(new Uint8Array(w)),this.waitingVideoCC=this.videoTrackCC,this.state=n.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+T.sn+" of level "+T.level+" will not be buffered")},R._handleFragmentLoadComplete=function(u){this.waitingData?this.waitingData.complete=!0:h.prototype._handleFragmentLoadComplete.call(this,u)},R.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},R.onBufferCreated=function(u,g){var T=g.tracks.audio;T&&(this.mediaBuffer=T.buffer),g.tracks.video&&(this.videoBuffer=g.tracks.video.buffer)},R.onFragBuffered=function(u,g){var T=g.frag,C=g.part;T.type===a.PlaylistLevelType.AUDIO&&(this.fragContextChanged(T)?this.warn("Fragment "+T.sn+(C?" p: "+C.index:"")+" of level "+T.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(T.sn!=="initSegment"&&(this.fragPrevious=T,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(T,C)))},R.onError=function(u,g){switch(g.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(a.PlaylistLevelType.AUDIO,g);break;case o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==n.State.ERROR&&this.state!==n.State.STOPPED&&(this.state=g.fatal?n.State.ERROR:n.State.IDLE,this.warn(g.details+" while loading frag, switching to "+this.state+" state"));break;case o.ErrorDetails.BUFFER_FULL_ERROR:if(g.parent==="audio"&&(this.state===n.State.PARSING||this.state===n.State.PARSED)){var T=!0,C=this.getFwdBufferInfo(this.mediaBuffer,a.PlaylistLevelType.AUDIO);C&&C.len>.5&&(T=!this.reduceMaxBufferLength(C.len)),T&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,h.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}},R.onBufferFlushed=function(u,g){g.type===E.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},R._handleTransmuxComplete=function(u){var g,T="audio",C=this.hls,w=u.remuxResult,I=u.chunkMeta,O=this.getCurrentContext(I);if(!O)return this.warn("The loading context changed while buffering fragment "+I.sn+" of level "+I.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(I.level);var x=O.frag,P=O.part,F=w.audio,N=w.text,U=w.id3,G=w.initSegment;if(!this.fragContextChanged(x)){if(this.state=n.State.PARSING,this.audioSwitch&&F&&this.completeAudioSwitch(),G!=null&&G.tracks&&(this._bufferInitSegment(G.tracks,x,I),C.trigger(s.Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:T,tracks:G.tracks})),F){var V=F.startPTS,X=F.endPTS,j=F.startDTS,z=F.endDTS;P&&(P.elementaryStreams[E.ElementaryStreamTypes.AUDIO]={startPTS:V,endPTS:X,startDTS:j,endDTS:z}),x.setElementaryStreamInfo(E.ElementaryStreamTypes.AUDIO,V,X,j,z),this.bufferFragmentData(F,x,P,I)}if(U!=null&&(g=U.samples)!==null&&g!==void 0&&g.length){var W=l({frag:x,id:T},U);C.trigger(s.Events.FRAG_PARSING_METADATA,W)}if(N){var $=l({frag:x,id:T},N);C.trigger(s.Events.FRAG_PARSING_USERDATA,$)}}},R._bufferInitSegment=function(u,g,T){if(this.state===n.State.PARSING){u.video&&delete u.video;var C=u.audio;if(C){C.levelCodec=C.codec,C.id="audio",this.log("Init audio buffer, container:"+C.container+", codecs[parsed]=["+C.codec+"]"),this.hls.trigger(s.Events.BUFFER_CODECS,u);var w=C.initSegment;if(w!=null&&w.byteLength){var I={type:"audio",frag:g,part:null,chunkMeta:T,parent:g.type,data:w};this.hls.trigger(s.Events.BUFFER_APPENDING,I)}this.tick()}}},R.loadFragment=function(u,g,T){var C=this.fragmentTracker.getState(u);this.fragCurrent=u,(this.audioSwitch||C===_.FragmentState.NOT_LOADED||C===_.FragmentState.PARTIAL)&&(u.sn==="initSegment"?this._loadInitSegment(u):g.live&&!Object(i.isFiniteNumber)(this.initPTS[u.cc])?(this.log("Waiting for video PTS in continuity counter "+u.cc+" of live stream before loading audio fragment "+u.sn+" of level "+this.trackId),this.state=n.State.WAITING_INIT_PTS):(this.startFragRequested=!0,h.prototype.loadFragment.call(this,u,g,T)))},R.completeAudioSwitch=function(){var u=this.hls,g=this.media,T=this.trackId;g&&(this.log("Switching audio track : flushing all audio"),h.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,u.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:T})},A}(n.default);t.default=y},"./src/controller/audio-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/controller/base-playlist-controller.ts"),f=r("./src/types/loader.ts");function _(E,v){for(var d=0;d<v.length;d++){var L=v[d];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(E,L.key,L)}}function b(E,v){return(b=Object.setPrototypeOf||function(d,L){return d.__proto__=L,d})(E,v)}var a=function(E){var v,d;function L(c){var l;return(l=E.call(this,c,"[audio-track-controller]")||this).tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.trackName="",l.selectDefaultTrack=!0,l.registerListeners(),l}d=E,(v=L).prototype=Object.create(d.prototype),v.prototype.constructor=v,b(v,d);var k,m,o=L.prototype;return o.registerListeners=function(){var c=this.hls;c.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(i.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(i.Events.ERROR,this.onError,this)},o.unregisterListeners=function(){var c=this.hls;c.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(i.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(i.Events.ERROR,this.onError,this)},o.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,E.prototype.destroy.call(this)},o.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},o.onManifestParsed=function(c,l){this.tracks=l.audioTracks||[]},o.onAudioTrackLoaded=function(c,l){var p=l.id,y=l.details,h=this.tracksInGroup[p];if(h){var S=h.details;h.details=l.details,this.log("audioTrack "+p+" loaded ["+y.startSN+"-"+y.endSN+"]"),p===this.trackId&&(this.retryCount=0,this.playlistLoaded(p,l,S))}else this.warn("Invalid audio track id "+p)},o.onLevelLoading=function(c,l){this.switchLevel(l.level)},o.onLevelSwitching=function(c,l){this.switchLevel(l.level)},o.switchLevel=function(c){var l=this.hls.levels[c];if(l!=null&&l.audioGroupIds){var p=l.audioGroupIds[l.urlId];if(this.groupId!==p){this.groupId=p;var y=this.tracks.filter(function(S){return!p||S.groupId===p});this.selectDefaultTrack&&!y.some(function(S){return S.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=y;var h={audioTracks:y};this.log("Updating audio tracks, "+y.length+' track(s) found in "'+p+'" group-id'),this.hls.trigger(i.Events.AUDIO_TRACKS_UPDATED,h),this.selectInitialTrack()}}},o.onError=function(c,l){E.prototype.onError.call(this,c,l),!l.fatal&&l.context&&l.context.type===f.PlaylistContextType.AUDIO_TRACK&&l.context.id===this.trackId&&l.context.groupId===this.groupId&&this.retryLoadingOrFail(l)},o.setAudioTrack=function(c){var l=this.tracksInGroup;if(c<0||c>=l.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var p=l[this.trackId];this.log("Now switching to audio-track index "+c);var y=l[c],h=y.id,S=y.groupId,D=S===void 0?"":S,A=y.name,R=y.type,u=y.url;if(this.trackId=c,this.trackName=A,this.selectDefaultTrack=!1,this.hls.trigger(i.Events.AUDIO_TRACK_SWITCHING,{id:h,groupId:D,name:A,type:R,url:u}),!y.details||y.details.live){var g=this.switchParams(y.url,p==null?void 0:p.details);this.loadPlaylist(g)}}},o.selectInitialTrack=function(){var c=this.tracksInGroup;console.assert(c.length,"Initial audio track should be selected when tracks are known");var l=this.trackName,p=this.findTrackId(l)||this.findTrackId();p!==-1?this.setAudioTrack(p):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},o.findTrackId=function(c){for(var l=this.tracksInGroup,p=0;p<l.length;p++){var y=l[p];if((!this.selectDefaultTrack||y.default)&&(!c||c===y.name))return y.id}return-1},o.loadPlaylist=function(c){var l=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(l)){var p=l.id,y=l.groupId,h=l.url;if(c)try{h=c.addDirectives(h)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("loading audio-track playlist for id: "+p),this.clearTimer(),this.hls.trigger(i.Events.AUDIO_TRACK_LOADING,{url:h,id:p,groupId:y,deliveryDirectives:c||null})}},k=L,(m=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1,this.setAudioTrack(c)}}])&&_(k.prototype,m),L}(s.default);t.default=a},"./src/controller/base-playlist-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return b});var i=r("./src/polyfills/number.ts"),n=r("./src/types/level.ts"),s=r("./src/controller/level-helper.ts"),f=r("./src/utils/logger.ts"),_=r("./src/errors.ts"),b=function(){function a(v,d){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=f.logger.log.bind(f.logger,d+":"),this.warn=f.logger.warn.bind(f.logger,d+":"),this.hls=v}var E=a.prototype;return E.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},E.onError=function(v,d){d.fatal&&d.type===_.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},E.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},E.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},E.stopLoad=function(){this.canLoad=!1,this.clearTimer()},E.switchParams=function(v,d){var L=d==null?void 0:d.renditionReports;if(L)for(var k=0;k<L.length;k++){var m=L[k],o=""+m.URI;if(o===v.substr(-o.length)){var c=parseInt(m["LAST-MSN"]),l=parseInt(m["LAST-PART"]);if(d&&this.hls.config.lowLatencyMode){var p=Math.min(d.age-d.partTarget,d.targetduration);l!==void 0&&p>d.partTarget&&(l+=1)}if(Object(i.isFiniteNumber)(c))return new n.HlsUrlParameters(c,Object(i.isFiniteNumber)(l)?l:void 0,n.HlsSkip.No)}}},E.loadPlaylist=function(v){},E.shouldLoadTrack=function(v){return this.canLoad&&v&&!!v.url&&(!v.details||v.details.live)},E.playlistLoaded=function(v,d,L){var k=this,m=d.details,o=d.stats,c=o.loading.end?Math.max(0,self.performance.now()-o.loading.end):0;if(m.advancedDateTime=Date.now()-c,m.live||L!=null&&L.live){if(m.reloaded(L),L&&this.log("live playlist "+v+" "+(m.advanced?"REFRESHED "+m.lastPartSn+"-"+m.lastPartIndex:"MISSED")),L&&m.fragments.length>0&&Object(s.mergeDetails)(L,m),!this.canLoad||!m.live)return;var l,p=void 0,y=void 0;if(m.canBlockReload&&m.endSN&&m.advanced){var h=this.hls.config.lowLatencyMode,S=m.lastPartSn,D=m.endSN,A=m.lastPartIndex,R=S===D;A!==-1?(p=R?D+1:S,y=R?h?0:A:A+1):p=D+1;var u=m.age,g=u+m.ageHeader,T=Math.min(g-m.partTarget,1.5*m.targetduration);if(T>0){if(L&&T>L.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+L.tuneInGoal+" to: "+T+" with playlist age: "+m.age),T=0;else{var C=Math.floor(T/m.targetduration);p+=C,y!==void 0&&(y+=Math.round(T%m.targetduration/m.partTarget)),this.log("CDN Tune-in age: "+m.ageHeader+"s last advanced "+u.toFixed(2)+"s goal: "+T+" skip sn "+C+" to part "+y)}m.tuneInGoal=T}if(l=this.getDeliveryDirectives(m,d.deliveryDirectives,p,y),h||!R)return void this.loadPlaylist(l)}else l=this.getDeliveryDirectives(m,d.deliveryDirectives,p,y);var w=Object(s.computeReloadInterval)(m,o);p!==void 0&&m.canBlockReload&&(w-=m.partTarget||1),this.log("reload live playlist "+v+" in "+Math.round(w)+" ms"),this.timer=self.setTimeout(function(){return k.loadPlaylist(l)},w)}else this.clearTimer()},E.getDeliveryDirectives=function(v,d,L,k){var m=Object(n.getSkipValue)(v,L);return d!=null&&d.skip&&v.deltaUpdateFailed&&(L=d.msn,k=d.part,m=n.HlsSkip.No),new n.HlsUrlParameters(L,k,m)},E.retryLoadingOrFail=function(v){var d,L=this,k=this.hls.config,m=this.retryCount<k.levelLoadingMaxRetry;if(m)if(this.retryCount++,v.details.indexOf("LoadTimeOut")>-1&&(d=v.context)!==null&&d!==void 0&&d.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+v.details+'"'),this.loadPlaylist();else{var o=Math.min(Math.pow(2,this.retryCount)*k.levelLoadingRetryDelay,k.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return L.loadPlaylist()},o),this.warn("retry playlist loading #"+this.retryCount+" in "+o+' ms after "'+v.details+'"')}else this.warn('cannot recover from error "'+v.details+'"'),this.clearTimer(),v.fatal=!0;return m},a}()},"./src/controller/base-stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"State",function(){return h}),r.d(t,"default",function(){return S});var i=r("./src/polyfills/number.ts"),n=r("./src/task-loop.ts"),s=r("./src/controller/fragment-tracker.ts"),f=r("./src/utils/buffer-helper.ts"),_=r("./src/utils/logger.ts"),b=r("./src/events.ts"),a=r("./src/errors.ts"),E=r("./src/types/transmuxer.ts"),v=r("./src/utils/mp4-tools.ts"),d=r("./src/utils/discontinuities.ts"),L=r("./src/controller/fragment-finders.ts"),k=r("./src/controller/level-helper.ts"),m=r("./src/loader/fragment-loader.ts"),o=r("./src/crypt/decrypter.ts"),c=r("./src/utils/time-ranges.ts"),l=r("./src/types/loader.ts");function p(D,A){for(var R=0;R<A.length;R++){var u=A[R];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(D,u.key,u)}}function y(D,A){return(y=Object.setPrototypeOf||function(R,u){return R.__proto__=u,R})(D,A)}var h={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},S=function(D){var A,R;function u(w,I,O){var x;return(x=D.call(this)||this).hls=void 0,x.fragPrevious=null,x.fragCurrent=null,x.fragmentTracker=void 0,x.transmuxer=null,x._state=h.STOPPED,x.media=void 0,x.mediaBuffer=void 0,x.config=void 0,x.bitrateTest=!1,x.lastCurrentTime=0,x.nextLoadPosition=0,x.startPosition=0,x.loadedmetadata=!1,x.fragLoadError=0,x.retryDate=0,x.levels=null,x.fragmentLoader=void 0,x.levelLastLoaded=null,x.startFragRequested=!1,x.decrypter=void 0,x.initPTS=[],x.onvseeking=null,x.onvended=null,x.logPrefix="",x.log=void 0,x.warn=void 0,x.logPrefix=O,x.log=_.logger.log.bind(_.logger,O+":"),x.warn=_.logger.warn.bind(_.logger,O+":"),x.hls=w,x.fragmentLoader=new m.default(w.config),x.fragmentTracker=I,x.config=w.config,x.decrypter=new o.default(w,w.config),w.on(b.Events.KEY_LOADED,x.onKeyLoaded,function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(x)),x}R=D,(A=u).prototype=Object.create(R.prototype),A.prototype.constructor=A,y(A,R);var g,T,C=u.prototype;return C.doTick=function(){this.onTickEnd()},C.onTickEnd=function(){},C.startLoad=function(w){},C.stopLoad=function(){this.fragmentLoader.abort();var w=this.fragCurrent;w&&this.fragmentTracker.removeFragment(w),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=h.STOPPED},C._streamEnded=function(w,I){var O=this.fragCurrent,x=this.fragmentTracker;if(!I.live&&O&&O.sn===I.endSN&&!w.nextStart){var P=x.getState(O);return P===s.FragmentState.PARTIAL||P===s.FragmentState.OK}return!1},C.onMediaAttached=function(w,I){var O=this.media=this.mediaBuffer=I.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),O.addEventListener("seeking",this.onvseeking),O.addEventListener("ended",this.onvended);var x=this.config;this.levels&&x.autoStartLoad&&this.state===h.STOPPED&&this.startLoad(x.startPosition)},C.onMediaDetaching=function(){var w=this.media;w!=null&&w.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),w&&(w.removeEventListener("seeking",this.onvseeking),w.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},C.onMediaSeeking=function(){var w=this.config,I=this.fragCurrent,O=this.media,x=this.mediaBuffer,P=this.state,F=O?O.currentTime:0,N=f.BufferHelper.bufferInfo(x||O,F,w.maxBufferHole);if(this.log("media seeking to "+(Object(i.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+P),P===h.ENDED)this.resetLoadingState();else if(I&&!N.len){var U=w.maxFragLookUpTolerance,G=I.start-U,V=F>I.start+I.duration+U;(F<G||V)&&(V&&I.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),I.loader.abort()),this.resetLoadingState())}O&&(this.lastCurrentTime=F),this.loadedmetadata||N.len||(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},C.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},C.onKeyLoaded=function(w,I){if(this.state===h.KEY_LOADING&&I.frag===this.fragCurrent&&this.levels){this.state=h.IDLE;var O=this.levels[I.frag.level].details;O&&this.loadFragment(I.frag,O,I.frag.start)}},C.onHandlerDestroying=function(){this.stopLoad(),D.prototype.onHandlerDestroying.call(this)},C.onHandlerDestroyed=function(){this.state=h.STOPPED,this.hls.off(b.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,D.prototype.onHandlerDestroyed.call(this)},C.loadKey=function(w,I){this.log("Loading key for "+w.sn+" of ["+I.startSN+"-"+I.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+w.level),this.state=h.KEY_LOADING,this.fragCurrent=w,this.hls.trigger(b.Events.KEY_LOADING,{frag:w})},C.loadFragment=function(w,I,O){this._loadFragForPlayback(w,I,O)},C._loadFragForPlayback=function(w,I,O){var x=this;this._doFragLoad(w,I,O,function(P){if(x.fragContextChanged(w))return x.warn("Fragment "+w.sn+(P.part?" p: "+P.part.index:"")+" of level "+w.level+" was dropped during download."),void x.fragmentTracker.removeFragment(w);w.stats.chunkCount++,x._handleFragmentLoadProgress(P)}).then(function(P){if(P){x.fragLoadError=0;var F=x.state;if(!x.fragContextChanged(w))return"payload"in P&&(x.log("Loaded fragment "+w.sn+" of level "+w.level),x.hls.trigger(b.Events.FRAG_LOADED,P),x.state===h.BACKTRACKING)?(x.fragmentTracker.backtrack(w,P),void x.resetFragmentLoading(w)):void x._handleFragmentLoadComplete(P);(F===h.FRAG_LOADING||F===h.BACKTRACKING||!x.fragCurrent&&F===h.PARSING)&&(x.fragmentTracker.removeFragment(w),x.state=h.IDLE)}}).catch(function(P){x.warn(P),x.resetFragmentLoading(w)})},C.flushMainBuffer=function(w,I,O){if(O===void 0&&(O=null),w-I){var x={startOffset:w,endOffset:I,type:O};this.fragLoadError=0,this.hls.trigger(b.Events.BUFFER_FLUSHING,x)}},C._loadInitSegment=function(w){var I=this;this._doFragLoad(w).then(function(O){if(!O||I.fragContextChanged(w)||!I.levels)throw new Error("init load aborted");return O}).then(function(O){var x=I.hls,P=O.payload,F=w.decryptdata;if(P&&P.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var N=self.performance.now();return I.decrypter.webCryptoDecrypt(new Uint8Array(P),F.key.buffer,F.iv.buffer).then(function(U){var G=self.performance.now();return x.trigger(b.Events.FRAG_DECRYPTED,{frag:w,payload:U,stats:{tstart:N,tdecrypt:G}}),O.payload=U,O})}return O}).then(function(O){var x=I.fragCurrent,P=I.hls,F=I.levels;if(!F)throw new Error("init load aborted, missing levels");var N=F[w.level].details;console.assert(N,"Level details are defined when init segment is loaded");var U=w.stats;I.state=h.IDLE,I.fragLoadError=0,w.data=new Uint8Array(O.payload),U.parsing.start=U.buffering.start=self.performance.now(),U.parsing.end=U.buffering.end=self.performance.now(),O.frag===x&&P.trigger(b.Events.FRAG_BUFFERED,{stats:U,frag:x,part:null,id:w.type}),I.tick()}).catch(function(O){I.warn(O),I.resetFragmentLoading(w)})},C.fragContextChanged=function(w){var I=this.fragCurrent;return!w||!I||w.level!==I.level||w.sn!==I.sn||w.urlId!==I.urlId},C.fragBufferedComplete=function(w,I){var O=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+w.type+" sn: "+w.sn+(I?" part: "+I.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+w.level+" "+c.default.toString(f.BufferHelper.getBuffered(O))),this.state=h.IDLE,this.tick()},C._handleFragmentLoadComplete=function(w){var I=this.transmuxer;if(I){var O=w.frag,x=w.part,P=w.partsLoaded,F=!P||P.length===0||P.some(function(U){return!U}),N=new E.ChunkMetadata(O.level,O.sn,O.stats.chunkCount+1,0,x?x.index:-1,!F);I.flush(N)}},C._handleFragmentLoadProgress=function(w){},C._doFragLoad=function(w,I,O,x){var P=this;if(O===void 0&&(O=null),!this.levels)throw new Error("frag load aborted, missing levels");if(O=Math.max(w.start,O||0),this.config.lowLatencyMode&&I){var F=I.partList;if(F&&x){O>w.end&&I.fragmentHint&&(w=I.fragmentHint);var N=this.getNextPart(F,w,O);if(N>-1){var U=F[N];return this.log("Loading part sn: "+w.sn+" p: "+U.index+" cc: "+w.cc+" of playlist ["+I.startSN+"-"+I.endSN+"] parts [0-"+N+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+w.level+", target: "+parseFloat(O.toFixed(3))),this.nextLoadPosition=U.start+U.duration,this.state=h.FRAG_LOADING,this.hls.trigger(b.Events.FRAG_LOADING,{frag:w,part:F[N],targetBufferTime:O}),this.doFragPartsLoad(w,F,N,x).catch(function(G){return P.handleFragLoadError(G)})}if(!w.url||this.loadedEndOfParts(F,O))return Promise.resolve(null)}}return this.log("Loading fragment "+w.sn+" cc: "+w.cc+" "+(I?"of ["+I.startSN+"-"+I.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+w.level+", target: "+parseFloat(O.toFixed(3))),Object(i.isFiniteNumber)(w.sn)&&!this.bitrateTest&&(this.nextLoadPosition=w.start+w.duration),this.state=h.FRAG_LOADING,this.hls.trigger(b.Events.FRAG_LOADING,{frag:w,targetBufferTime:O}),this.fragmentLoader.load(w,x).catch(function(G){return P.handleFragLoadError(G)})},C.doFragPartsLoad=function(w,I,O,x){var P=this;return new Promise(function(F,N){var U=[];(function G(V){var X=I[V];P.fragmentLoader.loadPart(w,X,x).then(function(j){U[X.index]=j;var z=j.part;P.hls.trigger(b.Events.FRAG_LOADED,j);var W=I[V+1];if(!W||W.fragment!==w)return F({frag:w,part:z,partsLoaded:U});G(V+1)}).catch(N)})(O)})},C.handleFragLoadError=function(w){var I=w.data;return I&&I.details===a.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(I.frag,I.part):this.hls.trigger(b.Events.ERROR,I),null},C._handleTransmuxerFlush=function(w){var I=this.getCurrentContext(w);if(I&&this.state===h.PARSING){var O=I.frag,x=I.part,P=I.level,F=self.performance.now();O.stats.parsing.end=F,x&&(x.stats.parsing.end=F),this.updateLevelTiming(O,x,P,w.partial)}else this.fragCurrent||(this.state=h.IDLE)},C.getCurrentContext=function(w){var I=this.levels,O=w.level,x=w.sn,P=w.part;if(!I||!I[O])return this.warn("Levels object was unset while buffering fragment "+x+" of level "+O+". The current chunk will not be buffered."),null;var F=I[O],N=P>-1?Object(k.getPartWith)(F,x,P):null,U=N?N.fragment:Object(k.getFragmentWithSN)(F,x,this.fragCurrent);return U?{frag:U,part:N,level:F}:null},C.bufferFragmentData=function(w,I,O,x){if(w&&this.state===h.PARSING){var P=w.data1,F=w.data2,N=P;if(P&&F&&(N=Object(v.appendUint8Array)(P,F)),N&&N.length){var U={type:w.type,frag:I,part:O,chunkMeta:x,parent:I.type,data:N};this.hls.trigger(b.Events.BUFFER_APPENDING,U),w.dropped&&w.independent&&!O&&this.flushBufferGap(I)}}},C.flushBufferGap=function(w){var I=this.media;if(I)if(f.BufferHelper.isBuffered(I,I.currentTime)){var O=I.currentTime,x=f.BufferHelper.bufferInfo(I,O,0),P=w.duration,F=Math.min(2*this.config.maxFragLookUpTolerance,.25*P),N=Math.max(Math.min(w.start-F,x.end-F),O+F);w.start-N>F&&this.flushMainBuffer(N,w.start)}else this.flushMainBuffer(0,w.start)},C.getFwdBufferInfo=function(w,I){var O=this.config,x=this.getLoadPosition();if(!Object(i.isFiniteNumber)(x))return null;var P=f.BufferHelper.bufferInfo(w,x,O.maxBufferHole);if(P.len===0&&P.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(x,I);if(F&&P.nextStart<F.end)return f.BufferHelper.bufferInfo(w,x,Math.max(P.nextStart,O.maxBufferHole))}return P},C.getMaxBufferLength=function(w){var I,O=this.config;return I=w?Math.max(8*O.maxBufferSize/w,O.maxBufferLength):O.maxBufferLength,Math.min(I,O.maxMaxBufferLength)},C.reduceMaxBufferLength=function(w){var I=this.config,O=w||I.maxBufferLength;return I.maxMaxBufferLength>=O&&(I.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+I.maxMaxBufferLength+"s"),!0)},C.getNextFragment=function(w,I){var O,x,P=I.fragments,F=P.length;if(!F)return null;var N,U=this.config,G=P[0].start;if(I.live){var V=U.initialLiveManifestSize;if(F<V)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+V+")"),null;I.PTSKnown||this.startFragRequested||this.startPosition!==-1||(N=this.getInitialLiveFragment(I,P),this.startPosition=N?this.hls.liveSyncPosition||N.start:w)}else w<=G&&(N=P[0]);if(!N){var X=U.lowLatencyMode?I.partEnd:I.fragmentEnd;N=this.getFragmentAtPosition(w,X,I)}return(O=N)===null||O===void 0||!O.initSegment||(x=N)!==null&&x!==void 0&&x.initSegment.data||this.bitrateTest||(N=N.initSegment),N},C.getNextPart=function(w,I,O){for(var x=-1,P=!1,F=!0,N=0,U=w.length;N<U;N++){var G=w[N];if(F=F&&!G.independent,x>-1&&O<G.start)break;var V=G.loaded;!V&&(P||G.independent||F)&&G.fragment===I&&(x=N),P=V}return x},C.loadedEndOfParts=function(w,I){var O=w[w.length-1];return O&&I>O.start&&O.loaded},C.getInitialLiveFragment=function(w,I){var O=this.fragPrevious,x=null;if(O){if(w.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+O.programDateTime),x=Object(L.findFragmentByPDT)(I,O.endProgramDateTime,this.config.maxFragLookUpTolerance)),!x){var P=O.sn+1;if(P>=w.startSN&&P<=w.endSN){var F=I[P-w.startSN];O.cc===F.cc&&(x=F,this.log("Live playlist, switching playlist, load frag with next SN: "+x.sn))}x||(x=Object(L.findFragWithCC)(I,O.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+x.sn)}}else{var N=this.hls.liveSyncPosition;N!==null&&(x=this.getFragmentAtPosition(N,this.bitrateTest?w.fragmentEnd:w.edge,w))}return x},C.getFragmentAtPosition=function(w,I,O){var x,P=this.config,F=this.fragPrevious,N=O.fragments,U=O.endSN,G=O.fragmentHint,V=P.maxFragLookUpTolerance,X=!!(P.lowLatencyMode&&O.partList&&G);if(X&&G&&!this.bitrateTest&&(N=N.concat(G),U=G.sn),w<I){var j=w>I-V?0:V;x=Object(L.findFragmentByPTS)(F,N,w,j)}else x=N[N.length-1];if(x){var z=x.sn-O.startSN,W=F&&x.level===F.level,$=N[z+1];if(this.fragmentTracker.getState(x)===s.FragmentState.BACKTRACKED){x=null;for(var ne=z;N[ne]&&this.fragmentTracker.getState(N[ne])===s.FragmentState.BACKTRACKED;)x=F?N[ne--]:N[--ne];x||(x=$)}else F&&x.sn===F.sn&&!X&&W&&(x.sn<U&&this.fragmentTracker.getState($)!==s.FragmentState.OK?(this.log("SN "+x.sn+" just loaded, load next one: "+$.sn),x=$):x=null)}return x},C.synchronizeToLiveEdge=function(w){var I=this.config,O=this.media;if(O){var x=this.hls.liveSyncPosition,P=O.currentTime,F=w.fragments[0].start,N=w.edge,U=P>=F-I.maxFragLookUpTolerance&&P<=N;if(x!==null&&O.duration>x&&(P<x||!U)){var G=I.liveMaxLatencyDuration!==void 0?I.liveMaxLatencyDuration:I.liveMaxLatencyDurationCount*w.targetduration;(!U&&O.readyState<4||P<N-G)&&(this.loadedmetadata||(this.nextLoadPosition=x),O.readyState&&(this.warn("Playback: "+P.toFixed(3)+" is located too far from the end of live sliding playlist: "+N+", reset currentTime to : "+x.toFixed(3)),O.currentTime=x))}}},C.alignPlaylists=function(w,I){var O=this.levels,x=this.levelLastLoaded,P=this.fragPrevious,F=x!==null?O[x]:null,N=w.fragments.length;if(!N)return this.warn("No fragments in live playlist"),0;var U=w.fragments[0].start,G=!I,V=w.alignedSliding&&Object(i.isFiniteNumber)(U);if(G||!V&&!U){Object(d.alignStream)(P,F,w);var X=w.fragments[0].start;return this.log("Live playlist sliding: "+X.toFixed(2)+" start-sn: "+(I?I.startSN:"na")+"->"+w.startSN+" prev-sn: "+(P?P.sn:"na")+" fragments: "+N),X}return U},C.waitForCdnTuneIn=function(w){return w.live&&w.canBlockReload&&w.tuneInGoal>Math.max(w.partHoldBack,3*w.partTarget)},C.setStartPosition=function(w,I){var O=this.startPosition;if(O<I&&(O=-1),O===-1||this.lastCurrentTime===-1){var x=w.startTimeOffset;Object(i.isFiniteNumber)(x)?(O=I+x,x<0&&(O+=w.totalduration),O=Math.min(Math.max(I,O),I+w.totalduration),this.log("Start time offset "+x+" found in playlist, adjust startPosition to "+O),this.startPosition=O):w.live?O=this.hls.liveSyncPosition||I:this.startPosition=O=0,this.lastCurrentTime=O}this.nextLoadPosition=O},C.getLoadPosition=function(){var w=this.media,I=0;return this.loadedmetadata&&w?I=w.currentTime:this.nextLoadPosition&&(I=this.nextLoadPosition),I},C.handleFragLoadAborted=function(w,I){this.transmuxer&&w.sn!=="initSegment"&&w.stats.aborted&&(this.warn("Fragment "+w.sn+(I?" part"+I.index:"")+" of level "+w.level+" was aborted"),this.resetFragmentLoading(w))},C.resetFragmentLoading=function(w){this.fragCurrent&&this.fragContextChanged(w)||(this.state=h.IDLE)},C.onFragmentOrKeyLoadError=function(w,I){if(!I.fatal){var O=I.frag;if(O&&O.type===w){var x=this.fragCurrent;console.assert(x&&O.sn===x.sn&&O.level===x.level&&O.urlId===x.urlId,"Frag load error must match current frag to retry");var P=this.config;if(this.fragLoadError+1<=P.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(O.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*P.fragLoadingRetryDelay,P.fragLoadingMaxRetryTimeout);this.warn("Fragment "+O.sn+" of "+w+" "+O.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=h.FRAG_LOADING_WAITING_RETRY}else I.levelRetry?(w===l.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=h.IDLE):(_.logger.error(I.details+" reaches max retry, redispatch as fatal ..."),I.fatal=!0,this.hls.stopLoad(),this.state=h.ERROR)}}},C.afterBufferFlushed=function(w,I,O){if(w){var x=f.BufferHelper.getBuffered(w);this.fragmentTracker.detectEvictedFragments(I,x,O),this.state===h.ENDED&&this.resetLoadingState()}},C.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=h.IDLE},C.resetLiveStartWhenNotLoaded=function(w){if(!this.loadedmetadata){this.startFragRequested=!1;var I=this.levels?this.levels[w].details:null;if(I!=null&&I.live)return this.startPosition=-1,this.setStartPosition(I,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},C.updateLevelTiming=function(w,I,O,x){var P=this,F=O.details;console.assert(!!F,"level.details must be defined"),Object.keys(w.elementaryStreams).reduce(function(N,U){var G=w.elementaryStreams[U];if(G){var V=G.endPTS-G.startPTS;if(V<=0)return P.warn("Could not parse fragment "+w.sn+" "+U+" duration reliably ("+V+") resetting transmuxer to fallback to playlist timing"),P.resetTransmuxer(),N||!1;var X=x?0:Object(k.updateFragPTSDTS)(F,w,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return P.hls.trigger(b.Events.LEVEL_PTS_UPDATED,{details:F,level:O,drift:X,type:U,frag:w,start:G.startPTS,end:G.endPTS}),!0}return N},!1)?(this.state=h.PARSED,this.hls.trigger(b.Events.FRAG_PARSED,{frag:w,part:I})):this.resetLoadingState()},C.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},g=u,(T=[{key:"state",get:function(){return this._state},set:function(w){var I=this._state;I!==w&&(this._state=w,this.log(I+"->"+w))}}])&&p(g.prototype,T),u}(n.default)},"./src/controller/buffer-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return L});var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts"),f=r("./src/errors.ts"),_=r("./src/utils/buffer-helper.ts"),b=r("./src/utils/mediasource-helper.ts"),a=r("./src/loader/fragment.ts"),E=r("./src/controller/buffer-operation-queue.ts"),v=Object(b.getMediaSource)(),d=/([ha]vc.)(?:\.[^.,]+)+/,L=function(){function k(o){var c=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var l=c.hls,p=c.media,y=c.mediaSource;s.logger.log("[buffer-controller]: Media source opened"),p&&(c.updateMediaElementDuration(),l.trigger(n.Events.MEDIA_ATTACHED,{media:p})),y&&y.removeEventListener("sourceopen",c._onMediaSourceOpen),c.checkPendingTracks()},this._onMediaSourceClose=function(){s.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){s.logger.log("[buffer-controller]: Media source ended")},this.hls=o,this._initSourceBuffer(),this.registerListeners()}var m=k.prototype;return m.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},m.destroy=function(){this.unregisterListeners(),this.details=null},m.registerListeners=function(){var o=this.hls;o.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(n.Events.BUFFER_RESET,this.onBufferReset,this),o.on(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.on(n.Events.BUFFER_EOS,this.onBufferEos,this),o.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.on(n.Events.FRAG_PARSED,this.onFragParsed,this),o.on(n.Events.FRAG_CHANGED,this.onFragChanged,this)},m.unregisterListeners=function(){var o=this.hls;o.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(n.Events.BUFFER_RESET,this.onBufferReset,this),o.off(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.off(n.Events.BUFFER_EOS,this.onBufferEos,this),o.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.off(n.Events.FRAG_PARSED,this.onFragParsed,this),o.off(n.Events.FRAG_CHANGED,this.onFragChanged,this)},m._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new E.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},m.onManifestParsed=function(o,c){var l=2;(c.audio&&!c.video||!c.altAudio)&&(l=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=l,this.details=null,s.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},m.onMediaAttaching=function(o,c){var l=this.media=c.media;if(l&&v){var p=this.mediaSource=new v;p.addEventListener("sourceopen",this._onMediaSourceOpen),p.addEventListener("sourceended",this._onMediaSourceEnded),p.addEventListener("sourceclose",this._onMediaSourceClose),l.src=self.URL.createObjectURL(p),this._objectUrl=l.src}},m.onMediaDetaching=function(){var o=this.media,c=this.mediaSource,l=this._objectUrl;if(c){if(s.logger.log("[buffer-controller]: media source detaching"),c.readyState==="open")try{c.endOfStream()}catch(p){s.logger.warn("[buffer-controller]: onMediaDetaching: "+p.message+" while calling endOfStream")}this.onBufferReset(),c.removeEventListener("sourceopen",this._onMediaSourceOpen),c.removeEventListener("sourceended",this._onMediaSourceEnded),c.removeEventListener("sourceclose",this._onMediaSourceClose),o&&(l&&self.URL.revokeObjectURL(l),o.src===l?(o.removeAttribute("src"),o.load()):s.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(n.Events.MEDIA_DETACHED,void 0)},m.onBufferReset=function(){var o=this;this.getSourceBufferTypes().forEach(function(c){var l=o.sourceBuffer[c];try{l&&(o.removeBufferListeners(c),o.mediaSource&&o.mediaSource.removeSourceBuffer(l),o.sourceBuffer[c]=void 0)}catch(p){s.logger.warn("[buffer-controller]: Failed to reset the "+c+" buffer",p)}}),this._initSourceBuffer()},m.onBufferCodecs=function(o,c){var l=this,p=this.getSourceBufferTypes().length;Object.keys(c).forEach(function(y){if(p){var h=l.tracks[y];if(h&&typeof h.buffer.changeType=="function"){var S=c[y],D=S.codec,A=S.levelCodec,R=S.container;if((h.levelCodec||h.codec).replace(d,"$1")!==(A||D).replace(d,"$1")){var u=R+";codecs="+(A||D);l.appendChangeType(y,u)}}}else l.pendingTracks[y]=c[y]}),p||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},m.appendChangeType=function(o,c){var l=this,p=this.operationQueue,y={execute:function(){var h=l.sourceBuffer[o];h&&(s.logger.log("[buffer-controller]: changing "+o+" sourceBuffer type to "+c),h.changeType(c)),p.shiftAndExecuteNext(o)},onStart:function(){},onComplete:function(){},onError:function(h){s.logger.warn("[buffer-controller]: Failed to change "+o+" SourceBuffer type",h)}};p.append(y,o)},m.onBufferAppending=function(o,c){var l=this,p=this.hls,y=this.operationQueue,h=this.tracks,S=c.data,D=c.type,A=c.frag,R=c.part,u=c.chunkMeta,g=u.buffering[D],T=self.performance.now();g.start=T;var C=A.stats.buffering,w=R?R.stats.buffering:null;C.start===0&&(C.start=T),w&&w.start===0&&(w.start=T);var I=h.audio,O=D==="audio"&&u.id===1&&(I==null?void 0:I.container)==="audio/mpeg",x={execute:function(){if(g.executeStart=self.performance.now(),O){var P=l.sourceBuffer[D];if(P){var F=A.start-P.timestampOffset;Math.abs(F)>=.1&&(s.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+A.start+" (delta: "+F+") sn: "+A.sn+")"),P.timestampOffset=A.start)}}l.appendExecutor(S,D)},onStart:function(){},onComplete:function(){var P=self.performance.now();g.executeEnd=g.end=P,C.first===0&&(C.first=P),w&&w.first===0&&(w.first=P);var F=l.sourceBuffer,N={};for(var U in F)N[U]=_.BufferHelper.getBuffered(F[U]);l.appendError=0,l.hls.trigger(n.Events.BUFFER_APPENDED,{type:D,frag:A,part:R,chunkMeta:u,parent:A.type,timeRanges:N})},onError:function(P){s.logger.error("[buffer-controller]: Error encountered while trying to append to the "+D+" SourceBuffer",P);var F={type:f.ErrorTypes.MEDIA_ERROR,parent:A.type,details:f.ErrorDetails.BUFFER_APPEND_ERROR,err:P,fatal:!1};P.code===DOMException.QUOTA_EXCEEDED_ERR?F.details=f.ErrorDetails.BUFFER_FULL_ERROR:(l.appendError++,F.details=f.ErrorDetails.BUFFER_APPEND_ERROR,l.appendError>p.config.appendErrorMaxRetry&&(s.logger.error("[buffer-controller]: Failed "+p.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),F.fatal=!0)),p.trigger(n.Events.ERROR,F)}};y.append(x,D)},m.onBufferFlushing=function(o,c){var l=this,p=this.operationQueue,y=function(h){return{execute:l.removeExecutor.bind(l,h,c.startOffset,c.endOffset),onStart:function(){},onComplete:function(){l.hls.trigger(n.Events.BUFFER_FLUSHED,{type:h})},onError:function(S){s.logger.warn("[buffer-controller]: Failed to remove from "+h+" SourceBuffer",S)}}};c.type?p.append(y(c.type),c.type):this.getSourceBufferTypes().forEach(function(h){p.append(y(h),h)})},m.onFragParsed=function(o,c){var l=this,p=c.frag,y=c.part,h=[],S=y?y.elementaryStreams:p.elementaryStreams;S[a.ElementaryStreamTypes.AUDIOVIDEO]?h.push("audiovideo"):(S[a.ElementaryStreamTypes.AUDIO]&&h.push("audio"),S[a.ElementaryStreamTypes.VIDEO]&&h.push("video")),h.length===0&&s.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+p.type+" level: "+p.level+" sn: "+p.sn),this.blockBuffers(function(){var D=self.performance.now();p.stats.buffering.end=D,y&&(y.stats.buffering.end=D);var A=y?y.stats:p.stats;l.hls.trigger(n.Events.FRAG_BUFFERED,{frag:p,part:y,stats:A,id:p.type})},h)},m.onFragChanged=function(o,c){this.flushBackBuffer()},m.onBufferEos=function(o,c){var l=this;this.getSourceBufferTypes().reduce(function(p,y){var h=l.sourceBuffer[y];return c.type&&c.type!==y||h&&!h.ended&&(h.ended=!0,s.logger.log("[buffer-controller]: "+y+" sourceBuffer now EOS")),p&&!(h&&!h.ended)},!0)&&this.blockBuffers(function(){var p=l.mediaSource;p&&p.readyState==="open"&&p.endOfStream()})},m.onLevelUpdated=function(o,c){var l=c.details;l.fragments.length&&(this.details=l,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},m.flushBackBuffer=function(){var o=this.hls,c=this.details,l=this.media,p=this.sourceBuffer;if(l&&c!==null){var y=this.getSourceBufferTypes();if(y.length){var h=c.live&&o.config.liveBackBufferLength!==null?o.config.liveBackBufferLength:o.config.backBufferLength;if(Object(i.isFiniteNumber)(h)&&!(h<0)){var S=l.currentTime,D=c.levelTargetDuration,A=Math.max(h,D),R=Math.floor(S/D)*D-A;y.forEach(function(u){var g=p[u];if(g){var T=_.BufferHelper.getBuffered(g);T.length>0&&R>T.start(0)&&(o.trigger(n.Events.BACK_BUFFER_REACHED,{bufferEnd:R}),c.live&&o.trigger(n.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:R}),o.trigger(n.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:R,type:u}))}})}}}},m.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var o=this.details,c=this.hls,l=this.media,p=this.mediaSource,y=o.fragments[0].start+o.totalduration,h=l.duration,S=Object(i.isFiniteNumber)(p.duration)?p.duration:0;o.live&&c.config.liveDurationInfinity?(s.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),p.duration=1/0,this.updateSeekableRange(o)):(y>S&&y>h||!Object(i.isFiniteNumber)(h))&&(s.logger.log("[buffer-controller]: Updating Media Source duration to "+y.toFixed(3)),p.duration=y)}},m.updateSeekableRange=function(o){var c=this.mediaSource,l=o.fragments;if(l.length&&o.live&&c!=null&&c.setLiveSeekableRange){var p=Math.max(0,l[0].start),y=Math.max(p,p+o.totalduration);c.setLiveSeekableRange(p,y)}},m.checkPendingTracks=function(){var o=this.bufferCodecEventsExpected,c=this.operationQueue,l=this.pendingTracks,p=Object.keys(l).length;if(p&&!o||p===2){this.createSourceBuffers(l),this.pendingTracks={};var y=this.getSourceBufferTypes();if(y.length===0)return void this.hls.trigger(n.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});y.forEach(function(h){c.executeNext(h)})}},m.createSourceBuffers=function(o){var c=this.sourceBuffer,l=this.mediaSource;if(!l)throw Error("createSourceBuffers called when mediaSource was null");var p=0;for(var y in o)if(!c[y]){var h=o[y];if(!h)throw Error("source buffer exists for track "+y+", however track does not");var S=h.levelCodec||h.codec,D=h.container+";codecs="+S;s.logger.log("[buffer-controller]: creating sourceBuffer("+D+")");try{var A=c[y]=l.addSourceBuffer(D),R=y;this.addBufferListener(R,"updatestart",this._onSBUpdateStart),this.addBufferListener(R,"updateend",this._onSBUpdateEnd),this.addBufferListener(R,"error",this._onSBUpdateError),this.tracks[y]={buffer:A,codec:S,container:h.container,levelCodec:h.levelCodec,id:h.id},p++}catch(u){s.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+u.message),this.hls.trigger(n.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,mimeType:D})}}p&&this.hls.trigger(n.Events.BUFFER_CREATED,{tracks:this.tracks})},m._onSBUpdateStart=function(o){this.operationQueue.current(o).onStart()},m._onSBUpdateEnd=function(o){var c=this.operationQueue;c.current(o).onComplete(),c.shiftAndExecuteNext(o)},m._onSBUpdateError=function(o,c){s.logger.error("[buffer-controller]: "+o+" SourceBuffer error",c),this.hls.trigger(n.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var l=this.operationQueue.current(o);l&&l.onError(c)},m.removeExecutor=function(o,c,l){var p=this.media,y=this.mediaSource,h=this.operationQueue,S=this.sourceBuffer[o];if(!p||!y||!S)return s.logger.warn("[buffer-controller]: Attempting to remove from the "+o+" SourceBuffer, but it does not exist"),void h.shiftAndExecuteNext(o);var D=Object(i.isFiniteNumber)(p.duration)?p.duration:1/0,A=Object(i.isFiniteNumber)(y.duration)?y.duration:1/0,R=Math.max(0,c),u=Math.min(l,D,A);u>R?(s.logger.log("[buffer-controller]: Removing ["+R+","+u+"] from the "+o+" SourceBuffer"),console.assert(!S.updating,o+" sourceBuffer must not be updating"),S.remove(R,u)):h.shiftAndExecuteNext(o)},m.appendExecutor=function(o,c){var l=this.operationQueue,p=this.sourceBuffer[c];if(!p)return s.logger.warn("[buffer-controller]: Attempting to append to the "+c+" SourceBuffer, but it does not exist"),void l.shiftAndExecuteNext(c);p.ended=!1,console.assert(!p.updating,c+" sourceBuffer must not be updating"),p.appendBuffer(o)},m.blockBuffers=function(o,c){var l=this;if(c===void 0&&(c=this.getSourceBufferTypes()),!c.length)return s.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(o);var p=this.operationQueue,y=c.map(function(h){return p.appendBlocker(h)});Promise.all(y).then(function(){o(),c.forEach(function(h){var S=l.sourceBuffer[h];S&&S.updating||p.shiftAndExecuteNext(h)})})},m.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},m.addBufferListener=function(o,c,l){var p=this.sourceBuffer[o];if(p){var y=l.bind(this,o);this.listeners[o].push({event:c,listener:y}),p.addEventListener(c,y)}},m.removeBufferListeners=function(o){var c=this.sourceBuffer[o];c&&this.listeners[o].forEach(function(l){c.removeEventListener(l.event,l.listener)})},k}()},"./src/controller/buffer-operation-queue.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return n});var i=r("./src/utils/logger.ts"),n=function(){function s(_){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=_}var f=s.prototype;return f.append=function(_,b){var a=this.queues[b];a.push(_),a.length===1&&this.buffers[b]&&this.executeNext(b)},f.insertAbort=function(_,b){this.queues[b].unshift(_),this.executeNext(b)},f.appendBlocker=function(_){var b,a=new Promise(function(v){b=v}),E={execute:b,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(E,_),a},f.executeNext=function(_){var b=this.buffers,a=this.queues,E=b[_],v=a[_];if(v.length){var d=v[0];try{d.execute()}catch(L){i.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),d.onError(L),E&&E.updating||(v.shift(),this.executeNext(_))}}},f.shiftAndExecuteNext=function(_){this.queues[_].shift(),this.executeNext(_)},f.current=function(_){return this.queues[_][0]},s}()},"./src/controller/cap-level-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts");function n(f,_){for(var b=0;b<_.length;b++){var a=_[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(f,a.key,a)}}var s=function(){function f(v){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=v,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var _,b,a,E=f.prototype;return E.setStreamController=function(v){this.streamController=v},E.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},E.registerListeners=function(){var v=this.hls;v.on(i.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),v.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},E.unregisterListener=function(){var v=this.hls;v.off(i.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),v.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},E.onFpsDropLevelCapping=function(v,d){f.isLevelAllowed(d.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(d.droppedLevel)},E.onMediaAttaching=function(v,d){this.media=d.media instanceof HTMLVideoElement?d.media:null},E.onManifestParsed=function(v,d){var L=this.hls;this.restrictedLevels=[],this.firstLevel=d.firstLevel,L.config.capLevelToPlayerSize&&d.video&&this.startCapping()},E.onBufferCodecs=function(v,d){this.hls.config.capLevelToPlayerSize&&d.video&&this.startCapping()},E.onMediaDetaching=function(){this.stopCapping()},E.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var v=this.hls.levels;if(v.length){var d=this.hls;d.autoLevelCapping=this.getMaxLevel(v.length-1),d.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=d.autoLevelCapping}}},E.getMaxLevel=function(v){var d=this,L=this.hls.levels;if(!L.length)return-1;var k=L.filter(function(m,o){return f.isLevelAllowed(o,d.restrictedLevels)&&o<=v});return this.clientRect=null,f.getMaxLevelByMediaSize(k,this.mediaWidth,this.mediaHeight)},E.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},E.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},E.getDimensions=function(){if(this.clientRect)return this.clientRect;var v=this.media,d={width:0,height:0};if(v){var L=v.getBoundingClientRect();d.width=L.width,d.height=L.height,d.width||d.height||(d.width=L.right-L.left||v.width||0,d.height=L.bottom-L.top||v.height||0)}return this.clientRect=d,d},f.isLevelAllowed=function(v,d){return d===void 0&&(d=[]),d.indexOf(v)===-1},f.getMaxLevelByMediaSize=function(v,d,L){if(!v||!v.length)return-1;for(var k,m,o=v.length-1,c=0;c<v.length;c+=1){var l=v[c];if((l.width>=d||l.height>=L)&&(k=l,!(m=v[c+1])||k.width!==m.width||k.height!==m.height)){o=c;break}}return o},_=f,a=[{key:"contentScaleFactor",get:function(){var v=1;try{v=self.devicePixelRatio}catch{}return v}}],(b=[{key:"mediaWidth",get:function(){return this.getDimensions().width*f.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*f.contentScaleFactor}}])&&n(_.prototype,b),a&&n(_,a),f}();t.default=s},"./src/controller/eme-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),f=r("./src/utils/mediakeys-helper.ts");function _(a,E){for(var v=0;v<E.length;v++){var d=E[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}var b=function(){function a(L){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=L,this._config=L.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var E,v,d=a.prototype;return d.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},d._registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(i.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d._unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(i.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d.getLicenseServerUrl=function(L){switch(L){case f.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+L+'"')},d._attemptKeySystemAccess=function(L,k,m){var o=this,c=function(p,y,h,S){switch(p){case f.KeySystems.WIDEVINE:return function(D,A,R){var u={audioCapabilities:[],videoCapabilities:[]};return D.forEach(function(g){u.audioCapabilities.push({contentType:'audio/mp4; codecs="'+g+'"',robustness:R.audioRobustness||""})}),A.forEach(function(g){u.videoCapabilities.push({contentType:'video/mp4; codecs="'+g+'"',robustness:R.videoRobustness||""})}),[u]}(y,h,S);default:throw new Error("Unknown key-system: "+p)}}(L,k,m,this._drmSystemOptions);s.logger.log("Requesting encrypted media key-system access");var l=this.requestMediaKeySystemAccess(L,c);this.mediaKeysPromise=l.then(function(p){return o._onMediaKeySystemAccessObtained(L,p)}),l.catch(function(p){s.logger.error('Failed to obtain key-system "'+L+'" access:',p)})},d._onMediaKeySystemAccessObtained=function(L,k){var m=this;s.logger.log('Access for key-system "'+L+'" obtained');var o={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:k,mediaKeySystemDomain:L};this._mediaKeysList.push(o);var c=Promise.resolve().then(function(){return k.createMediaKeys()}).then(function(l){return o.mediaKeys=l,s.logger.log('Media-keys created for key-system "'+L+'"'),m._onMediaKeysCreated(),l});return c.catch(function(l){s.logger.error("Failed to create media-keys:",l)}),c},d._onMediaKeysCreated=function(){var L=this;this._mediaKeysList.forEach(function(k){k.mediaKeysSession||(k.mediaKeysSession=k.mediaKeys.createSession(),L._onNewMediaKeySession(k.mediaKeysSession))})},d._onNewMediaKeySession=function(L){var k=this;s.logger.log("New key-system session "+L.sessionId),L.addEventListener("message",function(m){k._onKeySessionMessage(L,m.message)},!1)},d._onKeySessionMessage=function(L,k){s.logger.log("Got EME message event, creating license request"),this._requestLicense(k,function(m){s.logger.log("Received license data (length: "+(m&&m.byteLength)+"), updating key-session"),L.update(m)})},d.onMediaEncrypted=function(L){var k=this;if(s.logger.log('Media is encrypted using "'+L.initDataType+'" init data type'),!this.mediaKeysPromise)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var m=function(o){k._media&&(k._attemptSetMediaKeys(o),k._generateRequestWithPreferredKeySession(L.initDataType,L.initData))};this.mediaKeysPromise.then(m).catch(m)},d._attemptSetMediaKeys=function(L){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var k=this._mediaKeysList[0];if(!k||!k.mediaKeys)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});s.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(k.mediaKeys),this._hasSetMediaKeys=!0}},d._generateRequestWithPreferredKeySession=function(L,k){var m=this,o=this._mediaKeysList[0];if(!o)return s.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(o.mediaKeysSessionInitialized)s.logger.warn("Key-Session already initialized but requested again");else{var c=o.mediaKeysSession;if(!c)return s.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!k)return s.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});s.logger.log('Generating key-session request for "'+L+'" init data type'),o.mediaKeysSessionInitialized=!0,c.generateRequest(L,k).then(function(){s.logger.debug("Key-session generation succeeded")}).catch(function(l){s.logger.error("Error generating key-session request:",l),m.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},d._createLicenseXhr=function(L,k,m){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,o,L,k,m);var c=this._licenseXhrSetup;if(c)try{c.call(this.hls,o,L),c=void 0}catch(l){s.logger.error(l)}try{o.readyState||o.open("POST",L,!0),c&&c.call(this.hls,o,L)}catch(l){throw new Error("issue setting up KeySystem license XHR "+l)}return o},d._onLicenseRequestReadyStageChange=function(L,k,m,o){switch(L.readyState){case 4:if(L.status===200){this._requestLicenseFailureCount=0,s.logger.log("License request succeeded");var c=L.response,l=this._licenseResponseCallback;if(l)try{c=l.call(this.hls,L,k)}catch(y){s.logger.error(y)}o(c)}else{if(s.logger.error("License Request XHR failed ("+k+"). Status: "+L.status+" ("+L.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var p=3-this._requestLicenseFailureCount+1;s.logger.warn("Retrying license request, "+p+" attempts left"),this._requestLicense(m,o)}}},d._generateLicenseRequestChallenge=function(L,k){switch(L.mediaKeySystemDomain){case f.KeySystems.WIDEVINE:return k}throw new Error("unsupported key-system: "+L.mediaKeySystemDomain)},d._requestLicense=function(L,k){s.logger.log("Requesting content license for key-system");var m=this._mediaKeysList[0];if(!m)return s.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var o=this.getLicenseServerUrl(m.mediaKeySystemDomain),c=this._createLicenseXhr(o,L,k);s.logger.log("Sending license request to URL: "+o);var l=this._generateLicenseRequestChallenge(m,L);c.send(l)}catch(p){s.logger.error("Failure requesting DRM license: "+p),this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},d.onMediaAttached=function(L,k){if(this._emeEnabled){var m=k.media;this._media=m,m.addEventListener("encrypted",this._onMediaEncrypted)}},d.onMediaDetached=function(){var L=this._media,k=this._mediaKeysList;L&&(L.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(k.map(function(m){if(m.mediaKeysSession)return m.mediaKeysSession.close().catch(function(){})})).then(function(){return L.setMediaKeys(null)}).catch(function(){}))},d.onManifestParsed=function(L,k){if(this._emeEnabled){var m=k.levels.map(function(c){return c.audioCodec}).filter(function(c){return!!c}),o=k.levels.map(function(c){return c.videoCodec}).filter(function(c){return!!c});this._attemptKeySystemAccess(f.KeySystems.WIDEVINE,m,o)}},E=a,(v=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&_(E.prototype,v),a}();t.default=b},"./src/controller/fps-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/logger.ts"),s=function(){function f(b){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=b,this.registerListeners()}var _=f.prototype;return _.setStreamController=function(b){this.streamController=b},_.registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},_.unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching)},_.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},_.onMediaAttaching=function(b,a){var E=this.hls.config;if(E.capLevelOnFPSDrop){var v=a.media instanceof self.HTMLVideoElement?a.media:null;this.media=v,v&&typeof v.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),E.fpsDroppedMonitoringPeriod)}},_.checkFPS=function(b,a,E){var v=performance.now();if(a){if(this.lastTime){var d=v-this.lastTime,L=E-this.lastDroppedFrames,k=a-this.lastDecodedFrames,m=1e3*L/d,o=this.hls;if(o.trigger(i.Events.FPS_DROP,{currentDropped:L,currentDecoded:k,totalDroppedFrames:E}),m>0&&L>o.config.fpsDroppedMonitoringThreshold*k){var c=o.currentLevel;n.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(o.autoLevelCapping===-1||o.autoLevelCapping>=c)&&(c-=1,o.trigger(i.Events.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:o.currentLevel}),o.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=v,this.lastDroppedFrames=E,this.lastDecodedFrames=a}},_.checkFPSInterval=function(){var b=this.media;if(b)if(this.isVideoPlaybackQualityAvailable){var a=b.getVideoPlaybackQuality();this.checkFPS(b,a.totalVideoFrames,a.droppedVideoFrames)}else this.checkFPS(b,b.webkitDecodedFrameCount,b.webkitDroppedFrameCount)},f}();t.default=s},"./src/controller/fragment-finders.ts":function(e,t,r){r.r(t),r.d(t,"findFragmentByPDT",function(){return s}),r.d(t,"findFragmentByPTS",function(){return f}),r.d(t,"fragmentWithinToleranceTest",function(){return _}),r.d(t,"pdtWithinToleranceTest",function(){return b}),r.d(t,"findFragWithCC",function(){return a});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/binary-search.ts");function s(E,v,d){if(v===null||!Array.isArray(E)||!E.length||!Object(i.isFiniteNumber)(v)||v<(E[0].programDateTime||0)||v>=(E[E.length-1].endProgramDateTime||0))return null;d=d||0;for(var L=0;L<E.length;++L){var k=E[L];if(b(v,d,k))return k}return null}function f(E,v,d,L){d===void 0&&(d=0),L===void 0&&(L=0);var k=null;if(E?k=v[E.sn-v[0].sn+1]||null:d===0&&v[0].start===0&&(k=v[0]),k&&_(d,L,k)===0)return k;var m=n.default.search(v,_.bind(null,d,L));return m||k}function _(E,v,d){E===void 0&&(E=0),v===void 0&&(v=0);var L=Math.min(v,d.duration+(d.deltaPTS?d.deltaPTS:0));return d.start+d.duration-L<=E?1:d.start-L>E&&d.start?-1:0}function b(E,v,d){var L=1e3*Math.min(v,d.duration+(d.deltaPTS?d.deltaPTS:0));return(d.endProgramDateTime||0)-L>E}function a(E,v){return n.default.search(E,function(d){return d.cc<v?1:d.cc>v?-1:0})}},"./src/controller/fragment-tracker.ts":function(e,t,r){r.r(t),r.d(t,"FragmentState",function(){return i}),r.d(t,"FragmentTracker",function(){return _});var i,n,s=r("./src/events.ts"),f=r("./src/types/loader.ts");(n=i||(i={})).NOT_LOADED="NOT_LOADED",n.BACKTRACKED="BACKTRACKED",n.APPENDING="APPENDING",n.PARTIAL="PARTIAL",n.OK="OK";var _=function(){function E(d){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=d,this._registerListeners()}var v=E.prototype;return v._registerListeners=function(){var d=this.hls;d.on(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),d.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),d.on(s.Events.FRAG_LOADED,this.onFragLoaded,this)},v._unregisterListeners=function(){var d=this.hls;d.off(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),d.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),d.off(s.Events.FRAG_LOADED,this.onFragLoaded,this)},v.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},v.getAppendedFrag=function(d,L){if(L===f.PlaylistLevelType.MAIN){var k=this.activeFragment,m=this.activeParts;if(!k)return null;if(m)for(var o=m.length;o--;){var c=m[o],l=c?c.end:k.appendedPTS;if(c.start<=d&&l!==void 0&&d<=l)return o>9&&(this.activeParts=m.slice(o-9)),c}else if(k.start<=d&&k.appendedPTS!==void 0&&d<=k.appendedPTS)return k}return this.getBufferedFrag(d,L)},v.getBufferedFrag=function(d,L){for(var k=this.fragments,m=Object.keys(k),o=m.length;o--;){var c=k[m[o]];if((c==null?void 0:c.body.type)===L&&c.buffered){var l=c.body;if(l.start<=d&&d<=l.end)return l}}return null},v.detectEvictedFragments=function(d,L,k){var m=this;Object.keys(this.fragments).forEach(function(o){var c=m.fragments[o];if(c)if(c.buffered){var l=c.range[d];l&&l.time.some(function(p){var y=!m.isTimeBuffered(p.startPTS,p.endPTS,L);return y&&m.removeFragment(c.body),y})}else c.body.type===k&&m.removeFragment(c.body)})},v.detectPartialFragments=function(d){var L=this,k=this.timeRanges,m=d.frag,o=d.part;if(k&&m.sn!=="initSegment"){var c=a(m),l=this.fragments[c];l&&(Object.keys(k).forEach(function(p){var y=m.elementaryStreams[p];if(y){var h=k[p],S=o!==null||y.partial===!0;l.range[p]=L.getBufferedTimes(m,o,S,h)}}),l.backtrack=l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},v.fragBuffered=function(d){var L=a(d),k=this.fragments[L];k&&(k.backtrack=k.loaded=null,k.buffered=!0)},v.getBufferedTimes=function(d,L,k,m){for(var o={time:[],partial:k},c=L?L.start:d.start,l=L?L.end:d.end,p=d.minEndPTS||l,y=d.maxStartPTS||c,h=0;h<m.length;h++){var S=m.start(h)-this.bufferPadding,D=m.end(h)+this.bufferPadding;if(y>=S&&p<=D){o.time.push({startPTS:Math.max(c,m.start(h)),endPTS:Math.min(l,m.end(h))});break}if(c<D&&l>S)o.partial=!0,o.time.push({startPTS:Math.max(c,m.start(h)),endPTS:Math.min(l,m.end(h))});else if(l<=S)break}return o},v.getPartialFragment=function(d){var L,k,m,o=null,c=0,l=this.bufferPadding,p=this.fragments;return Object.keys(p).forEach(function(y){var h=p[y];h&&b(h)&&(k=h.body.start-l,m=h.body.end+l,d>=k&&d<=m&&(L=Math.min(d-k,m-d),c<=L&&(o=h.body,c=L)))}),o},v.getState=function(d){var L=a(d),k=this.fragments[L];return k?k.buffered?b(k)?i.PARTIAL:i.OK:k.backtrack?i.BACKTRACKED:i.APPENDING:i.NOT_LOADED},v.backtrack=function(d,L){var k=a(d),m=this.fragments[k];if(!m||m.backtrack)return null;var o=m.backtrack=L||m.loaded;return m.loaded=null,o},v.getBacktrackData=function(d){var L=a(d),k=this.fragments[L];if(k){var m,o=k.backtrack;if(o!=null&&(m=o.payload)!==null&&m!==void 0&&m.byteLength)return o;this.removeFragment(d)}return null},v.isTimeBuffered=function(d,L,k){for(var m,o,c=0;c<k.length;c++){if(m=k.start(c)-this.bufferPadding,o=k.end(c)+this.bufferPadding,d>=m&&L<=o)return!0;if(L<=m)return!1}return!1},v.onFragLoaded=function(d,L){var k=L.frag,m=L.part;if(k.sn!=="initSegment"&&!k.bitrateTest&&!m){var o=a(k);this.fragments[o]={body:k,loaded:L,backtrack:null,buffered:!1,range:Object.create(null)}}},v.onBufferAppended=function(d,L){var k=this,m=L.frag,o=L.part,c=L.timeRanges;if(m.type===f.PlaylistLevelType.MAIN)if(this.activeFragment=m,o){var l=this.activeParts;l||(this.activeParts=l=[]),l.push(o)}else this.activeParts=null;this.timeRanges=c,Object.keys(c).forEach(function(p){var y=c[p];if(k.detectEvictedFragments(p,y),!o)for(var h=0;h<y.length;h++)m.appendedPTS=Math.max(y.end(h),m.appendedPTS||0)})},v.onFragBuffered=function(d,L){this.detectPartialFragments(L)},v.hasFragment=function(d){var L=a(d);return!!this.fragments[L]},v.removeFragmentsInRange=function(d,L,k){var m=this;Object.keys(this.fragments).forEach(function(o){var c=m.fragments[o];if(c&&c.buffered){var l=c.body;l.type===k&&l.start<L&&l.end>d&&m.removeFragment(l)}})},v.removeFragment=function(d){var L=a(d);d.stats.loaded=0,d.clearElementaryStreamInfo(),delete this.fragments[L]},v.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},E}();function b(E){var v,d;return E.buffered&&(((v=E.range.video)===null||v===void 0?void 0:v.partial)||((d=E.range.audio)===null||d===void 0?void 0:d.partial))}function a(E){return E.type+"_"+E.level+"_"+E.urlId+"_"+E.sn}},"./src/controller/gap-controller.ts":function(e,t,r){r.r(t),r.d(t,"STALL_MINIMUM_DURATION_MS",function(){return _}),r.d(t,"MAX_START_GAP_JUMP",function(){return b}),r.d(t,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return a}),r.d(t,"SKIP_BUFFER_RANGE_START",function(){return E}),r.d(t,"default",function(){return v});var i=r("./src/utils/buffer-helper.ts"),n=r("./src/errors.ts"),s=r("./src/events.ts"),f=r("./src/utils/logger.ts"),_=250,b=2,a=.1,E=.05,v=function(){function d(k,m,o,c){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=k,this.media=m,this.fragmentTracker=o,this.hls=c}var L=d.prototype;return L.destroy=function(){this.hls=this.fragmentTracker=this.media=null},L.poll=function(k){var m=this.config,o=this.media,c=this.stalled,l=o.currentTime,p=o.seeking,y=this.seeking&&!p,h=!this.seeking&&p;if(this.seeking=p,l===k){if((h||y)&&(this.stalled=null),!o.paused&&!o.ended&&o.playbackRate!==0&&i.BufferHelper.getBuffered(o).length){var S=i.BufferHelper.bufferInfo(o,l,0),D=S.len>0,A=S.nextStart||0;if(D||A){if(p){var R=S.len>b,u=!A||A-l>b&&!this.fragmentTracker.getPartialFragment(l);if(R||u)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var g,T=Math.max(A,S.start||0)-l,C=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,w=!(C==null||(g=C.details)===null||g===void 0)&&g.live?2*C.details.targetduration:b;if(T>0&&T<=w)return void this._trySkipBufferHole(null)}var I=self.performance.now();if(c!==null){var O=I-c;!p&&O>=_&&this._reportStall(S.len);var x=i.BufferHelper.bufferInfo(o,l,m.maxBufferHole);this._tryFixBufferStall(x,O)}else this.stalled=I}}}else if(this.moved=!0,c!==null){if(this.stallReported){var P=self.performance.now()-c;f.logger.warn("playback not stuck anymore @"+l+", after "+Math.round(P)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},L._tryFixBufferStall=function(k,m){var o=this.config,c=this.fragmentTracker,l=this.media.currentTime,p=c.getPartialFragment(l);p&&this._trySkipBufferHole(p)||k.len>o.maxBufferHole&&m>1e3*o.highBufferWatchdogPeriod&&(f.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},L._reportStall=function(k){var m=this.hls,o=this.media;this.stallReported||(this.stallReported=!0,f.logger.warn("Playback stalling at @"+o.currentTime+" due to low buffer (buffer="+k+")"),m.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:k}))},L._trySkipBufferHole=function(k){for(var m=this.config,o=this.hls,c=this.media,l=c.currentTime,p=0,y=i.BufferHelper.getBuffered(c),h=0;h<y.length;h++){var S=y.start(h);if(l+m.maxBufferHole>=p&&l<S){var D=Math.max(S+E,c.currentTime+a);return f.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+D),this.moved=!0,this.stalled=null,c.currentTime=D,k&&o.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+D,frag:k}),D}p=y.end(h)}return 0},L._tryNudgeBuffer=function(){var k=this.config,m=this.hls,o=this.media,c=o.currentTime,l=(this.nudgeRetry||0)+1;if(this.nudgeRetry=l,l<k.nudgeMaxRetry){var p=c+l*k.nudgeOffset;f.logger.warn("Nudging 'currentTime' from "+c+" to "+p),o.currentTime=p,m.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else f.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+k.nudgeMaxRetry+" nudges"),m.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},d}()},"./src/controller/id3-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/texttrack-utils.ts"),s=r("./src/demux/id3.ts"),f=function(){function _(a){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=a,this._registerListeners()}var b=_.prototype;return b.destroy=function(){this._unregisterListeners()},b._registerListeners=function(){var a=this.hls;a.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(i.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),a.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b._unregisterListeners=function(){var a=this.hls;a.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(i.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),a.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b.onMediaAttached=function(a,E){this.media=E.media},b.onMediaDetaching=function(){this.id3Track&&(Object(n.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},b.getID3Track=function(a){if(this.media){for(var E=0;E<a.length;E++){var v=a[E];if(v.kind==="metadata"&&v.label==="id3")return Object(n.sendAddTrackEvent)(v,this.media),v}return this.media.addTextTrack("metadata","id3")}},b.onFragParsingMetadata=function(a,E){if(this.media){var v=E.frag,d=E.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var L=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,k=0;k<d.length;k++){var m=s.getID3Frames(d[k].data);if(m){var o=d[k].pts,c=k<d.length-1?d[k+1].pts:v.end;c-o<=0&&(c=o+.25);for(var l=0;l<m.length;l++){var p=m[l];if(!s.isTimeStampFrame(p)){var y=new L(o,c,"");y.value=p,this.id3Track.addCue(y)}}}}}},b.onBufferFlushing=function(a,E){var v=E.startOffset,d=E.endOffset,L=E.type;if(!L||L==="audio"){var k=this.id3Track;k&&Object(n.removeCuesInRange)(k,v,d)}},_}();t.default=f},"./src/controller/latency-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return _});var i=r("./src/errors.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts");function f(b,a){for(var E=0;E<a.length;E++){var v=a[E];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(b,v.key,v)}}var _=function(){function b(d){var L=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return L.timeupdate()},this.hls=d,this.config=d.config,this.registerListeners()}var a,E,v=b.prototype;return v.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},v.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(n.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(n.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(n.Events.ERROR,this.onError)},v.onMediaAttached=function(d,L){this.media=L.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},v.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},v.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},v.onLevelUpdated=function(d,L){var k=L.details;this.levelDetails=k,k.advanced&&this.timeupdate(),!k.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},v.onError=function(d,L){L.details===i.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,s.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},v.timeupdate=function(){var d=this.media,L=this.levelDetails;if(d&&L){this.currentTime=d.currentTime;var k=this.computeLatency();if(k!==null){this._latency=k;var m=this.config,o=m.lowLatencyMode,c=m.maxLiveSyncPlaybackRate;if(o&&c!==1){var l=this.targetLatency;if(l!==null){var p=k-l,y=p<Math.min(this.maxLatency,l+L.targetduration);if(L.live&&y&&p>.05&&this.forwardBufferLength>1){var h=Math.min(2,Math.max(1,c)),S=Math.round(2/(1+Math.exp(-.75*p-this.edgeStalled))*20)/20;d.playbackRate=Math.min(h,Math.max(1,S))}else d.playbackRate!==1&&d.playbackRate!==0&&(d.playbackRate=1)}}}}},v.estimateLiveEdge=function(){var d=this.levelDetails;return d===null?null:d.edge+d.age},v.computeLatency=function(){var d=this.estimateLiveEdge();return d===null?null:d-this.currentTime},a=b,(E=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var d=this.config,L=this.levelDetails;return d.liveMaxLatencyDuration!==void 0?d.liveMaxLatencyDuration:L?d.liveMaxLatencyDurationCount*L.targetduration:0}},{key:"targetLatency",get:function(){var d=this.levelDetails;if(d===null)return null;var L=d.holdBack,k=d.partHoldBack,m=d.targetduration,o=this.config,c=o.liveSyncDuration,l=o.liveSyncDurationCount,p=o.lowLatencyMode,y=this.hls.userConfig,h=p&&k||L;(y.liveSyncDuration||y.liveSyncDurationCount||h===0)&&(h=c!==void 0?c:l*m);var S=m;return h+Math.min(1*this.stallCount,S)}},{key:"liveSyncPosition",get:function(){var d=this.estimateLiveEdge(),L=this.targetLatency,k=this.levelDetails;if(d===null||L===null||k===null)return null;var m=k.edge,o=d-L-this.edgeStalled,c=m-k.totalduration,l=m-(this.config.lowLatencyMode&&k.partTarget||k.targetduration);return Math.min(Math.max(c,o),l)}},{key:"drift",get:function(){var d=this.levelDetails;return d===null?1:d.drift}},{key:"edgeStalled",get:function(){var d=this.levelDetails;if(d===null)return 0;var L=3*(this.config.lowLatencyMode&&d.partTarget||d.targetduration);return Math.max(d.age-L,0)}},{key:"forwardBufferLength",get:function(){var d=this.media,L=this.levelDetails;if(!d||!L)return 0;var k=d.buffered.length;return k?d.buffered.end(k-1):L.edge-this.currentTime}}])&&f(a.prototype,E),b}()},"./src/controller/level-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return k});var i=r("./src/types/level.ts"),n=r("./src/events.ts"),s=r("./src/errors.ts"),f=r("./src/utils/codecs.ts"),_=r("./src/controller/level-helper.ts"),b=r("./src/controller/base-playlist-controller.ts"),a=r("./src/types/loader.ts");function E(){return(E=Object.assign||function(m){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(m[l]=c[l])}return m}).apply(this,arguments)}function v(m,o){for(var c=0;c<o.length;c++){var l=o[c];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(m,l.key,l)}}function d(m,o){return(d=Object.setPrototypeOf||function(c,l){return c.__proto__=l,c})(m,o)}var L=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),k=function(m){var o,c;function l(S){var D;return(D=m.call(this,S,"[level-controller]")||this)._levels=[],D._firstLevel=-1,D._startLevel=void 0,D.currentLevelIndex=-1,D.manualLevelIndex=-1,D.onParsedComplete=void 0,D._registerListeners(),D}c=m,(o=l).prototype=Object.create(c.prototype),o.prototype.constructor=o,d(o,c);var p,y,h=l.prototype;return h._registerListeners=function(){var S=this.hls;S.on(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),S.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.on(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.on(n.Events.FRAG_LOADED,this.onFragLoaded,this),S.on(n.Events.ERROR,this.onError,this)},h._unregisterListeners=function(){var S=this.hls;S.off(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),S.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.off(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.off(n.Events.FRAG_LOADED,this.onFragLoaded,this),S.off(n.Events.ERROR,this.onError,this)},h.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,m.prototype.destroy.call(this)},h.startLoad=function(){this._levels.forEach(function(S){S.loadError=0}),m.prototype.startLoad.call(this)},h.onManifestLoaded=function(S,D){var A,R,u=[],g=[],T=[],C={},w=!1,I=!1,O=!1;if(D.levels.forEach(function(N){var U=N.attrs;w=w||!(!N.width||!N.height),I=I||!!N.videoCodec,O=O||!!N.audioCodec,L&&N.audioCodec&&N.audioCodec.indexOf("mp4a.40.34")!==-1&&(N.audioCodec=void 0);var G=N.bitrate+"-"+N.attrs.RESOLUTION+"-"+N.attrs.CODECS;(R=C[G])?R.url.push(N.url):(R=new i.Level(N),C[G]=R,u.push(R)),U&&(U.AUDIO&&Object(_.addGroupId)(R,"audio",U.AUDIO),U.SUBTITLES&&Object(_.addGroupId)(R,"text",U.SUBTITLES))}),(w||I)&&O&&(u=u.filter(function(N){var U=N.videoCodec,G=N.width,V=N.height;return!!U||!(!G||!V)})),u=u.filter(function(N){var U=N.audioCodec,G=N.videoCodec;return(!U||Object(f.isCodecSupportedInMp4)(U,"audio"))&&(!G||Object(f.isCodecSupportedInMp4)(G,"video"))}),D.audioTracks&&(g=D.audioTracks.filter(function(N){return!N.audioCodec||Object(f.isCodecSupportedInMp4)(N.audioCodec,"audio")}),Object(_.assignTrackIdsByGroup)(g)),D.subtitles&&(T=D.subtitles,Object(_.assignTrackIdsByGroup)(T)),u.length>0){A=u[0].bitrate,u.sort(function(N,U){return N.bitrate-U.bitrate}),this._levels=u;for(var x=0;x<u.length;x++)if(u[x].bitrate===A){this._firstLevel=x,this.log("manifest loaded, "+u.length+" level(s) found, first bitrate: "+A);break}var P=O&&!I,F={levels:u,audioTracks:g,subtitleTracks:T,firstLevel:this._firstLevel,stats:D.stats,audio:O,video:I,altAudio:!P&&g.some(function(N){return!!N.url})};this.hls.trigger(n.Events.MANIFEST_PARSED,F),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:D.url,reason:"no level with compatible codecs found in manifest"})},h.onError=function(S,D){if(m.prototype.onError.call(this,S,D),!D.fatal){var A=D.context,R=this._levels[this.currentLevelIndex];if(A&&(A.type===a.PlaylistContextType.AUDIO_TRACK&&R.audioGroupIds&&A.groupId===R.audioGroupIds[R.urlId]||A.type===a.PlaylistContextType.SUBTITLE_TRACK&&R.textGroupIds&&A.groupId===R.textGroupIds[R.urlId]))this.redundantFailover(this.currentLevelIndex);else{var u,g=!1,T=!0;switch(D.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(D.frag){var C=this._levels[D.frag.level];C?(C.fragmentError++,C.fragmentError>this.hls.config.fragLoadingMaxRetry&&(u=D.frag.level)):u=D.frag.level}break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:A&&(A.deliveryDirectives&&(T=!1),u=A.level),g=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:u=D.level,g=!0}u!==void 0&&this.recoverLevel(D,u,g,T)}}},h.recoverLevel=function(S,D,A,R){var u=S.details,g=this._levels[D];if(g.loadError++,A){if(!this.retryLoadingOrFail(S))return void(this.currentLevelIndex=-1);S.levelRetry=!0}if(R){var T=g.url.length;if(T>1&&g.loadError<T)S.levelRetry=!0,this.redundantFailover(D);else if(this.manualLevelIndex===-1){var C=D===0?this._levels.length-1:D-1;this.currentLevelIndex!==C&&this._levels[C].loadError===0&&(this.warn(u+": switch to "+C),S.levelRetry=!0,this.hls.nextAutoLevel=C)}}},h.redundantFailover=function(S){var D=this._levels[S],A=D.url.length;if(A>1){var R=(D.urlId+1)%A;this.warn("Switching to redundant URL-id "+R),this._levels.forEach(function(u){u.urlId=R}),this.level=S}},h.onFragLoaded=function(S,D){var A=D.frag;if(A!==void 0&&A.type===a.PlaylistLevelType.MAIN){var R=this._levels[A.level];R!==void 0&&(R.fragmentError=0,R.loadError=0)}},h.onLevelLoaded=function(S,D){var A,R,u=D.level,g=D.details,T=this._levels[u];if(!T)return this.warn("Invalid level index "+u),void((R=D.deliveryDirectives)!==null&&R!==void 0&&R.skip&&(g.deltaUpdateFailed=!0));u===this.currentLevelIndex?(T.fragmentError===0&&(T.loadError=0,this.retryCount=0),this.playlistLoaded(u,D,T.details)):(A=D.deliveryDirectives)!==null&&A!==void 0&&A.skip&&(g.deltaUpdateFailed=!0)},h.onAudioTrackSwitched=function(S,D){var A=this.hls.levels[this.currentLevelIndex];if(A&&A.audioGroupIds){for(var R=-1,u=this.hls.audioTracks[D.id].groupId,g=0;g<A.audioGroupIds.length;g++)if(A.audioGroupIds[g]===u){R=g;break}R!==A.urlId&&(A.urlId=R,this.startLoad())}},h.loadPlaylist=function(S){var D=this.currentLevelIndex,A=this._levels[D];if(this.canLoad&&A&&A.url.length>0){var R=A.urlId,u=A.url[R];if(S)try{u=S.addDirectives(u)}catch(g){this.warn("Could not construct new URL with HLS Delivery Directives: "+g)}this.log("Attempt loading level index "+D+(S?" at sn "+S.msn+" part "+S.part:"")+" with URL-id "+R+" "+u),this.clearTimer(),this.hls.trigger(n.Events.LEVEL_LOADING,{url:u,level:D,id:R,deliveryDirectives:S||null})}},h.removeLevel=function(S,D){var A=function(u,g){return g!==D},R=this._levels.filter(function(u,g){return g!==S||u.url.length>1&&D!==void 0&&(u.url=u.url.filter(A),u.audioGroupIds&&(u.audioGroupIds=u.audioGroupIds.filter(A)),u.textGroupIds&&(u.textGroupIds=u.textGroupIds.filter(A)),u.urlId=0,!0)}).map(function(u,g){var T=u.details;return T!=null&&T.fragments&&T.fragments.forEach(function(C){C.level=g}),u});this._levels=R,this.hls.trigger(n.Events.LEVELS_UPDATED,{levels:R})},p=l,(y=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(S){var D,A=this._levels;if(A.length!==0&&(this.currentLevelIndex!==S||(D=A[S])===null||D===void 0||!D.details)){if(S<0||S>=A.length){var R=S<0;if(this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:S,fatal:R,reason:"invalid level idx"}),R)return;S=Math.min(S,A.length-1)}this.clearTimer();var u=this.currentLevelIndex,g=A[u],T=A[S];this.log("switching to level "+S+" from "+u),this.currentLevelIndex=S;var C=E({},T,{level:S,maxBitrate:T.maxBitrate,uri:T.uri,urlId:T.urlId});delete C._urlId,this.hls.trigger(n.Events.LEVEL_SWITCHING,C);var w=T.details;if(!w||w.live){var I=this.switchParams(T.uri,g==null?void 0:g.details);this.loadPlaylist(I)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(S){this.manualLevelIndex=S,this._startLevel===void 0&&(this._startLevel=S),S!==-1&&(this.level=S)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(S){this._firstLevel=S}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var S=this.hls.config.startLevel;return S!==void 0?S:this._firstLevel}return this._startLevel},set:function(S){this._startLevel=S}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(S){this.level=S,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=S)}}])&&v(p.prototype,y),l}(b.default)},"./src/controller/level-helper.ts":function(e,t,r){r.r(t),r.d(t,"addGroupId",function(){return s}),r.d(t,"assignTrackIdsByGroup",function(){return f}),r.d(t,"updatePTS",function(){return _}),r.d(t,"updateFragPTSDTS",function(){return a}),r.d(t,"mergeDetails",function(){return E}),r.d(t,"mapPartIntersection",function(){return v}),r.d(t,"mapFragmentIntersection",function(){return d}),r.d(t,"adjustSliding",function(){return L}),r.d(t,"addSliding",function(){return k}),r.d(t,"computeReloadInterval",function(){return m}),r.d(t,"getFragmentWithSN",function(){return o}),r.d(t,"getPartWith",function(){return c});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/logger.ts");function s(l,p,y){switch(p){case"audio":l.audioGroupIds||(l.audioGroupIds=[]),l.audioGroupIds.push(y);break;case"text":l.textGroupIds||(l.textGroupIds=[]),l.textGroupIds.push(y)}}function f(l){var p={};l.forEach(function(y){var h=y.groupId||"";y.id=p[h]=p[h]||0,p[h]++})}function _(l,p,y){b(l[p],l[y])}function b(l,p){var y=p.startPTS;if(Object(i.isFiniteNumber)(y)){var h,S=0;p.sn>l.sn?(S=y-l.start,h=l):(S=l.start-y,h=p),h.duration!==S&&(h.duration=S)}else p.sn>l.sn?l.cc===p.cc&&l.minEndPTS?p.start=l.start+(l.minEndPTS-l.start):p.start=l.start+l.duration:p.start=Math.max(l.start-p.duration,0)}function a(l,p,y,h,S,D){h-y<=0&&(n.logger.warn("Fragment should have a positive duration",p),h=y+p.duration,D=S+p.duration);var A=y,R=h,u=p.startPTS,g=p.endPTS;if(Object(i.isFiniteNumber)(u)){var T=Math.abs(u-y);Object(i.isFiniteNumber)(p.deltaPTS)?p.deltaPTS=Math.max(T,p.deltaPTS):p.deltaPTS=T,A=Math.max(y,u),y=Math.min(y,u),S=Math.min(S,p.startDTS),R=Math.min(h,g),h=Math.max(h,g),D=Math.max(D,p.endDTS)}p.duration=h-y;var C=y-p.start;p.appendedPTS=h,p.start=p.startPTS=y,p.maxStartPTS=A,p.startDTS=S,p.endPTS=h,p.minEndPTS=R,p.endDTS=D;var w,I=p.sn;if(!l||I<l.startSN||I>l.endSN)return 0;var O=I-l.startSN,x=l.fragments;for(x[O]=p,w=O;w>0;w--)b(x[w],x[w-1]);for(w=O;w<x.length-1;w++)b(x[w],x[w+1]);return l.fragmentHint&&b(x[x.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,C}function E(l,p){for(var y=null,h=l.fragments,S=h.length-1;S>=0;S--){var D=h[S].initSegment;if(D){y=D;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;var A,R=0;if(d(l,p,function(I,O){var x;I.relurl&&(R=I.cc-O.cc),Object(i.isFiniteNumber)(I.startPTS)&&Object(i.isFiniteNumber)(I.endPTS)&&(O.start=O.startPTS=I.startPTS,O.startDTS=I.startDTS,O.appendedPTS=I.appendedPTS,O.maxStartPTS=I.maxStartPTS,O.endPTS=I.endPTS,O.endDTS=I.endDTS,O.minEndPTS=I.minEndPTS,O.duration=I.endPTS-I.startPTS,O.duration&&(A=O),p.PTSKnown=p.alignedSliding=!0),O.elementaryStreams=I.elementaryStreams,O.loader=I.loader,O.stats=I.stats,O.urlId=I.urlId,I.initSegment?(O.initSegment=I.initSegment,y=I.initSegment):O.initSegment&&O.initSegment.relurl!=((x=y)===null||x===void 0?void 0:x.relurl)||(O.initSegment=y)}),p.skippedSegments&&(p.deltaUpdateFailed=p.fragments.some(function(I){return!I}),p.deltaUpdateFailed)){n.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var u=p.skippedSegments;u--;)p.fragments.shift();p.startSN=p.fragments[0].sn,p.startCC=p.fragments[0].cc}var g=p.fragments;if(R){n.logger.warn("discontinuity sliding from playlist, take drift into account");for(var T=0;T<g.length;T++)g[T].cc+=R}p.skippedSegments&&(p.startCC=p.fragments[0].cc),v(l.partList,p.partList,function(I,O){O.elementaryStreams=I.elementaryStreams,O.stats=I.stats}),A?a(p,A,A.startPTS,A.endPTS,A.startDTS,A.endDTS):L(l,p),g.length&&(p.totalduration=p.edge-g[0].start),p.driftStartTime=l.driftStartTime,p.driftStart=l.driftStart;var C=p.advancedDateTime;if(p.advanced&&C){var w=p.edge;p.driftStart||(p.driftStartTime=C,p.driftStart=w),p.driftEndTime=C,p.driftEnd=w}else p.driftEndTime=l.driftEndTime,p.driftEnd=l.driftEnd,p.advancedDateTime=l.advancedDateTime}function v(l,p,y){if(l&&p)for(var h=0,S=0,D=l.length;S<=D;S++){var A=l[S],R=p[S+h];A&&R&&A.index===R.index&&A.fragment.sn===R.fragment.sn?y(A,R):h--}}function d(l,p,y){for(var h=p.skippedSegments,S=Math.max(l.startSN,p.startSN)-p.startSN,D=(l.fragmentHint?1:0)+(h?p.endSN:Math.min(l.endSN,p.endSN))-p.startSN,A=p.startSN-l.startSN,R=p.fragmentHint?p.fragments.concat(p.fragmentHint):p.fragments,u=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,g=S;g<=D;g++){var T=u[A+g],C=R[g];h&&!C&&g<h&&(C=p.fragments[g]=T),T&&C&&y(T,C)}}function L(l,p){var y=p.startSN+p.skippedSegments-l.startSN,h=l.fragments;y<0||y>=h.length||k(p,h[y].start)}function k(l,p){if(p){for(var y=l.fragments,h=l.skippedSegments;h<y.length;h++)y[h].start+=p;l.fragmentHint&&(l.fragmentHint.start+=p)}}function m(l,p){var y,h=1e3*l.levelTargetDuration,S=h/2,D=l.age,A=D>0&&D<3*h,R=p.loading.end-p.loading.start,u=l.availabilityDelay;if(l.updated===!1)if(A){var g=333*l.misses;y=Math.max(Math.min(S,2*R),g),l.availabilityDelay=(l.availabilityDelay||0)+y}else y=S;else A?(u=Math.min(u||h/2,D),l.availabilityDelay=u,y=u+h-D):y=h-R;return Math.round(y)}function o(l,p,y){if(!l||!l.details)return null;var h=l.details,S=h.fragments[p-h.startSN];return S||((S=h.fragmentHint)&&S.sn===p?S:p<h.startSN&&y&&y.sn===p?y:null)}function c(l,p,y){if(!l||!l.details)return null;var h=l.details.partList;if(h)for(var S=h.length;S--;){var D=h[S];if(D.index===y&&D.fragment.sn===p)return D}return null}},"./src/controller/stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l});var i=r("./src/polyfills/number.ts"),n=r("./src/controller/base-stream-controller.ts"),s=r("./src/is-supported.ts"),f=r("./src/events.ts"),_=r("./src/utils/buffer-helper.ts"),b=r("./src/controller/fragment-tracker.ts"),a=r("./src/types/loader.ts"),E=r("./src/loader/fragment.ts"),v=r("./src/demux/transmuxer-interface.ts"),d=r("./src/types/transmuxer.ts"),L=r("./src/controller/gap-controller.ts"),k=r("./src/errors.ts"),m=r("./src/utils/logger.ts");function o(p,y){for(var h=0;h<y.length;h++){var S=y[h];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}function c(p,y){return(c=Object.setPrototypeOf||function(h,S){return h.__proto__=S,h})(p,y)}var l=function(p){var y,h;function S(u,g){var T;return(T=p.call(this,u,g,"[stream-controller]")||this).audioCodecSwap=!1,T.gapController=null,T.level=-1,T._forceStartLoad=!1,T.altAudio=!1,T.audioOnly=!1,T.fragPlaying=null,T.onvplaying=null,T.onvseeked=null,T.fragLastKbps=0,T.stalled=!1,T.couldBacktrack=!1,T.audioCodecSwitch=!1,T.videoBuffer=null,T._registerListeners(),T}h=p,(y=S).prototype=Object.create(h.prototype),y.prototype.constructor=y,c(y,h);var D,A,R=S.prototype;return R._registerListeners=function(){var u=this.hls;u.on(f.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(f.Events.LEVEL_LOADING,this.onLevelLoading,this),u.on(f.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.on(f.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),u.on(f.Events.ERROR,this.onError,this),u.on(f.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),u.on(f.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),u.on(f.Events.BUFFER_CREATED,this.onBufferCreated,this),u.on(f.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),u.on(f.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),u.on(f.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R._unregisterListeners=function(){var u=this.hls;u.off(f.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(f.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.off(f.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),u.off(f.Events.ERROR,this.onError,this),u.off(f.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),u.off(f.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),u.off(f.Events.BUFFER_CREATED,this.onBufferCreated,this),u.off(f.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),u.off(f.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),u.off(f.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},R.startLoad=function(u){if(this.levels){var g=this.lastCurrentTime,T=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var C=T.startLevel;C===-1&&(T.config.testBandwidth?(C=0,this.bitrateTest=!0):C=T.nextAutoLevel),this.level=T.nextLoadLevel=C,this.loadedmetadata=!1}g>0&&u===-1&&(this.log("Override startPosition with lastCurrentTime @"+g.toFixed(3)),u=g),this.state=n.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=u,this.tick()}else this._forceStartLoad=!0,this.state=n.State.STOPPED},R.stopLoad=function(){this._forceStartLoad=!1,p.prototype.stopLoad.call(this)},R.doTick=function(){switch(this.state){case n.State.IDLE:this.doTickIdle();break;case n.State.WAITING_LEVEL:var u,g=this.levels,T=this.level,C=g==null||(u=g[T])===null||u===void 0?void 0:u.details;if(C&&(!C.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(C))break;this.state=n.State.IDLE;break}break;case n.State.FRAG_LOADING_WAITING_RETRY:var w,I=self.performance.now(),O=this.retryDate;(!O||I>=O||(w=this.media)!==null&&w!==void 0&&w.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=n.State.IDLE)}this.onTickEnd()},R.onTickEnd=function(){p.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},R.doTickIdle=function(){var u,g,T=this.hls,C=this.levelLastLoaded,w=this.levels,I=this.media,O=T.config,x=T.nextLoadLevel;if(C!==null&&(I||!this.startFragRequested&&O.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&w&&w[x]){var P=w[x];this.level=T.nextLoadLevel=x;var F=P.details;if(!F||this.state===n.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==x)this.state=n.State.WAITING_LEVEL;else{var N=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:I,a.PlaylistLevelType.MAIN);if(N!==null&&!(N.len>=this.getMaxBufferLength(P.maxBitrate))){if(this._streamEnded(N,F)){var U={};return this.altAudio&&(U.type="video"),this.hls.trigger(f.Events.BUFFER_EOS,U),void(this.state=n.State.ENDED)}var G=N.end,V=this.getNextFragment(G,F);if(this.couldBacktrack&&!this.fragPrevious&&V&&V.sn!=="initSegment"){var X=V.sn-F.startSN;X>1&&(V=F.fragments[X-1],this.fragmentTracker.removeFragment(V))}if(V&&this.fragmentTracker.getState(V)===b.FragmentState.OK&&this.nextLoadPosition>G){var j=this.audioOnly&&!this.altAudio?E.ElementaryStreamTypes.AUDIO:E.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(I,j,a.PlaylistLevelType.MAIN),V=this.getNextFragment(this.nextLoadPosition,F)}V&&(!V.initSegment||V.initSegment.data||this.bitrateTest||(V=V.initSegment),((u=V.decryptdata)===null||u===void 0?void 0:u.keyFormat)!=="identity"||(g=V.decryptdata)!==null&&g!==void 0&&g.key?this.loadFragment(V,F,G):this.loadKey(V,F))}}}},R.loadFragment=function(u,g,T){var C,w=this.fragmentTracker.getState(u);if(this.fragCurrent=u,w===b.FragmentState.BACKTRACKED){var I=this.fragmentTracker.getBacktrackData(u);if(I)return this._handleFragmentLoadProgress(I),void this._handleFragmentLoadComplete(I);w=b.FragmentState.NOT_LOADED}w===b.FragmentState.NOT_LOADED||w===b.FragmentState.PARTIAL?u.sn==="initSegment"?this._loadInitSegment(u):this.bitrateTest?(u.bitrateTest=!0,this.log("Fragment "+u.sn+" of level "+u.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(u)):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,u,g,T)):w===b.FragmentState.APPENDING?this.reduceMaxBufferLength(u.duration)&&this.fragmentTracker.removeFragment(u):((C=this.media)===null||C===void 0?void 0:C.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},R.getAppendedFrag=function(u){var g=this.fragmentTracker.getAppendedFrag(u,a.PlaylistLevelType.MAIN);return g&&"fragment"in g?g.fragment:g},R.getBufferedFrag=function(u){return this.fragmentTracker.getBufferedFrag(u,a.PlaylistLevelType.MAIN)},R.followingBufferedFrag=function(u){return u?this.getBufferedFrag(u.end+.5):null},R.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},R.nextLevelSwitch=function(){var u=this.levels,g=this.media;if(g!=null&&g.readyState){var T,C=this.getAppendedFrag(g.currentTime);if(C&&C.start>1&&this.flushMainBuffer(0,C.start-1),!g.paused&&u){var w=u[this.hls.nextLoadLevel],I=this.fragLastKbps;T=I&&this.fragCurrent?this.fragCurrent.duration*w.maxBitrate/(1e3*I)+1:0}else T=0;var O=this.getBufferedFrag(g.currentTime+T);if(O){var x=this.followingBufferedFrag(O);if(x){this.abortCurrentFrag();var P=x.maxStartPTS?x.maxStartPTS:x.start,F=x.duration,N=Math.max(O.end,P+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,.5*F),.75*F));this.flushMainBuffer(N,Number.POSITIVE_INFINITY)}}}},R.abortCurrentFrag=function(){var u=this.fragCurrent;this.fragCurrent=null,u!=null&&u.loader&&u.loader.abort(),this.state===n.State.KEY_LOADING&&(this.state=n.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},R.flushMainBuffer=function(u,g){p.prototype.flushMainBuffer.call(this,u,g,this.altAudio?"video":null)},R.onMediaAttached=function(u,g){p.prototype.onMediaAttached.call(this,u,g);var T=g.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),T.addEventListener("playing",this.onvplaying),T.addEventListener("seeked",this.onvseeked),this.gapController=new L.default(this.config,T,this.fragmentTracker,this.hls)},R.onMediaDetaching=function(){var u=this.media;u&&(u.removeEventListener("playing",this.onvplaying),u.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),p.prototype.onMediaDetaching.call(this)},R.onMediaPlaying=function(){this.tick()},R.onMediaSeeked=function(){var u=this.media,g=u?u.currentTime:null;Object(i.isFiniteNumber)(g)&&this.log("Media seeked to "+g.toFixed(3)),this.tick()},R.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(f.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},R.onManifestParsed=function(u,g){var T,C=!1,w=!1;g.levels.forEach(function(I){(T=I.audioCodec)&&(T.indexOf("mp4a.40.2")!==-1&&(C=!0),T.indexOf("mp4a.40.5")!==-1&&(w=!0))}),this.audioCodecSwitch=C&&w&&!Object(s.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=g.levels,this.startFragRequested=!1},R.onLevelLoading=function(u,g){var T=this.levels;if(T&&this.state===n.State.IDLE){var C=T[g.level];(!C.details||C.details.live&&this.levelLastLoaded!==g.level||this.waitForCdnTuneIn(C.details))&&(this.state=n.State.WAITING_LEVEL)}},R.onLevelLoaded=function(u,g){var T,C=this.levels,w=g.level,I=g.details,O=I.totalduration;if(C){this.log("Level "+w+" loaded ["+I.startSN+","+I.endSN+"], cc ["+I.startCC+", "+I.endCC+"] duration:"+O);var x=this.fragCurrent;!x||this.state!==n.State.FRAG_LOADING&&this.state!==n.State.FRAG_LOADING_WAITING_RETRY||x.level!==g.level&&x.loader&&(this.state=n.State.IDLE,x.loader.abort());var P=C[w],F=0;if(I.live||(T=P.details)!==null&&T!==void 0&&T.live){if(I.fragments[0]||(I.deltaUpdateFailed=!0),I.deltaUpdateFailed)return;F=this.alignPlaylists(I,P.details)}if(P.details=I,this.levelLastLoaded=w,this.hls.trigger(f.Events.LEVEL_UPDATED,{details:I,level:w}),this.state===n.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(I))return;this.state=n.State.IDLE}this.startFragRequested?I.live&&this.synchronizeToLiveEdge(I):this.setStartPosition(I,F),this.tick()}else this.warn("Levels were reset while loading level "+w)},R._handleFragmentLoadProgress=function(u){var g,T=u.frag,C=u.part,w=u.payload,I=this.levels;if(I){var O=I[T.level],x=O.details;if(x){var P=O.videoCodec,F=x.PTSKnown||!x.live,N=(g=T.initSegment)===null||g===void 0?void 0:g.data,U=this._getAudioCodec(O),G=this.transmuxer=this.transmuxer||new v.default(this.hls,a.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),V=C?C.index:-1,X=V!==-1,j=new d.ChunkMetadata(T.level,T.sn,T.stats.chunkCount,w.byteLength,V,X),z=this.initPTS[T.cc];G.push(w,N,U,P,T,C,x.totalduration,F,j,z)}else this.warn("Dropping fragment "+T.sn+" of level "+T.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+T.sn+" of level "+T.level+" will not be buffered")},R.onAudioTrackSwitching=function(u,g){var T=this.altAudio,C=!!g.url,w=g.id;if(!C){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var I=this.fragCurrent;I!=null&&I.loader&&(this.log("Switching to main audio track, cancel main fragment load"),I.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var O=this.hls;T&&O.trigger(f.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),O.trigger(f.Events.AUDIO_TRACK_SWITCHED,{id:w})}},R.onAudioTrackSwitched=function(u,g){var T=g.id,C=!!this.hls.audioTracks[T].url;if(C){var w=this.videoBuffer;w&&this.mediaBuffer!==w&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=w)}this.altAudio=C,this.tick()},R.onBufferCreated=function(u,g){var T,C,w=g.tracks,I=!1;for(var O in w){var x=w[O];if(x.id==="main"){if(C=O,T=x,O==="video"){var P=w[O];P&&(this.videoBuffer=P.buffer)}}else I=!0}I&&T?(this.log("Alternate track found, use "+C+".buffered to schedule main fragment loading"),this.mediaBuffer=T.buffer):this.mediaBuffer=this.media},R.onFragBuffered=function(u,g){var T=g.frag,C=g.part;if(!T||T.type===a.PlaylistLevelType.MAIN){if(this.fragContextChanged(T))return this.warn("Fragment "+T.sn+(C?" p: "+C.index:"")+" of level "+T.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===n.State.PARSED&&(this.state=n.State.IDLE));var w=C?C.stats:T.stats;this.fragLastKbps=Math.round(8*w.total/(w.buffering.end-w.loading.first)),T.sn!=="initSegment"&&(this.fragPrevious=T),this.fragBufferedComplete(T,C)}},R.onError=function(u,g){switch(g.details){case k.ErrorDetails.FRAG_LOAD_ERROR:case k.ErrorDetails.FRAG_LOAD_TIMEOUT:case k.ErrorDetails.KEY_LOAD_ERROR:case k.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(a.PlaylistLevelType.MAIN,g);break;case k.ErrorDetails.LEVEL_LOAD_ERROR:case k.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==n.State.ERROR&&(g.fatal?(this.warn(""+g.details),this.state=n.State.ERROR):g.levelRetry||this.state!==n.State.WAITING_LEVEL||(this.state=n.State.IDLE));break;case k.ErrorDetails.BUFFER_FULL_ERROR:if(g.parent==="main"&&(this.state===n.State.PARSING||this.state===n.State.PARSED)){var T=!0,C=this.getFwdBufferInfo(this.media,a.PlaylistLevelType.MAIN);C&&C.len>.5&&(T=!this.reduceMaxBufferLength(C.len)),T&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},R.checkBuffer=function(){var u=this.media,g=this.gapController;if(u&&g&&u.readyState){var T=_.BufferHelper.getBuffered(u);!this.loadedmetadata&&T.length?(this.loadedmetadata=!0,this.seekToStartPos()):g.poll(this.lastCurrentTime),this.lastCurrentTime=u.currentTime}},R.onFragLoadEmergencyAborted=function(){this.state=n.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},R.onBufferFlushed=function(u,g){var T=g.type;if(T!==E.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var C=(T===E.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(C,T,a.PlaylistLevelType.MAIN)}},R.onLevelsUpdated=function(u,g){this.levels=g.levels},R.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},R.seekToStartPos=function(){var u=this.media,g=u.currentTime,T=this.startPosition;if(T>=0&&g<T){if(u.seeking)return void m.logger.log("could not seek to "+T+", already seeking at "+g);var C=_.BufferHelper.getBuffered(u),w=(C.length?C.start(0):0)-T;w>0&&w<this.config.maxBufferHole&&(m.logger.log("adjusting start position by "+w+" to match buffer start"),T+=w,this.startPosition=T),this.log("seek to target start position "+T+" from current time "+g),u.currentTime=T}},R._getAudioCodec=function(u){var g=this.config.defaultAudioCodec||u.audioCodec;return this.audioCodecSwap&&g&&(this.log("Swapping audio codec"),g=g.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),g},R._loadBitrateTestFrag=function(u){var g=this;this._doFragLoad(u).then(function(T){var C=g.hls;if(T&&!C.nextLoadLevel&&!g.fragContextChanged(u)){g.fragLoadError=0,g.state=n.State.IDLE,g.startFragRequested=!1,g.bitrateTest=!1;var w=u.stats;w.parsing.start=w.parsing.end=w.buffering.start=w.buffering.end=self.performance.now(),C.trigger(f.Events.FRAG_LOADED,T)}})},R._handleTransmuxComplete=function(u){var g,T="main",C=this.hls,w=u.remuxResult,I=u.chunkMeta,O=this.getCurrentContext(I);if(!O)return this.warn("The loading context changed while buffering fragment "+I.sn+" of level "+I.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(I.level);var x=O.frag,P=O.part,F=O.level,N=w.video,U=w.text,G=w.id3,V=w.initSegment,X=this.altAudio?void 0:w.audio;if(!this.fragContextChanged(x)){if(this.state=n.State.PARSING,V){V.tracks&&(this._bufferInitSegment(F,V.tracks,x,I),C.trigger(f.Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:T,tracks:V.tracks}));var j=V.initPTS,z=V.timescale;Object(i.isFiniteNumber)(j)&&(this.initPTS[x.cc]=j,C.trigger(f.Events.INIT_PTS_FOUND,{frag:x,id:T,initPTS:j,timescale:z}))}if(N&&w.independent!==!1){if(F.details){var W=N.startPTS,$=N.endPTS,ne=N.startDTS,le=N.endDTS;if(P)P.elementaryStreams[N.type]={startPTS:W,endPTS:$,startDTS:ne,endDTS:le};else if(N.firstKeyFrame&&N.independent&&(this.couldBacktrack=!0),N.dropped&&N.independent){if(this.getLoadPosition()+this.config.maxBufferHole<W)return void this.backtrack(x);x.setElementaryStreamInfo(N.type,x.start,$,x.start,le,!0)}x.setElementaryStreamInfo(N.type,W,$,ne,le),this.bufferFragmentData(N,x,P,I)}}else if(w.independent===!1)return void this.backtrack(x);if(X){var ae=X.startPTS,M=X.endPTS,B=X.startDTS,K=X.endDTS;P&&(P.elementaryStreams[E.ElementaryStreamTypes.AUDIO]={startPTS:ae,endPTS:M,startDTS:B,endDTS:K}),x.setElementaryStreamInfo(E.ElementaryStreamTypes.AUDIO,ae,M,B,K),this.bufferFragmentData(X,x,P,I)}if(G!=null&&(g=G.samples)!==null&&g!==void 0&&g.length){var H={frag:x,id:T,samples:G.samples};C.trigger(f.Events.FRAG_PARSING_METADATA,H)}if(U){var q={frag:x,id:T,samples:U.samples};C.trigger(f.Events.FRAG_PARSING_USERDATA,q)}}},R._bufferInitSegment=function(u,g,T,C){var w=this;if(this.state===n.State.PARSING){this.audioOnly=!!g.audio&&!g.video,this.altAudio&&!this.audioOnly&&delete g.audio;var I=g.audio,O=g.video,x=g.audiovideo;if(I){var P=u.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(P&&(P=P.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),I.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(P="mp4a.40.5")),F.indexOf("android")!==-1&&I.container!=="audio/mpeg"&&(P="mp4a.40.2",this.log("Android: force audio codec to "+P)),u.audioCodec&&u.audioCodec!==P&&this.log('Swapping manifest audio codec "'+u.audioCodec+'" for "'+P+'"'),I.levelCodec=P,I.id="main",this.log("Init audio buffer, container:"+I.container+", codecs[selected/level/parsed]=["+(P||"")+"/"+(u.audioCodec||"")+"/"+I.codec+"]")}O&&(O.levelCodec=u.videoCodec,O.id="main",this.log("Init video buffer, container:"+O.container+", codecs[level/parsed]=["+(u.videoCodec||"")+"/"+O.codec+"]")),x&&this.log("Init audiovideo buffer, container:"+x.container+", codecs[level/parsed]=["+(u.attrs.CODECS||"")+"/"+x.codec+"]"),this.hls.trigger(f.Events.BUFFER_CODECS,g),Object.keys(g).forEach(function(N){var U=g[N].initSegment;U!=null&&U.byteLength&&w.hls.trigger(f.Events.BUFFER_APPENDING,{type:N,data:U,frag:T,part:null,chunkMeta:C,parent:T.type})}),this.tick()}},R.backtrack=function(u){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(u);var g=this.fragmentTracker.backtrack(u);this.fragPrevious=null,this.nextLoadPosition=u.start,g?this.resetFragmentLoading(u):this.state=n.State.BACKTRACKING},R.checkFragmentChanged=function(){var u=this.media,g=null;if(u&&u.readyState>1&&u.seeking===!1){var T=u.currentTime;if(_.BufferHelper.isBuffered(u,T)?g=this.getAppendedFrag(T):_.BufferHelper.isBuffered(u,T+.1)&&(g=this.getAppendedFrag(T+.1)),g){var C=this.fragPlaying,w=g.level;C&&g.sn===C.sn&&C.level===w&&g.urlId===C.urlId||(this.hls.trigger(f.Events.FRAG_CHANGED,{frag:g}),C&&C.level===w||this.hls.trigger(f.Events.LEVEL_SWITCHED,{level:w}),this.fragPlaying=g)}}},D=S,(A=[{key:"nextLevel",get:function(){var u=this.nextBufferedFrag;return u?u.level:-1}},{key:"currentLevel",get:function(){var u=this.media;if(u){var g=this.getAppendedFrag(u.currentTime);if(g)return g.level}return-1}},{key:"nextBufferedFrag",get:function(){var u=this.media;if(u){var g=this.getAppendedFrag(u.currentTime);return this.followingBufferedFrag(g)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&o(D.prototype,A),S}(n.default)},"./src/controller/subtitle-stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"SubtitleStreamController",function(){return m});var i=r("./src/events.ts"),n=r("./src/utils/logger.ts"),s=r("./src/utils/buffer-helper.ts"),f=r("./src/controller/fragment-finders.ts"),_=r("./src/utils/discontinuities.ts"),b=r("./src/controller/level-helper.ts"),a=r("./src/controller/fragment-tracker.ts"),E=r("./src/controller/base-stream-controller.ts"),v=r("./src/types/loader.ts"),d=r("./src/types/level.ts");function L(o,c){for(var l=0;l<c.length;l++){var p=c[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(o,p.key,p)}}function k(o,c){return(k=Object.setPrototypeOf||function(l,p){return l.__proto__=p,l})(o,c)}var m=function(o){var c,l;function p(D,A){var R;return(R=o.call(this,D,A,"[subtitle-stream-controller]")||this).levels=[],R.currentTrackId=-1,R.tracksBuffered=[],R.mainDetails=null,R._registerListeners(),R}l=o,(c=p).prototype=Object.create(l.prototype),c.prototype.constructor=c,k(c,l);var y,h,S=p.prototype;return S.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},S._registerListeners=function(){var D=this.hls;D.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),D.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),D.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),D.on(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),D.on(i.Events.ERROR,this.onError,this),D.on(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),D.on(i.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),D.on(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),D.on(i.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),D.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},S._unregisterListeners=function(){var D=this.hls;D.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),D.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),D.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),D.off(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),D.off(i.Events.ERROR,this.onError,this),D.off(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),D.off(i.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),D.off(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),D.off(i.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),D.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},S.startLoad=function(){this.stopLoad(),this.state=E.State.IDLE,this.setInterval(500),this.tick()},S.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},S.onLevelLoaded=function(D,A){this.mainDetails=A.details},S.onSubtitleFragProcessed=function(D,A){var R=A.frag,u=A.success;if(this.fragPrevious=R,this.state=E.State.IDLE,u){var g=this.tracksBuffered[this.currentTrackId];if(g){for(var T,C=R.start,w=0;w<g.length;w++)if(C>=g[w].start&&C<=g[w].end){T=g[w];break}var I=R.start+R.duration;T?T.end=I:(T={start:C,end:I},g.push(T)),this.fragmentTracker.fragBuffered(R)}}},S.onBufferFlushing=function(D,A){var R=A.startOffset,u=A.endOffset;if(R===0&&u!==Number.POSITIVE_INFINITY){var g=this.currentTrackId,T=this.levels;if(!T.length||!T[g]||!T[g].details)return;var C=u-T[g].details.targetduration;if(C<=0)return;A.endOffsetSubtitles=Math.max(0,C),this.tracksBuffered.forEach(function(w){for(var I=0;I<w.length;)if(w[I].end<=C)w.shift();else{if(!(w[I].start<C))break;w[I].start=C,I++}}),this.fragmentTracker.removeFragmentsInRange(R,C,v.PlaylistLevelType.SUBTITLE)}},S.onError=function(D,A){var R,u=A.frag;u&&u.type===v.PlaylistLevelType.SUBTITLE&&((R=this.fragCurrent)!==null&&R!==void 0&&R.loader&&this.fragCurrent.loader.abort(),this.state=E.State.IDLE)},S.onSubtitleTracksUpdated=function(D,A){var R=this,u=A.subtitleTracks;this.tracksBuffered=[],this.levels=u.map(function(g){return new d.Level(g)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(g){R.tracksBuffered[g.id]=[]}),this.mediaBuffer=null},S.onSubtitleTrackSwitch=function(D,A){if(this.currentTrackId=A.id,this.levels.length&&this.currentTrackId!==-1){var R=this.levels[this.currentTrackId];R!=null&&R.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},S.onSubtitleTrackLoaded=function(D,A){var R,u=A.details,g=A.id,T=this.currentTrackId,C=this.levels;if(C.length){var w=C[T];if(!(g>=C.length||g!==T)&&w){if(this.mediaBuffer=this.mediaBufferTimeRanges,u.live||(R=w.details)!==null&&R!==void 0&&R.live){var I=this.mainDetails;if(u.deltaUpdateFailed||!I)return;var O=I.fragments[0];w.details?this.alignPlaylists(u,w.details)===0&&O&&Object(b.addSliding)(u,O.start):u.hasProgramDateTime&&I.hasProgramDateTime?Object(_.alignPDT)(u,I):O&&Object(b.addSliding)(u,O.start)}w.details=u,this.levelLastLoaded=g,this.tick(),u.live&&!this.fragCurrent&&this.media&&this.state===E.State.IDLE&&(Object(f.findFragmentByPTS)(null,u.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),w.details=void 0))}}},S._handleFragmentLoadComplete=function(D){var A=D.frag,R=D.payload,u=A.decryptdata,g=this.hls;if(!this.fragContextChanged(A)&&R&&R.byteLength>0&&u&&u.key&&u.iv&&u.method==="AES-128"){var T=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(R),u.key.buffer,u.iv.buffer).then(function(C){var w=performance.now();g.trigger(i.Events.FRAG_DECRYPTED,{frag:A,payload:C,stats:{tstart:T,tdecrypt:w}})})}},S.doTick=function(){if(this.media){if(this.state===E.State.IDLE){var D,A=this.currentTrackId,R=this.levels;if(!R.length||!R[A]||!R[A].details)return;var u=R[A].details,g=u.targetduration,T=this.config,C=this.media,w=s.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,C.currentTime-g,T.maxBufferHole),I=w.end;if(w.len>this.getMaxBufferLength()+g)return;console.assert(u,"Subtitle track details are defined on idle subtitle stream controller tick");var O,x=u.fragments,P=x.length,F=u.edge,N=this.fragPrevious;if(I<F){var U=T.maxFragLookUpTolerance;N&&u.hasProgramDateTime&&(O=Object(f.findFragmentByPDT)(x,N.endProgramDateTime,U)),O||!(O=Object(f.findFragmentByPTS)(N,x,I,U))&&N&&N.start<x[0].start&&(O=x[0])}else O=x[P-1];(D=O)!==null&&D!==void 0&&D.encrypted?(n.logger.log("Loading key for "+O.sn),this.state=E.State.KEY_LOADING,this.hls.trigger(i.Events.KEY_LOADING,{frag:O})):O&&this.fragmentTracker.getState(O)===a.FragmentState.NOT_LOADED&&this.loadFragment(O,u,I)}}else this.state=E.State.IDLE},S.loadFragment=function(D,A,R){this.fragCurrent=D,o.prototype.loadFragment.call(this,D,A,R)},y=p,(h=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&L(y.prototype,h),p}(E.default)},"./src/controller/subtitle-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/texttrack-utils.ts"),s=r("./src/controller/base-playlist-controller.ts"),f=r("./src/types/loader.ts");function _(v,d){for(var L=0;L<d.length;L++){var k=d[L];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(v,k.key,k)}}function b(v,d){return(b=Object.setPrototypeOf||function(L,k){return L.__proto__=k,L})(v,d)}var a=function(v){var d,L;function k(l){var p;return(p=v.call(this,l,"[subtitle-track-controller]")||this).media=null,p.tracks=[],p.groupId=null,p.tracksInGroup=[],p.trackId=-1,p.selectDefaultTrack=!0,p.queuedDefaultTrack=-1,p.trackChangeListener=function(){return p.onTextTracksChanged()},p.asyncPollTrackChange=function(){return p.pollTrackChange(0)},p.useTextTrackPolling=!1,p.subtitlePollingInterval=-1,p.subtitleDisplay=!0,p.registerListeners(),p}L=v,(d=k).prototype=Object.create(L.prototype),d.prototype.constructor=d,b(d,L);var m,o,c=k.prototype;return c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,v.prototype.destroy.call(this)},c.registerListeners=function(){var l=this.hls;l.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.on(i.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var l=this.hls;l.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.off(i.Events.ERROR,this.onError,this)},c.onMediaAttached=function(l,p){this.media=p.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},c.pollTrackChange=function(l){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,l)},c.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),E(this.media.textTracks).forEach(function(l){Object(n.clearCurrentCues)(l)}),this.subtitleTrack=-1,this.media=null)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},c.onManifestParsed=function(l,p){this.tracks=p.subtitleTracks},c.onSubtitleTrackLoaded=function(l,p){var y=p.id,h=p.details,S=this.trackId,D=this.tracksInGroup[S];if(D){var A=D.details;D.details=p.details,this.log("subtitle track "+y+" loaded ["+h.startSN+"-"+h.endSN+"]"),y===this.trackId&&(this.retryCount=0,this.playlistLoaded(y,p,A))}else this.warn("Invalid subtitle track id "+y)},c.onLevelLoading=function(l,p){this.switchLevel(p.level)},c.onLevelSwitching=function(l,p){this.switchLevel(p.level)},c.switchLevel=function(l){var p=this.hls.levels[l];if(p!=null&&p.textGroupIds){var y=p.textGroupIds[p.urlId];if(this.groupId!==y){var h=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,S=this.tracks.filter(function(R){return!y||R.groupId===y});this.tracksInGroup=S;var D=this.findTrackId(h==null?void 0:h.name)||this.findTrackId();this.groupId=y;var A={subtitleTracks:S};this.log("Updating subtitle tracks, "+S.length+' track(s) found in "'+y+'" group-id'),this.hls.trigger(i.Events.SUBTITLE_TRACKS_UPDATED,A),D!==-1&&this.setSubtitleTrack(D,h)}}},c.findTrackId=function(l){for(var p=this.tracksInGroup,y=0;y<p.length;y++){var h=p[y];if((!this.selectDefaultTrack||h.default)&&(!l||l===h.name))return h.id}return-1},c.onError=function(l,p){v.prototype.onError.call(this,l,p),!p.fatal&&p.context&&p.context.type===f.PlaylistContextType.SUBTITLE_TRACK&&p.context.id===this.trackId&&p.context.groupId===this.groupId&&this.retryLoadingOrFail(p)},c.loadPlaylist=function(l){var p=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(p)){var y=p.id,h=p.groupId,S=p.url;if(l)try{S=l.addDirectives(S)}catch(D){this.warn("Could not construct new URL with HLS Delivery Directives: "+D)}this.log("Loading subtitle playlist for id "+y),this.hls.trigger(i.Events.SUBTITLE_TRACK_LOADING,{url:S,id:y,groupId:h,deliveryDirectives:l||null})}},c.toggleTrackModes=function(l){var p=this,y=this.media,h=this.subtitleDisplay,S=this.trackId;if(y){var D=E(y.textTracks),A=D.filter(function(g){return g.groupId===p.groupId});if(l===-1)[].slice.call(D).forEach(function(g){g.mode="disabled"});else{var R=A[S];R&&(R.mode="disabled")}var u=A[l];u&&(u.mode=h?"showing":"hidden")}},c.setSubtitleTrack=function(l,p){var y,h=this.tracksInGroup;if(this.media){if(this.trackId!==l&&this.toggleTrackModes(l),!(this.trackId===l&&(l===-1||(y=h[l])!==null&&y!==void 0&&y.details)||l<-1||l>=h.length)){this.clearTimer();var S=h[l];if(this.log("Switching to subtitle track "+l),this.trackId=l,S){var D=S.id,A=S.groupId,R=A===void 0?"":A,u=S.name,g=S.type,T=S.url;this.hls.trigger(i.Events.SUBTITLE_TRACK_SWITCH,{id:D,groupId:R,name:u,type:g,url:T});var C=this.switchParams(S.url,p==null?void 0:p.details);this.loadPlaylist(C)}else this.hls.trigger(i.Events.SUBTITLE_TRACK_SWITCH,{id:l})}}else this.queuedDefaultTrack=l},c.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var l=-1,p=E(this.media.textTracks),y=0;y<p.length;y++)if(p[y].mode==="hidden")l=y;else if(p[y].mode==="showing"){l=y;break}this.subtitleTrack!==l&&(this.subtitleTrack=l)}},m=k,(o=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1;var p=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(l,p)}}])&&_(m.prototype,o),k}(s.default);function E(v){for(var d=[],L=0;L<v.length;L++){var k=v[L];k.kind==="subtitles"&&k.label&&d.push(v[L])}return d}t.default=a},"./src/controller/timeline-controller.ts":function(e,t,r){r.r(t),r.d(t,"TimelineController",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/utils/cea-608-parser.ts"),f=r("./src/utils/output-filter.ts"),_=r("./src/utils/webvtt-parser.ts"),b=r("./src/utils/texttrack-utils.ts"),a=r("./src/utils/imsc1-ttml-parser.ts"),E=r("./src/types/loader.ts"),v=r("./src/utils/logger.ts"),d=function(){function k(o){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=o,this.config=o.config,this.Cues=o.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var c=new f.default(this,"textTrack1"),l=new f.default(this,"textTrack2"),p=new f.default(this,"textTrack3"),y=new f.default(this,"textTrack4");this.cea608Parser1=new s.default(1,c,l),this.cea608Parser2=new s.default(3,p,y)}o.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(n.Events.FRAG_LOADING,this.onFragLoading,this),o.on(n.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(n.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.on(n.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.on(n.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(n.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var m=k.prototype;return m.destroy=function(){var o=this.hls;o.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(n.Events.FRAG_LOADING,this.onFragLoading,this),o.off(n.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(n.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.off(n.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.off(n.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(n.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},m.addCues=function(o,c,l,p,y){for(var h,S,D,A,R=!1,u=y.length;u--;){var g=y[u],T=(h=g[0],S=g[1],D=c,A=l,Math.min(S,A)-Math.max(h,D));if(T>=0&&(g[0]=Math.min(g[0],c),g[1]=Math.max(g[1],l),R=!0,T/(l-c)>.5))return}if(R||y.push([c,l]),this.config.renderTextTracksNatively){var C=this.captionsTracks[o];this.Cues.newCue(C,c,l,p)}else{var w=this.Cues.newCue(null,c,l,p);this.hls.trigger(n.Events.CUES_PARSED,{type:"captions",cues:w,track:o})}},m.onInitPtsFound=function(o,c){var l=this,p=c.frag,y=c.id,h=c.initPTS,S=c.timescale,D=this.unparsedVttFrags;y==="main"&&(this.initPTS[p.cc]=h,this.timescale[p.cc]=S),D.length&&(this.unparsedVttFrags=[],D.forEach(function(A){l.onFragLoaded(n.Events.FRAG_LOADED,A)}))},m.getExistingTrack=function(o){var c=this.media;if(c)for(var l=0;l<c.textTracks.length;l++){var p=c.textTracks[l];if(p[o])return p}return null},m.createCaptionsTrack=function(o){this.config.renderTextTracksNatively?this.createNativeTrack(o):this.createNonNativeTrack(o)},m.createNativeTrack=function(o){if(!this.captionsTracks[o]){var c=this.captionsProperties,l=this.captionsTracks,p=this.media,y=c[o],h=y.label,S=y.languageCode,D=this.getExistingTrack(o);if(D)l[o]=D,Object(b.clearCurrentCues)(l[o]),Object(b.sendAddTrackEvent)(l[o],p);else{var A=this.createTextTrack("captions",h,S);A&&(A[o]=!0,l[o]=A)}}},m.createNonNativeTrack=function(o){if(!this.nonNativeCaptionsTracks[o]){var c=this.captionsProperties[o];if(c){var l={_id:o,label:c.label,kind:"captions",default:!!c.media&&!!c.media.default,closedCaptions:c.media};this.nonNativeCaptionsTracks[o]=l,this.hls.trigger(n.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[l]})}}},m.createTextTrack=function(o,c,l){var p=this.media;if(p)return p.addTextTrack(o,c,l)},m.onMediaAttaching=function(o,c){this.media=c.media,this._cleanTracks()},m.onMediaDetaching=function(){var o=this.captionsTracks;Object.keys(o).forEach(function(c){Object(b.clearCurrentCues)(o[c]),delete o[c]}),this.nonNativeCaptionsTracks={}},m.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},m._cleanTracks=function(){var o=this.media;if(o){var c=o.textTracks;if(c)for(var l=0;l<c.length;l++)Object(b.clearCurrentCues)(c[l])}},m.onSubtitleTracksUpdated=function(o,c){var l=this;this.textTracks=[];var p=c.subtitleTracks||[],y=p.some(function(A){return A.textCodec===a.IMSC1_CODEC});if(this.config.enableWebVTT||y&&this.config.enableIMSC1){var h=this.tracks&&p&&this.tracks.length===p.length;if(this.tracks=p||[],this.config.renderTextTracksNatively){var S=this.media?this.media.textTracks:[];this.tracks.forEach(function(A,R){var u;if(R<S.length){for(var g=null,T=0;T<S.length;T++)if(L(S[T],A)){g=S[T];break}g&&(u=g)}u?Object(b.clearCurrentCues)(u):(u=l.createTextTrack("subtitles",A.name,A.lang))&&(u.mode="disabled"),u&&(u.groupId=A.groupId,l.textTracks.push(u))})}else if(!h&&this.tracks&&this.tracks.length){var D=this.tracks.map(function(A){return{label:A.name,kind:A.type.toLowerCase(),default:A.default,subtitleTrack:A}});this.hls.trigger(n.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:D})}}},m.onManifestLoaded=function(o,c){var l=this;this.config.enableCEA708Captions&&c.captions&&c.captions.forEach(function(p){var y=/(?:CC|SERVICE)([1-4])/.exec(p.instreamId);if(y){var h="textTrack"+y[1],S=l.captionsProperties[h];S&&(S.label=p.name,p.lang&&(S.languageCode=p.lang),S.media=p)}})},m.onFragLoading=function(o,c){var l=this.cea608Parser1,p=this.cea608Parser2,y=this.lastSn;if(this.enabled&&l&&p&&c.frag.type===E.PlaylistLevelType.MAIN){var h=c.frag.sn;h!==y+1&&(l.reset(),p.reset()),this.lastSn=h}},m.onFragLoaded=function(o,c){var l=c.frag,p=c.payload,y=this.initPTS,h=this.unparsedVttFrags;if(l.type===E.PlaylistLevelType.SUBTITLE)if(p.byteLength){if(!Object(i.isFiniteNumber)(y[l.cc]))return h.push(c),void(y.length&&this.hls.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Missing initial subtitle PTS")}));var S=l.decryptdata;if(S==null||S.key==null||S.method!=="AES-128"){var D=this.tracks[l.level],A=this.vttCCs;A[l.cc]||(A[l.cc]={start:l.start,prevCC:this.prevCC,new:!0},this.prevCC=l.cc),D&&D.textCodec===a.IMSC1_CODEC?this._parseIMSC1(l,p):this._parseVTTs(l,p,A)}}else this.hls.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Empty subtitle payload")})},m._parseIMSC1=function(o,c){var l=this,p=this.hls;Object(a.parseIMSC1)(c,this.initPTS[o.cc],this.timescale[o.cc],function(y){l._appendCues(y,o.level),p.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})},function(y){v.logger.log("Failed to parse IMSC1: "+y),p.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:y})})},m._parseVTTs=function(o,c,l){var p=this,y=this.hls;Object(_.parseWebVTT)(c,this.initPTS[o.cc],this.timescale[o.cc],l,o.cc,o.start,function(h){p._appendCues(h,o.level),y.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})},function(h){p._fallbackToIMSC1(o,c),v.logger.log("Failed to parse VTT cue: "+h),y.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:h})})},m._fallbackToIMSC1=function(o,c){var l=this,p=this.tracks[o.level];p.textCodec||Object(a.parseIMSC1)(c,this.initPTS[o.cc],this.timescale[o.cc],function(){p.textCodec=a.IMSC1_CODEC,l._parseIMSC1(o,c)},function(){p.textCodec="wvtt"})},m._appendCues=function(o,c){var l=this.hls;if(this.config.renderTextTracksNatively){var p=this.textTracks[c];if(p.mode==="disabled")return;o.forEach(function(h){return Object(b.addCueToTrack)(p,h)})}else{var y=this.tracks[c].default?"default":"subtitles"+c;l.trigger(n.Events.CUES_PARSED,{type:"subtitles",cues:o,track:y})}},m.onFragDecrypted=function(o,c){var l=c.frag;if(l.type===E.PlaylistLevelType.SUBTITLE){if(!Object(i.isFiniteNumber)(this.initPTS[l.cc]))return void this.unparsedVttFrags.push(c);this.onFragLoaded(n.Events.FRAG_LOADED,c)}},m.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},m.onFragParsingUserdata=function(o,c){var l=this.cea608Parser1,p=this.cea608Parser2;if(this.enabled&&l&&p)for(var y=0;y<c.samples.length;y++){var h=c.samples[y].bytes;if(h){var S=this.extractCea608Data(h);l.addData(c.samples[y].pts,S[0]),p.addData(c.samples[y].pts,S[1])}}},m.onBufferFlushing=function(o,c){var l=c.startOffset,p=c.endOffset,y=c.endOffsetSubtitles,h=c.type,S=this.media;if(S&&!(S.currentTime<p)){if(!h||h==="video"){var D=this.captionsTracks;Object.keys(D).forEach(function(R){return Object(b.removeCuesInRange)(D[R],l,p)})}if(this.config.renderTextTracksNatively&&l===0&&y!==void 0){var A=this.textTracks;Object.keys(A).forEach(function(R){return Object(b.removeCuesInRange)(A[R],l,y)})}}},m.extractCea608Data=function(o){for(var c=31&o[0],l=2,p=[[],[]],y=0;y<c;y++){var h=o[l++],S=127&o[l++],D=127&o[l++],A=3&h;S===0&&D===0||4&h&&(A!==0&&A!==1||(p[A].push(S),p[A].push(D)))}return p},k}();function L(k,m){return k&&k.label===m.name&&!(k.textTrack1||k.textTrack2)}},"./src/crypt/aes-crypto.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(s,f){this.subtle=void 0,this.aesIV=void 0,this.subtle=s,this.aesIV=f}return n.prototype.decrypt=function(s,f){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},f,s)},n}()},"./src/crypt/aes-decryptor.ts":function(e,t,r){r.r(t),r.d(t,"removePadding",function(){return n}),r.d(t,"default",function(){return s});var i=r("./src/utils/typed-array.ts");function n(f){var _=f.byteLength,b=_&&new DataView(f.buffer).getUint8(_-1);return b?Object(i.sliceUint8)(f,0,_-b):f}var s=function(){function f(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var _=f.prototype;return _.uint8ArrayToUint32Array_=function(b){for(var a=new DataView(b),E=new Uint32Array(4),v=0;v<4;v++)E[v]=a.getUint32(4*v);return E},_.initTable=function(){var b=this.sBox,a=this.invSBox,E=this.subMix,v=E[0],d=E[1],L=E[2],k=E[3],m=this.invSubMix,o=m[0],c=m[1],l=m[2],p=m[3],y=new Uint32Array(256),h=0,S=0,D=0;for(D=0;D<256;D++)y[D]=D<128?D<<1:D<<1^283;for(D=0;D<256;D++){var A=S^S<<1^S<<2^S<<3^S<<4;A=A>>>8^255&A^99,b[h]=A,a[A]=h;var R=y[h],u=y[R],g=y[u],T=257*y[A]^16843008*A;v[h]=T<<24|T>>>8,d[h]=T<<16|T>>>16,L[h]=T<<8|T>>>24,k[h]=T,T=16843009*g^65537*u^257*R^16843008*h,o[A]=T<<24|T>>>8,c[A]=T<<16|T>>>16,l[A]=T<<8|T>>>24,p[A]=T,h?(h=R^y[y[y[g^R]]],S^=y[y[S]]):h=S=1}},_.expandKey=function(b){for(var a=this.uint8ArrayToUint32Array_(b),E=!0,v=0;v<a.length&&E;)E=a[v]===this.key[v],v++;if(!E){this.key=a;var d=this.keySize=a.length;if(d!==4&&d!==6&&d!==8)throw new Error("Invalid aes key size="+d);var L,k,m,o,c=this.ksRows=4*(d+6+1),l=this.keySchedule=new Uint32Array(c),p=this.invKeySchedule=new Uint32Array(c),y=this.sBox,h=this.rcon,S=this.invSubMix,D=S[0],A=S[1],R=S[2],u=S[3];for(L=0;L<c;L++)L<d?m=l[L]=a[L]:(o=m,L%d==0?(o=y[(o=o<<8|o>>>24)>>>24]<<24|y[o>>>16&255]<<16|y[o>>>8&255]<<8|y[255&o],o^=h[L/d|0]<<24):d>6&&L%d==4&&(o=y[o>>>24]<<24|y[o>>>16&255]<<16|y[o>>>8&255]<<8|y[255&o]),l[L]=m=(l[L-d]^o)>>>0);for(k=0;k<c;k++)L=c-k,o=3&k?l[L]:l[L-4],p[k]=k<4||L<=4?o:D[y[o>>>24]]^A[y[o>>>16&255]]^R[y[o>>>8&255]]^u[y[255&o]],p[k]=p[k]>>>0}},_.networkToHostOrderSwap=function(b){return b<<24|(65280&b)<<8|(16711680&b)>>8|b>>>24},_.decrypt=function(b,a,E){for(var v,d,L,k,m,o,c,l,p,y,h,S,D,A,R=this.keySize+6,u=this.invKeySchedule,g=this.invSBox,T=this.invSubMix,C=T[0],w=T[1],I=T[2],O=T[3],x=this.uint8ArrayToUint32Array_(E),P=x[0],F=x[1],N=x[2],U=x[3],G=new Int32Array(b),V=new Int32Array(G.length),X=this.networkToHostOrderSwap;a<G.length;){for(p=X(G[a]),y=X(G[a+1]),h=X(G[a+2]),S=X(G[a+3]),m=p^u[0],o=S^u[1],c=h^u[2],l=y^u[3],D=4,A=1;A<R;A++)v=C[m>>>24]^w[o>>16&255]^I[c>>8&255]^O[255&l]^u[D],d=C[o>>>24]^w[c>>16&255]^I[l>>8&255]^O[255&m]^u[D+1],L=C[c>>>24]^w[l>>16&255]^I[m>>8&255]^O[255&o]^u[D+2],k=C[l>>>24]^w[m>>16&255]^I[o>>8&255]^O[255&c]^u[D+3],m=v,o=d,c=L,l=k,D+=4;v=g[m>>>24]<<24^g[o>>16&255]<<16^g[c>>8&255]<<8^g[255&l]^u[D],d=g[o>>>24]<<24^g[c>>16&255]<<16^g[l>>8&255]<<8^g[255&m]^u[D+1],L=g[c>>>24]<<24^g[l>>16&255]<<16^g[m>>8&255]<<8^g[255&o]^u[D+2],k=g[l>>>24]<<24^g[m>>16&255]<<16^g[o>>8&255]<<8^g[255&c]^u[D+3],V[a]=X(v^P),V[a+1]=X(k^F),V[a+2]=X(L^N),V[a+3]=X(d^U),P=p,F=y,N=h,U=S,a+=4}return V.buffer},f}()},"./src/crypt/decrypter.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return a});var i=r("./src/crypt/aes-crypto.ts"),n=r("./src/crypt/fast-aes-key.ts"),s=r("./src/crypt/aes-decryptor.ts"),f=r("./src/utils/logger.ts"),_=r("./src/utils/mp4-tools.ts"),b=r("./src/utils/typed-array.ts"),a=function(){function E(d,L,k){var m=(k===void 0?{}:k).removePKCS7Padding,o=m===void 0||m;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=d,this.config=L,this.removePKCS7Padding=o,o)try{var c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var v=E.prototype;return v.destroy=function(){this.observer=null},v.isSync=function(){return this.config.enableSoftwareAES},v.flush=function(){var d=this.currentResult;if(d){var L=new Uint8Array(d);return this.reset(),this.removePKCS7Padding?Object(s.removePadding)(L):L}this.reset()},v.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},v.decrypt=function(d,L,k,m){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(d),L,k);var o=this.flush();o&&m(o.buffer)}else this.webCryptoDecrypt(new Uint8Array(d),L,k).then(m)},v.softwareDecrypt=function(d,L,k){var m=this.currentIV,o=this.currentResult,c=this.remainderData;this.logOnce("JS AES decrypt"),c&&(d=Object(_.appendUint8Array)(c,d),this.remainderData=null);var l=this.getValidChunk(d);if(!l.length)return null;m&&(k=m);var p=this.softwareDecrypter;p||(p=this.softwareDecrypter=new s.default),p.expandKey(L);var y=o;return this.currentResult=p.decrypt(l.buffer,0,k),this.currentIV=Object(b.sliceUint8)(l,-16).buffer,y||null},v.webCryptoDecrypt=function(d,L,k){var m=this,o=this.subtle;return this.key===L&&this.fastAesKey||(this.key=L,this.fastAesKey=new n.default(o,L)),this.fastAesKey.expandKey().then(function(c){return o?new i.default(o,k).decrypt(d.buffer,c):Promise.reject(new Error("web crypto not initialized"))}).catch(function(c){return m.onWebCryptoError(c,d,L,k)})},v.onWebCryptoError=function(d,L,k,m){return f.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",d),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(L,k,m)},v.getValidChunk=function(d){var L=d,k=d.length-d.length%16;return k!==d.length&&(L=Object(b.sliceUint8)(d,0,k),this.remainderData=Object(b.sliceUint8)(d,k)),L},v.logOnce=function(d){this.logEnabled&&(f.logger.log("[decrypter.ts]: "+d),this.logEnabled=!1)},E}()},"./src/crypt/fast-aes-key.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(s,f){this.subtle=void 0,this.key=void 0,this.subtle=s,this.key=f}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}()},"./src/demux/aacdemuxer.ts":function(e,t,r){r.r(t);var i=r("./src/demux/base-audio-demuxer.ts"),n=r("./src/demux/adts.ts"),s=r("./src/utils/logger.ts"),f=r("./src/demux/id3.ts");function _(a,E){return(_=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v})(a,E)}var b=function(a){var E,v;function d(k,m){var o;return(o=a.call(this)||this).observer=void 0,o.config=void 0,o.observer=k,o.config=m,o}v=a,(E=d).prototype=Object.create(v.prototype),E.prototype.constructor=E,_(E,v);var L=d.prototype;return L.resetInitSegment=function(k,m,o){a.prototype.resetInitSegment.call(this,k,m,o),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:k,duration:o,inputTimeScale:9e4,dropped:0}},d.probe=function(k){if(!k)return!1;for(var m=(f.getID3Data(k,0)||[]).length,o=k.length;m<o;m++)if(n.probe(k,m))return s.logger.log("ADTS sync word found !"),!0;return!1},L.canParse=function(k,m){return n.canParse(k,m)},L.appendFrame=function(k,m,o){n.initTrackConfig(k,this.observer,m,o,k.manifestCodec);var c=n.appendFrame(k,m,o,this.initPTS,this.frameIndex);if(c&&c.missing===0)return c},d}(i.default);b.minProbeByteLength=9,t.default=b},"./src/demux/adts.ts":function(e,t,r){r.r(t),r.d(t,"getAudioConfig",function(){return f}),r.d(t,"isHeaderPattern",function(){return _}),r.d(t,"getHeaderLength",function(){return b}),r.d(t,"getFullFrameLength",function(){return a}),r.d(t,"canGetFrameLength",function(){return E}),r.d(t,"isHeader",function(){return v}),r.d(t,"canParse",function(){return d}),r.d(t,"probe",function(){return L}),r.d(t,"initTrackConfig",function(){return k}),r.d(t,"getFrameDuration",function(){return m}),r.d(t,"parseFrameHeader",function(){return o}),r.d(t,"appendFrame",function(){return c});var i=r("./src/utils/logger.ts"),n=r("./src/errors.ts"),s=r("./src/events.ts");function f(l,p,y,h){var S,D,A,R,u=navigator.userAgent.toLowerCase(),g=h,T=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];S=1+((192&p[y+2])>>>6);var C=(60&p[y+2])>>>2;if(!(C>T.length-1))return A=(1&p[y+2])<<2,A|=(192&p[y+3])>>>6,i.logger.log("manifest codec:"+h+", ADTS type:"+S+", samplingIndex:"+C),/firefox/i.test(u)?C>=6?(S=5,R=new Array(4),D=C-3):(S=2,R=new Array(2),D=C):u.indexOf("android")!==-1?(S=2,R=new Array(2),D=C):(S=5,R=new Array(4),h&&(h.indexOf("mp4a.40.29")!==-1||h.indexOf("mp4a.40.5")!==-1)||!h&&C>=6?D=C-3:((h&&h.indexOf("mp4a.40.2")!==-1&&(C>=6&&A===1||/vivaldi/i.test(u))||!h&&A===1)&&(S=2,R=new Array(2)),D=C)),R[0]=S<<3,R[0]|=(14&C)>>1,R[1]|=(1&C)<<7,R[1]|=A<<3,S===5&&(R[1]|=(14&D)>>1,R[2]=(1&D)<<7,R[2]|=8,R[3]=0),{config:R,samplerate:T[C],channelCount:A,codec:"mp4a.40."+S,manifestCodec:g};l.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+C})}function _(l,p){return l[p]===255&&(246&l[p+1])==240}function b(l,p){return 1&l[p+1]?7:9}function a(l,p){return(3&l[p+3])<<11|l[p+4]<<3|(224&l[p+5])>>>5}function E(l,p){return p+5<l.length}function v(l,p){return p+1<l.length&&_(l,p)}function d(l,p){return E(l,p)&&_(l,p)&&a(l,p)<=l.length-p}function L(l,p){if(v(l,p)){var y=b(l,p);if(p+y>=l.length)return!1;var h=a(l,p);if(h<=y)return!1;var S=p+h;return S===l.length||v(l,S)}return!1}function k(l,p,y,h,S){if(!l.samplerate){var D=f(p,y,h,S);if(!D)return;l.config=D.config,l.samplerate=D.samplerate,l.channelCount=D.channelCount,l.codec=D.codec,l.manifestCodec=D.manifestCodec,i.logger.log("parsed codec:"+l.codec+", rate:"+D.samplerate+", channels:"+D.channelCount)}}function m(l){return 9216e4/l}function o(l,p,y,h,S){var D=b(l,p),A=a(l,p);if((A-=D)>0)return{headerLength:D,frameLength:A,stamp:y+h*S}}function c(l,p,y,h,S){var D=o(p,y,h,S,m(l.samplerate));if(D){var A,R=D.frameLength,u=D.headerLength,g=D.stamp,T=u+R,C=Math.max(0,y+T-p.length);C?(A=new Uint8Array(T-u)).set(p.subarray(y+u,p.length),0):A=p.subarray(y+u,y+T);var w={unit:A,pts:g};return C||l.samples.push(w),{sample:w,length:T,missing:C}}}},"./src/demux/base-audio-demuxer.ts":function(e,t,r){r.r(t),r.d(t,"initPTSFn",function(){return a});var i=r("./src/polyfills/number.ts"),n=r("./src/demux/id3.ts"),s=r("./src/demux/dummy-demuxed-track.ts"),f=r("./src/utils/mp4-tools.ts"),_=r("./src/utils/typed-array.ts"),b=function(){function E(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var v=E.prototype;return v.resetInitSegment=function(d,L,k){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},v.resetTimeStamp=function(){},v.resetContiguity=function(){},v.canParse=function(d,L){return!1},v.appendFrame=function(d,L,k){},v.demux=function(d,L){this.cachedData&&(d=Object(f.appendUint8Array)(this.cachedData,d),this.cachedData=null);var k,m,o=n.getID3Data(d,0),c=o?o.length:0,l=this._audioTrack,p=this._id3Track,y=o?n.getTimeStamp(o):void 0,h=d.length;for(this.frameIndex!==0&&this.initPTS!==null||(this.initPTS=a(y,L)),o&&o.length>0&&p.samples.push({pts:this.initPTS,dts:this.initPTS,data:o}),m=this.initPTS;c<h;){if(this.canParse(d,c)){var S=this.appendFrame(l,d,c);S?(this.frameIndex++,m=S.sample.pts,k=c+=S.length):c=h}else n.canParse(d,c)?(o=n.getID3Data(d,c),p.samples.push({pts:m,dts:m,data:o}),k=c+=o.length):c++;if(c===h&&k!==h){var D=Object(_.sliceUint8)(d,k);this.cachedData?this.cachedData=Object(f.appendUint8Array)(this.cachedData,D):this.cachedData=D}}return{audioTrack:l,avcTrack:Object(s.dummyTrack)(),id3Track:p,textTrack:Object(s.dummyTrack)()}},v.demuxSampleAes=function(d,L,k){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},v.flush=function(d){var L=this.cachedData;return L&&(this.cachedData=null,this.demux(L,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(s.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(s.dummyTrack)()}},v.destroy=function(){},E}(),a=function(E,v){return Object(i.isFiniteNumber)(E)?90*E:9e4*v};t.default=b},"./src/demux/chunk-cache.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(){this.chunks=[],this.dataLength=0}var s=n.prototype;return s.push=function(f){this.chunks.push(f),this.dataLength+=f.length},s.flush=function(){var f,_=this.chunks,b=this.dataLength;return _.length?(f=_.length===1?_[0]:function(a,E){for(var v=new Uint8Array(E),d=0,L=0;L<a.length;L++){var k=a[L];v.set(k,d),d+=k.length}return v}(_,b),this.reset(),f):new Uint8Array(0)},s.reset=function(){this.chunks.length=0,this.dataLength=0},n}()},"./src/demux/dummy-demuxed-track.ts":function(e,t,r){function i(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}r.r(t),r.d(t,"dummyTrack",function(){return i})},"./src/demux/exp-golomb.ts":function(e,t,r){r.r(t);var i=r("./src/utils/logger.ts"),n=function(){function s(_){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=_,this.bytesAvailable=_.byteLength,this.word=0,this.bitsAvailable=0}var f=s.prototype;return f.loadWord=function(){var _=this.data,b=this.bytesAvailable,a=_.byteLength-b,E=new Uint8Array(4),v=Math.min(4,b);if(v===0)throw new Error("no bytes available");E.set(_.subarray(a,a+v)),this.word=new DataView(E.buffer).getUint32(0),this.bitsAvailable=8*v,this.bytesAvailable-=v},f.skipBits=function(_){var b;this.bitsAvailable>_?(this.word<<=_,this.bitsAvailable-=_):(_-=this.bitsAvailable,_-=(b=_>>3)>>3,this.bytesAvailable-=b,this.loadWord(),this.word<<=_,this.bitsAvailable-=_)},f.readBits=function(_){var b=Math.min(this.bitsAvailable,_),a=this.word>>>32-b;return _>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=b,this.bitsAvailable>0?this.word<<=b:this.bytesAvailable>0&&this.loadWord(),(b=_-b)>0&&this.bitsAvailable?a<<b|this.readBits(b):a},f.skipLZ=function(){var _;for(_=0;_<this.bitsAvailable;++_)if(this.word&2147483648>>>_)return this.word<<=_,this.bitsAvailable-=_,_;return this.loadWord(),_+this.skipLZ()},f.skipUEG=function(){this.skipBits(1+this.skipLZ())},f.skipEG=function(){this.skipBits(1+this.skipLZ())},f.readUEG=function(){var _=this.skipLZ();return this.readBits(_+1)-1},f.readEG=function(){var _=this.readUEG();return 1&_?1+_>>>1:-1*(_>>>1)},f.readBoolean=function(){return this.readBits(1)===1},f.readUByte=function(){return this.readBits(8)},f.readUShort=function(){return this.readBits(16)},f.readUInt=function(){return this.readBits(32)},f.skipScalingList=function(_){for(var b=8,a=8,E=0;E<_;E++)a!==0&&(a=(b+this.readEG()+256)%256),b=a===0?b:a},f.readSPS=function(){var _,b,a,E=0,v=0,d=0,L=0,k=this.readUByte.bind(this),m=this.readBits.bind(this),o=this.readUEG.bind(this),c=this.readBoolean.bind(this),l=this.skipBits.bind(this),p=this.skipEG.bind(this),y=this.skipUEG.bind(this),h=this.skipScalingList.bind(this);k();var S=k();if(m(5),l(3),k(),y(),S===100||S===110||S===122||S===244||S===44||S===83||S===86||S===118||S===128){var D=o();if(D===3&&l(1),y(),y(),l(1),c())for(b=D!==3?8:12,a=0;a<b;a++)c()&&h(a<6?16:64)}y();var A=o();if(A===0)o();else if(A===1)for(l(1),p(),p(),_=o(),a=0;a<_;a++)p();y(),l(1);var R=o(),u=o(),g=m(1);g===0&&l(1),l(1),c()&&(E=o(),v=o(),d=o(),L=o());var T=[1,1];if(c()&&c())switch(k()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[k()<<8|k(),k()<<8|k()]}return{width:Math.ceil(16*(R+1)-2*E-2*v),height:(2-g)*(u+1)*16-(g?2:4)*(d+L),pixelRatio:T}},f.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},s}();t.default=n},"./src/demux/id3.ts":function(e,t,r){r.r(t),r.d(t,"isHeader",function(){return n}),r.d(t,"isFooter",function(){return s}),r.d(t,"getID3Data",function(){return f}),r.d(t,"canParse",function(){return b}),r.d(t,"getTimeStamp",function(){return a}),r.d(t,"isTimeStampFrame",function(){return E}),r.d(t,"getID3Frames",function(){return d}),r.d(t,"decodeFrame",function(){return L}),r.d(t,"utf8ArrayToStr",function(){return l}),r.d(t,"testables",function(){return p});var i,n=function(y,h){return h+10<=y.length&&y[h]===73&&y[h+1]===68&&y[h+2]===51&&y[h+3]<255&&y[h+4]<255&&y[h+6]<128&&y[h+7]<128&&y[h+8]<128&&y[h+9]<128},s=function(y,h){return h+10<=y.length&&y[h]===51&&y[h+1]===68&&y[h+2]===73&&y[h+3]<255&&y[h+4]<255&&y[h+6]<128&&y[h+7]<128&&y[h+8]<128&&y[h+9]<128},f=function(y,h){for(var S=h,D=0;n(y,h);)D+=10,D+=_(y,h+6),s(y,h+10)&&(D+=10),h+=D;if(D>0)return y.subarray(S,S+D)},_=function(y,h){var S=0;return S=(127&y[h])<<21,S|=(127&y[h+1])<<14,S|=(127&y[h+2])<<7,S|=127&y[h+3]},b=function(y,h){return n(y,h)&&_(y,h+6)+10<=y.length-h},a=function(y){for(var h=d(y),S=0;S<h.length;S++){var D=h[S];if(E(D))return c(D)}},E=function(y){return y&&y.key==="PRIV"&&y.info==="com.apple.streaming.transportStreamTimestamp"},v=function(y){var h=String.fromCharCode(y[0],y[1],y[2],y[3]),S=_(y,4);return{type:h,size:S,data:y.subarray(10,10+S)}},d=function(y){for(var h=0,S=[];n(y,h);){for(var D=_(y,h+6),A=(h+=10)+D;h+8<A;){var R=v(y.subarray(h)),u=L(R);u&&S.push(u),h+=R.size+10}s(y,h)&&(h+=10)}return S},L=function(y){return y.type==="PRIV"?k(y):y.type[0]==="W"?o(y):m(y)},k=function(y){if(!(y.size<2)){var h=l(y.data,!0),S=new Uint8Array(y.data.subarray(h.length+1));return{key:y.type,info:h,data:S.buffer}}},m=function(y){if(!(y.size<2)){if(y.type==="TXXX"){var h=1,S=l(y.data.subarray(h),!0);h+=S.length+1;var D=l(y.data.subarray(h));return{key:y.type,info:S,data:D}}var A=l(y.data.subarray(1));return{key:y.type,data:A}}},o=function(y){if(y.type==="WXXX"){if(y.size<2)return;var h=1,S=l(y.data.subarray(h),!0);h+=S.length+1;var D=l(y.data.subarray(h));return{key:y.type,info:S,data:D}}var A=l(y.data);return{key:y.type,data:A}},c=function(y){if(y.data.byteLength===8){var h=new Uint8Array(y.data),S=1&h[3],D=(h[4]<<23)+(h[5]<<15)+(h[6]<<7)+h[7];return D/=45,S&&(D+=4772185884e-2),Math.round(D)}},l=function(y,h){h===void 0&&(h=!1);var S=(i||self.TextDecoder===void 0||(i=new self.TextDecoder("utf-8")),i);if(S){var D=S.decode(y);if(h){var A=D.indexOf("\0");return A!==-1?D.substring(0,A):D}return D.replace(/\0/g,"")}for(var R,u,g,T=y.length,C="",w=0;w<T;){if((R=y[w++])===0&&h)return C;if(R!==0&&R!==3)switch(R>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:C+=String.fromCharCode(R);break;case 12:case 13:u=y[w++],C+=String.fromCharCode((31&R)<<6|63&u);break;case 14:u=y[w++],g=y[w++],C+=String.fromCharCode((15&R)<<12|(63&u)<<6|(63&g)<<0)}}return C},p={decodeTextFrame:m}},"./src/demux/mp3demuxer.ts":function(e,t,r){r.r(t);var i=r("./src/demux/base-audio-demuxer.ts"),n=r("./src/demux/id3.ts"),s=r("./src/utils/logger.ts"),f=r("./src/demux/mpegaudio.ts");function _(a,E){return(_=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v})(a,E)}var b=function(a){var E,v;function d(){return a.apply(this,arguments)||this}v=a,(E=d).prototype=Object.create(v.prototype),E.prototype.constructor=E,_(E,v);var L=d.prototype;return L.resetInitSegment=function(k,m,o){a.prototype.resetInitSegment.call(this,k,m,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:k,duration:o,inputTimeScale:9e4,dropped:0}},d.probe=function(k){if(!k)return!1;for(var m=(n.getID3Data(k,0)||[]).length,o=k.length;m<o;m++)if(f.probe(k,m))return s.logger.log("MPEG Audio sync word found !"),!0;return!1},L.canParse=function(k,m){return f.canParse(k,m)},L.appendFrame=function(k,m,o){if(this.initPTS!==null)return f.appendFrame(k,m,o,this.initPTS,this.frameIndex)},d}(i.default);b.minProbeByteLength=4,t.default=b},"./src/demux/mp4demuxer.ts":function(e,t,r){r.r(t);var i=r("./src/utils/mp4-tools.ts"),n=r("./src/demux/dummy-demuxed-track.ts"),s=function(){function f(b,a){this.remainderData=null,this.config=void 0,this.config=a}var _=f.prototype;return _.resetTimeStamp=function(){},_.resetInitSegment=function(){},_.resetContiguity=function(){},f.probe=function(b){return Object(i.findBox)({data:b,start:0,end:Math.min(b.length,16384)},["moof"]).length>0},_.demux=function(b){var a=b,E=Object(n.dummyTrack)();if(this.config.progressive){this.remainderData&&(a=Object(i.appendUint8Array)(this.remainderData,b));var v=Object(i.segmentValidRange)(a);this.remainderData=v.remainder,E.samples=v.valid||new Uint8Array}else E.samples=a;return{audioTrack:Object(n.dummyTrack)(),avcTrack:E,id3Track:Object(n.dummyTrack)(),textTrack:Object(n.dummyTrack)()}},_.flush=function(){var b=Object(n.dummyTrack)();return b.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(n.dummyTrack)(),avcTrack:b,id3Track:Object(n.dummyTrack)(),textTrack:Object(n.dummyTrack)()}},_.demuxSampleAes=function(b,a,E){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},_.destroy=function(){},f}();s.minProbeByteLength=1024,t.default=s},"./src/demux/mpegaudio.ts":function(e,t,r){r.r(t),r.d(t,"appendFrame",function(){return b}),r.d(t,"parseHeader",function(){return a}),r.d(t,"isHeaderPattern",function(){return E}),r.d(t,"isHeader",function(){return v}),r.d(t,"canParse",function(){return d}),r.d(t,"probe",function(){return L});var i=null,n=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],s=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],f=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],_=[0,1,1,4];function b(k,m,o,c,l){if(!(o+24>m.length)){var p=a(m,o);if(p&&o+p.frameLength<=m.length){var y=c+l*(9e4*p.samplesPerFrame/p.sampleRate),h={unit:m.subarray(o,o+p.frameLength),pts:y,dts:y};return k.config=[],k.channelCount=p.channelCount,k.samplerate=p.sampleRate,k.samples.push(h),{sample:h,length:p.frameLength,missing:0}}}}function a(k,m){var o=k[m+1]>>3&3,c=k[m+1]>>1&3,l=k[m+2]>>4&15,p=k[m+2]>>2&3;if(o!==1&&l!==0&&l!==15&&p!==3){var y=k[m+2]>>1&1,h=k[m+3]>>6,S=1e3*n[14*(o===3?3-c:c===3?3:4)+l-1],D=s[3*(o===3?0:o===2?1:2)+p],A=h===3?1:2,R=f[o][c],u=_[c],g=8*R*u,T=Math.floor(R*S/D+y)*u;if(i===null){var C=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);i=C?parseInt(C[1]):0}return i&&i<=87&&c===2&&S>=224e3&&h===0&&(k[m+3]=128|k[m+3]),{sampleRate:D,channelCount:A,frameLength:T,samplesPerFrame:g}}}function E(k,m){return k[m]===255&&(224&k[m+1])==224&&(6&k[m+1])!=0}function v(k,m){return m+1<k.length&&E(k,m)}function d(k,m){return E(k,m)&&4<=k.length-m}function L(k,m){if(m+1<k.length&&E(k,m)){var o=a(k,m),c=4;o!=null&&o.frameLength&&(c=o.frameLength);var l=m+c;return l===k.length||v(k,l)}return!1}},"./src/demux/sample-aes.ts":function(e,t,r){r.r(t);var i=r("./src/crypt/decrypter.ts"),n=r("./src/demux/tsdemuxer.ts"),s=function(){function f(b,a,E){this.keyData=void 0,this.decrypter=void 0,this.keyData=E,this.decrypter=new i.default(b,a,{removePKCS7Padding:!1})}var _=f.prototype;return _.decryptBuffer=function(b,a){this.decrypter.decrypt(b,this.keyData.key.buffer,this.keyData.iv.buffer,a)},_.decryptAacSample=function(b,a,E,v){var d=b[a].unit,L=d.subarray(16,d.length-d.length%16),k=L.buffer.slice(L.byteOffset,L.byteOffset+L.length),m=this;this.decryptBuffer(k,function(o){var c=new Uint8Array(o);d.set(c,16),v||m.decryptAacSamples(b,a+1,E)})},_.decryptAacSamples=function(b,a,E){for(;;a++){if(a>=b.length)return void E();if(!(b[a].unit.length<32)){var v=this.decrypter.isSync();if(this.decryptAacSample(b,a,E,v),!v)return}}},_.getAvcEncryptedData=function(b){for(var a=16*Math.floor((b.length-48)/160)+16,E=new Int8Array(a),v=0,d=32;d<=b.length-16;d+=160,v+=16)E.set(b.subarray(d,d+16),v);return E},_.getAvcDecryptedUnit=function(b,a){for(var E=new Uint8Array(a),v=0,d=32;d<=b.length-16;d+=160,v+=16)b.set(E.subarray(v,v+16),d);return b},_.decryptAvcSample=function(b,a,E,v,d,L){var k=Object(n.discardEPB)(d.data),m=this.getAvcEncryptedData(k),o=this;this.decryptBuffer(m.buffer,function(c){d.data=o.getAvcDecryptedUnit(k,c),L||o.decryptAvcSamples(b,a,E+1,v)})},_.decryptAvcSamples=function(b,a,E,v){if(b instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;a++,E=0){if(a>=b.length)return void v();for(var d=b[a].units;!(E>=d.length);E++){var L=d[E];if(!(L.data.length<=48||L.type!==1&&L.type!==5)){var k=this.decrypter.isSync();if(this.decryptAvcSample(b,a,E,v,L,k),!k)return}}}},f}();t.default=s},"./src/demux/transmuxer-interface.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return v});var i=r("./node_modules/webworkify-webpack/index.js"),n=r("./src/events.ts"),s=r("./src/demux/transmuxer.ts"),f=r("./src/utils/logger.ts"),_=r("./src/errors.ts"),b=r("./src/utils/mediasource-helper.ts"),a=r("./node_modules/eventemitter3/index.js"),E=Object(b.getMediaSource)()||{isTypeSupported:function(){return!1}},v=function(){function d(k,m,o,c){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=k,this.id=m,this.onTransmuxComplete=o,this.onFlush=c;var p=k.config,y=function(A,R){(R=R||{}).frag=l.frag,R.id=l.id,k.trigger(A,R)};this.observer=new a.EventEmitter,this.observer.on(n.Events.FRAG_DECRYPTED,y),this.observer.on(n.Events.ERROR,y);var h={mp4:E.isTypeSupported("video/mp4"),mpeg:E.isTypeSupported("audio/mpeg"),mp3:E.isTypeSupported('audio/mp4; codecs="mp3"')},S=navigator.vendor;if(p.enableWorker&&typeof Worker<"u"){var D;f.logger.log("demuxing in webworker");try{D=this.worker=i("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),D.addEventListener("message",this.onwmsg),D.onerror=function(A){k.trigger(n.Events.ERROR,{type:_.ErrorTypes.OTHER_ERROR,details:_.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(A.message+"  ("+A.filename+":"+A.lineno+")")})},D.postMessage({cmd:"init",typeSupported:h,vendor:S,id:m,config:JSON.stringify(p)})}catch(A){f.logger.warn("Error in worker:",A),f.logger.error("Error while initializing DemuxerWorker, fallback to inline"),D&&self.URL.revokeObjectURL(D.objectURL),this.transmuxer=new s.default(this.observer,h,p,S,m),this.worker=null}}else this.transmuxer=new s.default(this.observer,h,p,S,m)}var L=d.prototype;return L.destroy=function(){var k=this.worker;if(k)k.removeEventListener("message",this.onwmsg),k.terminate(),this.worker=null;else{var m=this.transmuxer;m&&(m.destroy(),this.transmuxer=null)}var o=this.observer;o&&o.removeAllListeners(),this.observer=null},L.push=function(k,m,o,c,l,p,y,h,S,D){var A=this;S.transmuxing.start=self.performance.now();var R=this.transmuxer,u=this.worker,g=p?p.start:l.start,T=l.decryptdata,C=this.frag,w=!(C&&l.cc===C.cc),I=!(C&&S.level===C.level),O=C?S.sn-C.sn:-1,x=this.part?S.part-this.part.index:1,P=!I&&(O===1||O===0&&x===1),F=self.performance.now();(I||O||l.stats.parsing.start===0)&&(l.stats.parsing.start=F),!p||!x&&P||(p.stats.parsing.start=F);var N=new s.TransmuxState(w,P,h,I,g);if(!P||w){f.logger.log("[transmuxer-interface, "+l.type+"]: Starting new transmux session for sn: "+S.sn+" p: "+S.part+" level: "+S.level+" id: "+S.id+`
        discontinuity: `+w+`
        trackSwitch: `+I+`
        contiguous: `+P+`
        accurateTimeOffset: `+h+`
        timeOffset: `+g);var U=new s.TransmuxConfig(o,c,m,y,D);this.configureTransmuxer(U)}if(this.frag=l,this.part=p,u)u.postMessage({cmd:"demux",data:k,decryptdata:T,chunkMeta:S,state:N},k instanceof ArrayBuffer?[k]:[]);else if(R){var G=R.push(k,T,S,N);Object(s.isPromise)(G)?G.then(function(V){A.handleTransmuxComplete(V)}):this.handleTransmuxComplete(G)}},L.flush=function(k){var m=this;k.transmuxing.start=self.performance.now();var o=this.transmuxer,c=this.worker;if(c)c.postMessage({cmd:"flush",chunkMeta:k});else if(o){var l=o.flush(k);Object(s.isPromise)(l)?l.then(function(p){m.handleFlushResult(p,k)}):this.handleFlushResult(l,k)}},L.handleFlushResult=function(k,m){var o=this;k.forEach(function(c){o.handleTransmuxComplete(c)}),this.onFlush(m)},L.onWorkerMessage=function(k){var m=k.data,o=this.hls;switch(m.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(m.data);break;case"flush":this.onFlush(m.data);break;default:m.data=m.data||{},m.data.frag=this.frag,m.data.id=this.id,o.trigger(m.event,m.data)}},L.configureTransmuxer=function(k){var m=this.worker,o=this.transmuxer;m?m.postMessage({cmd:"configure",config:k}):o&&o.configure(k)},L.handleTransmuxComplete=function(k){k.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(k)},d}()},"./src/demux/transmuxer-worker.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return _});var i=r("./src/demux/transmuxer.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts"),f=r("./node_modules/eventemitter3/index.js");function _(v){var d=new f.EventEmitter,L=function(k,m){v.postMessage({event:k,data:m})};d.on(n.Events.FRAG_DECRYPTED,L),d.on(n.Events.ERROR,L),v.addEventListener("message",function(k){var m=k.data;switch(m.cmd){case"init":var o=JSON.parse(m.config);v.transmuxer=new i.default(d,m.typeSupported,o,m.vendor,m.id),Object(s.enableLogs)(o.debug),L("init",null);break;case"configure":v.transmuxer.configure(m.config);break;case"demux":var c=v.transmuxer.push(m.data,m.decryptdata,m.chunkMeta,m.state);Object(i.isPromise)(c)?c.then(function(y){b(v,y)}):b(v,c);break;case"flush":var l=m.chunkMeta,p=v.transmuxer.flush(l);Object(i.isPromise)(p)?p.then(function(y){E(v,y,l)}):E(v,p,l)}})}function b(v,d){if((L=d.remuxResult).audio||L.video||L.text||L.id3||L.initSegment){var L,k=[],m=d.remuxResult,o=m.audio,c=m.video;o&&a(k,o),c&&a(k,c),v.postMessage({event:"transmuxComplete",data:d},k)}}function a(v,d){d.data1&&v.push(d.data1.buffer),d.data2&&v.push(d.data2.buffer)}function E(v,d,L){d.forEach(function(k){b(v,k)}),v.postMessage({event:"flush",data:L})}},"./src/demux/transmuxer.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l}),r.d(t,"isPromise",function(){return y}),r.d(t,"TransmuxConfig",function(){return h}),r.d(t,"TransmuxState",function(){return S});var i,n=r("./src/events.ts"),s=r("./src/errors.ts"),f=r("./src/crypt/decrypter.ts"),_=r("./src/demux/aacdemuxer.ts"),b=r("./src/demux/mp4demuxer.ts"),a=r("./src/demux/tsdemuxer.ts"),E=r("./src/demux/mp3demuxer.ts"),v=r("./src/remux/mp4-remuxer.ts"),d=r("./src/remux/passthrough-remuxer.ts"),L=r("./src/demux/chunk-cache.ts"),k=r("./src/utils/mp4-tools.ts"),m=r("./src/utils/logger.ts");try{i=self.performance.now.bind(self.performance)}catch{m.logger.debug("Unable to use Performance API on this environment"),i=self.Date.now}var o=[{demux:a.default,remux:v.default},{demux:b.default,remux:d.default},{demux:_.default,remux:v.default},{demux:E.default,remux:v.default}],c=1024;o.forEach(function(D){var A=D.demux;c=Math.max(c,A.minProbeByteLength)});var l=function(){function D(R,u,g,T,C){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new L.default,this.observer=R,this.typeSupported=u,this.config=g,this.vendor=T,this.id=C}var A=D.prototype;return A.configure=function(R){this.transmuxConfig=R,this.decrypter&&this.decrypter.reset()},A.push=function(R,u,g,T){var C=this,w=g.transmuxing;w.executeStart=i();var I=new Uint8Array(R),O=this.cache,x=this.config,P=this.currentTransmuxState,F=this.transmuxConfig;T&&(this.currentTransmuxState=T);var N=function(J,ee){var Z=null;return J.byteLength>0&&ee!=null&&ee.key!=null&&ee.iv!==null&&ee.method!=null&&(Z=ee),Z}(I,u);if(N&&N.method==="AES-128"){var U=this.getDecrypter();if(!x.enableSoftwareAES)return this.decryptionPromise=U.webCryptoDecrypt(I,N.key.buffer,N.iv.buffer).then(function(J){var ee=C.push(J,null,g);return C.decryptionPromise=null,ee}),this.decryptionPromise;var G=U.softwareDecrypt(I,N.key.buffer,N.iv.buffer);if(!G)return w.executeEnd=i(),p(g);I=new Uint8Array(G)}var V=T||P,X=V.contiguous,j=V.discontinuity,z=V.trackSwitch,W=V.accurateTimeOffset,$=V.timeOffset,ne=F.audioCodec,le=F.videoCodec,ae=F.defaultInitPts,M=F.duration,B=F.initSegmentData;if((j||z)&&this.resetInitSegment(B,ne,le,M),j&&this.resetInitialTimestamp(ae),X||this.resetContiguity(),this.needsProbing(I,j,z)){if(O.dataLength){var K=O.flush();I=Object(k.appendUint8Array)(K,I)}this.configureTransmuxer(I,F)}var H=this.transmux(I,N,$,W,g),q=this.currentTransmuxState;return q.contiguous=!0,q.discontinuity=!1,q.trackSwitch=!1,w.executeEnd=i(),H},A.flush=function(R){var u=this,g=R.transmuxing;g.executeStart=i();var T=this.decrypter,C=this.cache,w=this.currentTransmuxState,I=this.decryptionPromise;if(I)return I.then(function(){return u.flush(R)});var O=[],x=w.timeOffset;if(T){var P=T.flush();P&&O.push(this.push(P,null,R))}var F=C.dataLength;C.reset();var N=this.demuxer,U=this.remuxer;if(!N||!U)return F>=c&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),g.executeEnd=i(),[p(R)];var G=N.flush(x);return y(G)?G.then(function(V){return u.flushRemux(O,V,R),O}):(this.flushRemux(O,G,R),O)},A.flushRemux=function(R,u,g){var T=u.audioTrack,C=u.avcTrack,w=u.id3Track,I=u.textTrack,O=this.currentTransmuxState,x=O.accurateTimeOffset,P=O.timeOffset;m.logger.log("[transmuxer.ts]: Flushed fragment "+g.sn+(g.part>-1?" p: "+g.part:"")+" of level "+g.level);var F=this.remuxer.remux(T,C,w,I,P,x,!0,this.id);R.push({remuxResult:F,chunkMeta:g}),g.transmuxing.executeEnd=i()},A.resetInitialTimestamp=function(R){var u=this.demuxer,g=this.remuxer;u&&g&&(u.resetTimeStamp(R),g.resetTimeStamp(R))},A.resetContiguity=function(){var R=this.demuxer,u=this.remuxer;R&&u&&(R.resetContiguity(),u.resetNextTimestamp())},A.resetInitSegment=function(R,u,g,T){var C=this.demuxer,w=this.remuxer;C&&w&&(C.resetInitSegment(u,g,T),w.resetInitSegment(R,u,g))},A.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},A.transmux=function(R,u,g,T,C){return u&&u.method==="SAMPLE-AES"?this.transmuxSampleAes(R,u,g,T,C):this.transmuxUnencrypted(R,g,T,C)},A.transmuxUnencrypted=function(R,u,g,T){var C=this.demuxer.demux(R,u,!1,!this.config.progressive),w=C.audioTrack,I=C.avcTrack,O=C.id3Track,x=C.textTrack;return{remuxResult:this.remuxer.remux(w,I,O,x,u,g,!1,this.id),chunkMeta:T}},A.transmuxSampleAes=function(R,u,g,T,C){var w=this;return this.demuxer.demuxSampleAes(R,u,g).then(function(I){return{remuxResult:w.remuxer.remux(I.audioTrack,I.avcTrack,I.id3Track,I.textTrack,g,T,!1,w.id),chunkMeta:C}})},A.configureTransmuxer=function(R,u){for(var g,T=this.config,C=this.observer,w=this.typeSupported,I=this.vendor,O=u.audioCodec,x=u.defaultInitPts,P=u.duration,F=u.initSegmentData,N=u.videoCodec,U=0,G=o.length;U<G;U++)if(o[U].demux.probe(R)){g=o[U];break}g||(m.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),g={demux:b.default,remux:d.default});var V=this.demuxer,X=this.remuxer,j=g.remux,z=g.demux;X&&X instanceof j||(this.remuxer=new j(C,T,w,I)),V&&V instanceof z||(this.demuxer=new z(C,T,w),this.probe=z.probe),this.resetInitSegment(F,O,N,P),this.resetInitialTimestamp(x)},A.needsProbing=function(R,u,g){return!this.demuxer||!this.remuxer||u||g},A.getDecrypter=function(){var R=this.decrypter;return R||(R=this.decrypter=new f.default(this.observer,this.config)),R},D}(),p=function(D){return{remuxResult:{},chunkMeta:D}};function y(D){return"then"in D&&D.then instanceof Function}var h=function(D,A,R,u,g){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=D,this.videoCodec=A,this.initSegmentData=R,this.duration=u,this.defaultInitPts=g},S=function(D,A,R,u,g){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=D,this.contiguous=A,this.accurateTimeOffset=R,this.trackSwitch=u,this.timeOffset=g}},"./src/demux/tsdemuxer.ts":function(e,t,r){r.r(t),r.d(t,"discardEPB",function(){return y});var i=r("./src/demux/adts.ts"),n=r("./src/demux/mpegaudio.ts"),s=r("./src/demux/exp-golomb.ts"),f=r("./src/demux/id3.ts"),_=r("./src/demux/sample-aes.ts"),b=r("./src/events.ts"),a=r("./src/utils/mp4-tools.ts"),E=r("./src/utils/logger.ts"),v=r("./src/errors.ts"),d={video:1,audio:2,id3:3,text:4},L=function(){function h(D,A,R){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=D,this.config=A,this.typeSupported=R}h.probe=function(D){var A=h.syncOffset(D);return!(A<0||(A&&E.logger.warn("MPEG2-TS detected but first sync word found @ offset "+A+", junk ahead ?"),0))},h.syncOffset=function(D){for(var A=Math.min(1e3,D.length-564),R=0;R<A;){if(D[R]===71&&D[R+188]===71&&D[R+376]===71)return R;R++}return-1},h.createTrack=function(D,A){return{container:D==="video"||D==="audio"?"video/mp2t":void 0,type:D,id:d[D],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:D==="audio"?A:void 0}};var S=h.prototype;return S.resetInitSegment=function(D,A,R){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=h.createTrack("video",R),this._audioTrack=h.createTrack("audio",R),this._id3Track=h.createTrack("id3",R),this._txtTrack=h.createTrack("text",R),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=D,this.videoCodec=A,this._duration=R},S.resetTimeStamp=function(){},S.resetContiguity=function(){var D=this._audioTrack,A=this._avcTrack,R=this._id3Track;D&&(D.pesData=null),A&&(A.pesData=null),R&&(R.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},S.demux=function(D,A,R,u){var g;R===void 0&&(R=!1),u===void 0&&(u=!1),R||(this.sampleAes=null);var T=this._avcTrack,C=this._audioTrack,w=this._id3Track,I=T.pid,O=T.pesData,x=C.pid,P=w.pid,F=C.pesData,N=w.pesData,U=!1,G=this.pmtParsed,V=this._pmtId,X=D.length;if(this.remainderData&&(X=(D=Object(a.appendUint8Array)(this.remainderData,D)).length,this.remainderData=null),X<188&&!u)return this.remainderData=D,{audioTrack:C,avcTrack:T,id3Track:w,textTrack:this._txtTrack};var j=Math.max(0,h.syncOffset(D));(X-=(X+j)%188)<D.byteLength&&!u&&(this.remainderData=new Uint8Array(D.buffer,X,D.buffer.byteLength-X));for(var z=j;z<X;z+=188)if(D[z]===71){var W=!!(64&D[z+1]),$=((31&D[z+1])<<8)+D[z+2],ne=void 0;if((48&D[z+3])>>4>1){if((ne=z+5+D[z+4])===z+188)continue}else ne=z+4;switch($){case I:W&&(O&&(g=c(O))&&this.parseAVCPES(g,!1),O={data:[],size:0}),O&&(O.data.push(D.subarray(ne,z+188)),O.size+=z+188-ne);break;case x:W&&(F&&(g=c(F))&&(C.isAAC?this.parseAACPES(g):this.parseMPEGPES(g)),F={data:[],size:0}),F&&(F.data.push(D.subarray(ne,z+188)),F.size+=z+188-ne);break;case P:W&&(N&&(g=c(N))&&this.parseID3PES(g),N={data:[],size:0}),N&&(N.data.push(D.subarray(ne,z+188)),N.size+=z+188-ne);break;case 0:W&&(ne+=D[ne]+1),V=this._pmtId=m(D,ne);break;case V:W&&(ne+=D[ne]+1);var le=o(D,ne,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,R);(I=le.avc)>0&&(T.pid=I),(x=le.audio)>0&&(C.pid=x,C.isAAC=le.isAAC),(P=le.id3)>0&&(w.pid=P),U&&!G&&(E.logger.log("reparse from beginning"),U=!1,z=j-188),G=this.pmtParsed=!0;break;case 17:case 8191:break;default:U=!0}}else this.observer.emit(b.Events.ERROR,b.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});T.pesData=O,C.pesData=F,w.pesData=N;var ae={audioTrack:C,avcTrack:T,id3Track:w,textTrack:this._txtTrack};return u&&this.extractRemainingSamples(ae),ae},S.flush=function(){var D,A=this.remainderData;return this.remainderData=null,D=A?this.demux(A,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},S.extractRemainingSamples=function(D){var A,R=D.audioTrack,u=D.avcTrack,g=D.id3Track,T=u.pesData,C=R.pesData,w=g.pesData;T&&(A=c(T))?(this.parseAVCPES(A,!0),u.pesData=null):u.pesData=T,C&&(A=c(C))?(R.isAAC?this.parseAACPES(A):this.parseMPEGPES(A),R.pesData=null):(C!=null&&C.size&&E.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=C),w&&(A=c(w))?(this.parseID3PES(A),g.pesData=null):g.pesData=w},S.demuxSampleAes=function(D,A,R){var u=this.demux(D,R,!0,!this.config.progressive),g=this.sampleAes=new _.default(this.observer,this.config,A);return this.decrypt(u,g)},S.decrypt=function(D,A){return new Promise(function(R){var u=D.audioTrack,g=D.avcTrack;u.samples&&u.isAAC?A.decryptAacSamples(u.samples,0,function(){g.samples?A.decryptAvcSamples(g.samples,0,0,function(){R(D)}):R(D)}):g.samples&&A.decryptAvcSamples(g.samples,0,0,function(){R(D)})})},S.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},S.parseAVCPES=function(D,A){var R,u=this,g=this._avcTrack,T=this.parseAVCNALu(D.data),C=this.avcSample,w=!1;D.data=null,C&&T.length&&!g.audFound&&(l(C,g),C=this.avcSample=k(!1,D.pts,D.dts,"")),T.forEach(function(I){switch(I.type){case 1:R=!0,C||(C=u.avcSample=k(!0,D.pts,D.dts,"")),C.frame=!0;var O=I.data;if(w&&O.length>4){var x=new s.default(O).readSliceType();x!==2&&x!==4&&x!==7&&x!==9||(C.key=!0)}break;case 5:R=!0,C||(C=u.avcSample=k(!0,D.pts,D.dts,"")),C.key=!0,C.frame=!0;break;case 6:R=!0;var P=new s.default(y(I.data));P.readUByte();for(var F=0,N=0,U=!1,G=0;!U&&P.bytesAvailable>1;){F=0;do F+=G=P.readUByte();while(G===255);N=0;do N+=G=P.readUByte();while(G===255);if(F===4&&P.bytesAvailable!==0){if(U=!0,P.readUByte()===181&&P.readUShort()===49&&P.readUInt()===1195456820&&P.readUByte()===3){for(var V=P.readUByte(),X=31&V,j=[V,P.readUByte()],z=0;z<X;z++)j.push(P.readUByte()),j.push(P.readUByte()),j.push(P.readUByte());p(u._txtTrack.samples,{type:3,pts:D.pts,bytes:j})}}else if(F===5&&P.bytesAvailable!==0){if(U=!0,N>16){for(var W=[],$=0;$<16;$++)W.push(P.readUByte().toString(16)),$!==3&&$!==5&&$!==7&&$!==9||W.push("-");for(var ne=N-16,le=new Uint8Array(ne),ae=0;ae<ne;ae++)le[ae]=P.readUByte();p(u._txtTrack.samples,{pts:D.pts,payloadType:F,uuid:W.join(""),userData:Object(f.utf8ArrayToStr)(le),userDataBytes:le})}}else if(N<P.bytesAvailable)for(var M=0;M<N;M++)P.readUByte()}break;case 7:if(R=!0,w=!0,!g.sps){var B=new s.default(I.data).readSPS();g.width=B.width,g.height=B.height,g.pixelRatio=B.pixelRatio,g.sps=[I.data],g.duration=u._duration;for(var K=I.data.subarray(1,4),H="avc1.",q=0;q<3;q++){var J=K[q].toString(16);J.length<2&&(J="0"+J),H+=J}g.codec=H}break;case 8:R=!0,g.pps||(g.pps=[I.data]);break;case 9:R=!1,g.audFound=!0,C&&l(C,g),C=u.avcSample=k(!1,D.pts,D.dts,"");break;case 12:R=!1;break;default:R=!1,C&&(C.debug+="unknown NAL "+I.type+" ")}C&&R&&C.units.push(I)}),A&&C&&(l(C,g),this.avcSample=null)},S.getLastNalUnit=function(){var D,A,R=this.avcSample;if(!R||R.units.length===0){var u=this._avcTrack.samples;R=u[u.length-1]}if((D=R)!==null&&D!==void 0&&D.units){var g=R.units;A=g[g.length-1]}return A},S.parseAVCNALu=function(D){var A,R,u=D.byteLength,g=this._avcTrack,T=g.naluState||0,C=T,w=[],I=0,O=-1,x=0;for(T===-1&&(O=0,x=31&D[0],T=0,I=1);I<u;)if(A=D[I++],T)if(T!==1)if(A)if(A===1){if(O>=0){var P={data:D.subarray(O,I-T-1),type:x};w.push(P)}else{var F=this.getLastNalUnit();if(F&&(C&&I<=4-C&&F.state&&(F.data=F.data.subarray(0,F.data.byteLength-C)),(R=I-T-1)>0)){var N=new Uint8Array(F.data.byteLength+R);N.set(F.data,0),N.set(D.subarray(0,R),F.data.byteLength),F.data=N}}I<u?(O=I,x=31&D[I],T=0):T=-1}else T=0;else T=3;else T=A?0:2;else T=A?0:1;if(O>=0&&T>=0){var U={data:D.subarray(O,u),type:x,state:T};w.push(U)}if(w.length===0){var G=this.getLastNalUnit();if(G){var V=new Uint8Array(G.data.byteLength+D.byteLength);V.set(G.data,0),V.set(D,G.data.byteLength),G.data=V}}return g.naluState=T,w},S.parseAACPES=function(D){var A,R,u,g,T,C=0,w=this._audioTrack,I=this.aacOverFlow,O=D.data;if(I){this.aacOverFlow=null;var x=I.sample.unit.byteLength,P=Math.min(I.missing,x),F=x-P;I.sample.unit.set(O.subarray(0,P),F),w.samples.push(I.sample),C=I.missing}for(A=C,R=O.length;A<R-1&&!i.isHeader(O,A);A++);if(A===C||(A<R-1?(u="AAC PES did not start with ADTS header,offset:"+A,g=!1):(u="no ADTS header found in AAC PES",g=!0),E.logger.warn("parsing error:"+u),this.observer.emit(b.Events.ERROR,b.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:g,reason:u}),!g)){if(i.initTrackConfig(w,this.observer,O,A,this.audioCodec),D.pts!==void 0)T=D.pts;else{if(!I)return void E.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var N=i.getFrameDuration(w.samplerate);T=I.sample.pts+N}for(var U=0;A<R;){if(i.isHeader(O,A)){if(A+5<R){var G=i.appendFrame(w,O,A,T,U);if(G){if(!G.missing){A+=G.length,U++;continue}this.aacOverFlow=G}}break}A++}}},S.parseMPEGPES=function(D){var A=D.data,R=A.length,u=0,g=0,T=D.pts;if(T!==void 0)for(;g<R;)if(n.isHeader(A,g)){var C=n.appendFrame(this._audioTrack,A,g,T,u);if(!C)break;g+=C.length,u++}else g++;else E.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},S.parseID3PES=function(D){D.pts!==void 0?this._id3Track.samples.push(D):E.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},h}();function k(h,S,D,A){return{key:h,frame:!1,pts:S,dts:D,units:[],debug:A,length:0}}function m(h,S){return(31&h[S+10])<<8|h[S+11]}function o(h,S,D,A){var R={audio:-1,avc:-1,id3:-1,isAAC:!0},u=S+3+((15&h[S+1])<<8|h[S+2])-4;for(S+=12+((15&h[S+10])<<8|h[S+11]);S<u;){var g=(31&h[S+1])<<8|h[S+2];switch(h[S]){case 207:if(!A){E.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:R.audio===-1&&(R.audio=g);break;case 21:R.id3===-1&&(R.id3=g);break;case 219:if(!A){E.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:R.avc===-1&&(R.avc=g);break;case 3:case 4:D?R.audio===-1&&(R.audio=g,R.isAAC=!1):E.logger.log("MPEG audio found, not supported in this browser");break;case 36:E.logger.warn("Unsupported HEVC stream type found")}S+=5+((15&h[S+3])<<8|h[S+4])}return R}function c(h){var S,D,A,R,u,g=0,T=h.data;if(!h||h.size===0)return null;for(;T[0].length<19&&T.length>1;){var C=new Uint8Array(T[0].length+T[1].length);C.set(T[0]),C.set(T[1],T[0].length),T[0]=C,T.splice(1,1)}if(((S=T[0])[0]<<16)+(S[1]<<8)+S[2]===1){if((D=(S[4]<<8)+S[5])&&D>h.size-6)return null;var w=S[7];192&w&&(R=536870912*(14&S[9])+4194304*(255&S[10])+16384*(254&S[11])+128*(255&S[12])+(254&S[13])/2,64&w?R-(u=536870912*(14&S[14])+4194304*(255&S[15])+16384*(254&S[16])+128*(255&S[17])+(254&S[18])/2)>54e5&&(E.logger.warn(Math.round((R-u)/9e4)+"s delta between PTS and DTS, align them"),R=u):u=R);var I=(A=S[8])+9;if(h.size<=I)return null;h.size-=I;for(var O=new Uint8Array(h.size),x=0,P=T.length;x<P;x++){var F=(S=T[x]).byteLength;if(I){if(I>F){I-=F;continue}S=S.subarray(I),F-=I,I=0}O.set(S,g),g+=F}return D&&(D-=A+3),{data:O,pts:R,dts:u,len:D}}return null}function l(h,S){if(h.units.length&&h.frame){if(h.pts===void 0){var D=S.samples,A=D.length;if(!A)return void S.dropped++;var R=D[A-1];h.pts=R.pts,h.dts=R.dts}S.samples.push(h)}h.debug.length&&E.logger.log(h.pts+"/"+h.dts+":"+h.debug)}function p(h,S){var D=h.length;if(D>0){if(S.pts>=h[D-1].pts)h.push(S);else for(var A=D-1;A>=0;A--)if(S.pts<h[A].pts){h.splice(A,0,S);break}}else h.push(S)}function y(h){for(var S=h.byteLength,D=[],A=1;A<S-2;)h[A]===0&&h[A+1]===0&&h[A+2]===3?(D.push(A+2),A+=2):A++;if(D.length===0)return h;var R=S-D.length,u=new Uint8Array(R),g=0;for(A=0;A<R;g++,A++)g===D[0]&&(g++,D.shift()),u[A]=h[g];return u}L.minProbeByteLength=188,t.default=L},"./src/errors.ts":function(e,t,r){var i,n,s,f;r.r(t),r.d(t,"ErrorTypes",function(){return i}),r.d(t,"ErrorDetails",function(){return s}),(n=i||(i={})).NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",(f=s||(s={})).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",f.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",f.KEY_SYSTEM_NO_SESSION="keySystemNoSession",f.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",f.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",f.MANIFEST_LOAD_ERROR="manifestLoadError",f.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",f.MANIFEST_PARSING_ERROR="manifestParsingError",f.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",f.LEVEL_EMPTY_ERROR="levelEmptyError",f.LEVEL_LOAD_ERROR="levelLoadError",f.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",f.LEVEL_SWITCH_ERROR="levelSwitchError",f.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",f.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",f.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",f.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",f.FRAG_LOAD_ERROR="fragLoadError",f.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",f.FRAG_DECRYPT_ERROR="fragDecryptError",f.FRAG_PARSING_ERROR="fragParsingError",f.REMUX_ALLOC_ERROR="remuxAllocError",f.KEY_LOAD_ERROR="keyLoadError",f.KEY_LOAD_TIMEOUT="keyLoadTimeOut",f.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",f.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",f.BUFFER_APPEND_ERROR="bufferAppendError",f.BUFFER_APPENDING_ERROR="bufferAppendingError",f.BUFFER_STALLED_ERROR="bufferStalledError",f.BUFFER_FULL_ERROR="bufferFullError",f.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",f.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",f.INTERNAL_EXCEPTION="internalException",f.INTERNAL_ABORTED="aborted",f.UNKNOWN="unknown"},"./src/events.ts":function(e,t,r){var i,n;r.r(t),r.d(t,"Events",function(){return i}),(n=i||(i={})).MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached"},"./src/hls.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),n=r("./src/loader/playlist-loader.ts"),s=r("./src/loader/key-loader.ts"),f=r("./src/controller/id3-track-controller.ts"),_=r("./src/controller/latency-controller.ts"),b=r("./src/controller/level-controller.ts"),a=r("./src/controller/fragment-tracker.ts"),E=r("./src/controller/stream-controller.ts"),v=r("./src/is-supported.ts"),d=r("./src/utils/logger.ts"),L=r("./src/config.ts"),k=r("./node_modules/eventemitter3/index.js"),m=r("./src/events.ts"),o=r("./src/errors.ts");function c(p,y){for(var h=0;h<y.length;h++){var S=y[h];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}var l=function(){function p(A){A===void 0&&(A={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new k.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var R=this.config=Object(L.mergeConfig)(p.DefaultConfig,A);this.userConfig=A,Object(d.enableLogs)(R.debug),this._autoLevelCapping=-1,R.progressive&&Object(L.enableStreamingMode)(R);var u=R.abrController,g=R.bufferController,T=R.capLevelController,C=R.fpsController,w=this.abrController=new u(this),I=this.bufferController=new g(this),O=this.capLevelController=new T(this),x=new C(this),P=new n.default(this),F=new s.default(this),N=new f.default(this),U=this.levelController=new b.default(this),G=new a.FragmentTracker(this),V=this.streamController=new E.default(this,G);O.setStreamController(V),x.setStreamController(V);var X=[U,V];this.networkControllers=X;var j=[P,F,w,I,O,x,N,G];this.audioTrackController=this.createController(R.audioTrackController,null,X),this.createController(R.audioStreamController,G,X),this.subtitleTrackController=this.createController(R.subtitleTrackController,null,X),this.createController(R.subtitleStreamController,G,X),this.createController(R.timelineController,null,j),this.emeController=this.createController(R.emeController,null,j),this.latencyController=this.createController(_.default,null,j),this.coreComponents=j}p.isSupported=function(){return Object(v.isSupported)()};var y,h,S,D=p.prototype;return D.createController=function(A,R,u){if(A){var g=R?new A(this,R):new A(this);return u&&u.push(g),g}return null},D.on=function(A,R,u){u===void 0&&(u=this),this._emitter.on(A,R,u)},D.once=function(A,R,u){u===void 0&&(u=this),this._emitter.once(A,R,u)},D.removeAllListeners=function(A){this._emitter.removeAllListeners(A)},D.off=function(A,R,u,g){u===void 0&&(u=this),this._emitter.off(A,R,u,g)},D.listeners=function(A){return this._emitter.listeners(A)},D.emit=function(A,R,u){return this._emitter.emit(A,R,u)},D.trigger=function(A,R){if(this.config.debug)return this.emit(A,A,R);try{return this.emit(A,A,R)}catch(u){d.logger.error("An internal error happened while handling event "+A+'. Error message: "'+u.message+'". Here is a stacktrace:',u),this.trigger(m.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:A,error:u})}return!1},D.listenerCount=function(A){return this._emitter.listenerCount(A)},D.destroy=function(){d.logger.log("destroy"),this.trigger(m.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(A){return A.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(A){return A.destroy()}),this.coreComponents.length=0},D.attachMedia=function(A){d.logger.log("attachMedia"),this._media=A,this.trigger(m.Events.MEDIA_ATTACHING,{media:A})},D.detachMedia=function(){d.logger.log("detachMedia"),this.trigger(m.Events.MEDIA_DETACHING,void 0),this._media=null},D.loadSource=function(A){this.stopLoad();var R=this.media,u=this.url,g=this.url=i.buildAbsoluteURL(self.location.href,A,{alwaysNormalize:!0});d.logger.log("loadSource:"+g),R&&u&&u!==g&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(R)),this.trigger(m.Events.MANIFEST_LOADING,{url:A})},D.startLoad=function(A){A===void 0&&(A=-1),d.logger.log("startLoad("+A+")"),this.networkControllers.forEach(function(R){R.startLoad(A)})},D.stopLoad=function(){d.logger.log("stopLoad"),this.networkControllers.forEach(function(A){A.stopLoad()})},D.swapAudioCodec=function(){d.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},D.recoverMediaError=function(){d.logger.log("recoverMediaError");var A=this._media;this.detachMedia(),A&&this.attachMedia(A)},D.removeLevel=function(A,R){R===void 0&&(R=0),this.levelController.removeLevel(A,R)},y=p,S=[{key:"version",get:function(){return"1.0.10"}},{key:"Events",get:function(){return m.Events}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return p.defaultConfig?p.defaultConfig:L.hlsDefaultConfig},set:function(A){p.defaultConfig=A}}],(h=[{key:"levels",get:function(){var A=this.levelController.levels;return A||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(A){d.logger.log("set currentLevel:"+A),this.loadLevel=A,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(A){d.logger.log("set nextLevel:"+A),this.levelController.manualLevel=A,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(A){d.logger.log("set loadLevel:"+A),this.levelController.manualLevel=A}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(A){this.levelController.nextLoadLevel=A}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(A){d.logger.log("set firstLevel:"+A),this.levelController.firstLevel=A}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(A){d.logger.log("set startLevel:"+A),A!==-1&&(A=Math.max(A,this.minAutoLevel)),this.levelController.startLevel=A}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(A){var R=!!A;R!==this.config.capLevelToPlayerSize&&(R?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=R)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(A){this._autoLevelCapping!==A&&(d.logger.log("set autoLevelCapping:"+A),this._autoLevelCapping=A)}},{key:"bandwidthEstimate",get:function(){var A=this.abrController.bwEstimator;return A?A.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var A=this.levels,R=this.config.minAutoBitrate;if(!A)return 0;for(var u=A.length,g=0;g<u;g++)if(A[g].maxBitrate>R)return g;return 0}},{key:"maxAutoLevel",get:function(){var A=this.levels,R=this.autoLevelCapping;return R===-1&&A&&A.length?A.length-1:R}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(A){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,A)}},{key:"audioTracks",get:function(){var A=this.audioTrackController;return A?A.audioTracks:[]}},{key:"audioTrack",get:function(){var A=this.audioTrackController;return A?A.audioTrack:-1},set:function(A){var R=this.audioTrackController;R&&(R.audioTrack=A)}},{key:"subtitleTracks",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTrack:-1},set:function(A){var R=this.subtitleTrackController;R&&(R.subtitleTrack=A)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var A=this.subtitleTrackController;return!!A&&A.subtitleDisplay},set:function(A){var R=this.subtitleTrackController;R&&(R.subtitleDisplay=A)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(A){this.config.lowLatencyMode=A}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&c(y.prototype,h),S&&c(y,S),p}();l.defaultConfig=void 0},"./src/is-supported.ts":function(e,t,r){r.r(t),r.d(t,"isSupported",function(){return s}),r.d(t,"changeTypeSupported",function(){return f});var i=r("./src/utils/mediasource-helper.ts");function n(){return self.SourceBuffer||self.WebKitSourceBuffer}function s(){var _=Object(i.getMediaSource)();if(!_)return!1;var b=n(),a=_&&typeof _.isTypeSupported=="function"&&_.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),E=!b||b.prototype&&typeof b.prototype.appendBuffer=="function"&&typeof b.prototype.remove=="function";return!!a&&!!E}function f(){var _,b=n();return typeof(b==null||(_=b.prototype)===null||_===void 0?void 0:_.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return v}),r.d(t,"LoadError",function(){return L});var i=r("./src/polyfills/number.ts"),n=r("./src/errors.ts");function s(k){var m=typeof Map=="function"?new Map:void 0;return(s=function(o){if(o===null||(c=o,Function.toString.call(c).indexOf("[native code]")===-1))return o;var c;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(m!==void 0){if(m.has(o))return m.get(o);m.set(o,l)}function l(){return f(o,arguments,a(this).constructor)}return l.prototype=Object.create(o.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),b(l,o)})(k)}function f(k,m,o){return(f=_()?Reflect.construct:function(c,l,p){var y=[null];y.push.apply(y,l);var h=new(Function.bind.apply(c,y));return p&&b(h,p.prototype),h}).apply(null,arguments)}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(k,m){return(b=Object.setPrototypeOf||function(o,c){return o.__proto__=c,o})(k,m)}function a(k){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(k)}var E=Math.pow(2,17),v=function(){function k(o){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=o}var m=k.prototype;return m.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},m.abort=function(){this.loader&&this.loader.abort()},m.load=function(o,c){var l=this,p=o.url;if(!p)return Promise.reject(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,networkDetails:null},"Fragment does not have a "+(p?"part list":"url")));this.abort();var y=this.config,h=y.fLoader,S=y.loader;return new Promise(function(D,A){l.loader&&l.loader.destroy();var R=l.loader=o.loader=h?new h(y):new S(y),u=d(o),g={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:y.fragLoadingMaxRetryTimeout,highWaterMark:E};o.stats=R.stats,R.load(u,g,{onSuccess:function(T,C,w,I){l.resetLoader(o,R),D({frag:o,part:null,payload:T.data,networkDetails:I})},onError:function(T,C,w){l.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,response:T,networkDetails:w}))},onAbort:function(T,C,w){l.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,networkDetails:w}))},onTimeout:function(T,C,w){l.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,networkDetails:w}))},onProgress:function(T,C,w,I){c&&c({frag:o,part:null,payload:w,networkDetails:I})}})})},m.loadPart=function(o,c,l){var p=this;this.abort();var y=this.config,h=y.fLoader,S=y.loader;return new Promise(function(D,A){p.loader&&p.loader.destroy();var R=p.loader=o.loader=h?new h(y):new S(y),u=d(o,c),g={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:y.fragLoadingMaxRetryTimeout,highWaterMark:E};c.stats=R.stats,R.load(u,g,{onSuccess:function(T,C,w,I){p.resetLoader(o,R),p.updateStatsFromPart(o,c);var O={frag:o,part:c,payload:T.data,networkDetails:I};l(O),D(O)},onError:function(T,C,w){p.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,part:c,response:T,networkDetails:w}))},onAbort:function(T,C,w){o.stats.aborted=c.stats.aborted,p.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,part:c,networkDetails:w}))},onTimeout:function(T,C,w){p.resetLoader(o,R),A(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,part:c,networkDetails:w}))}})})},m.updateStatsFromPart=function(o,c){var l=o.stats,p=c.stats,y=p.total;if(l.loaded+=p.loaded,y){var h=Math.round(o.duration/c.duration),S=Math.min(Math.round(l.loaded/y),h),D=(h-S)*Math.round(l.loaded/S);l.total=l.loaded+D}else l.total=Math.max(l.loaded,l.total);var A=l.loading,R=p.loading;A.start?A.first+=R.first-R.start:(A.start=R.start,A.first=R.first),A.end=R.end},m.resetLoader=function(o,c){o.loader=null,this.loader===c&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),c.destroy()},k}();function d(k,m){m===void 0&&(m=null);var o=m||k,c={frag:k,part:m,responseType:"arraybuffer",url:o.url,rangeStart:0,rangeEnd:0},l=o.byteRangeStartOffset,p=o.byteRangeEndOffset;return Object(i.isFiniteNumber)(l)&&Object(i.isFiniteNumber)(p)&&(c.rangeStart=l,c.rangeEnd=p),c}var L=function(k){var m,o;function c(l){for(var p,y=arguments.length,h=new Array(y>1?y-1:0),S=1;S<y;S++)h[S-1]=arguments[S];return(p=k.call.apply(k,[this].concat(h))||this).data=void 0,p.data=l,p}return o=k,(m=c).prototype=Object.create(o.prototype),m.prototype.constructor=m,b(m,o),c}(s(Error))},"./src/loader/fragment.ts":function(e,t,r){r.r(t),r.d(t,"ElementaryStreamTypes",function(){return i}),r.d(t,"BaseSegment",function(){return k}),r.d(t,"Fragment",function(){return m}),r.d(t,"Part",function(){return o});var i,n,s=r("./src/polyfills/number.ts"),f=r("./node_modules/url-toolkit/src/url-toolkit.js"),_=r("./src/utils/logger.ts"),b=r("./src/loader/level-key.ts"),a=r("./src/loader/load-stats.ts");function E(c,l){c.prototype=Object.create(l.prototype),c.prototype.constructor=c,v(c,l)}function v(c,l){return(v=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p})(c,l)}function d(c,l){for(var p=0;p<l.length;p++){var y=l[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(c,y.key,y)}}function L(c,l,p){return l&&d(c.prototype,l),p&&d(c,p),c}(n=i||(i={})).AUDIO="audio",n.VIDEO="video",n.AUDIOVIDEO="audiovideo";var k=function(){function c(l){var p;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((p={})[i.AUDIO]=null,p[i.VIDEO]=null,p[i.AUDIOVIDEO]=null,p),this.baseurl=l}return c.prototype.setByteRange=function(l,p){var y=l.split("@",2),h=[];y.length===1?h[0]=p?p.byteRangeEndOffset:0:h[0]=parseInt(y[1]),h[1]=parseInt(y[0])+h[0],this._byteRange=h},L(c,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(f.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(l){this._url=l}}]),c}(),m=function(c){function l(y,h){var S;return(S=c.call(this,h)||this)._decryptdata=null,S.rawProgramDateTime=null,S.programDateTime=null,S.tagList=[],S.duration=0,S.sn=0,S.levelkey=void 0,S.type=void 0,S.loader=null,S.level=-1,S.cc=0,S.startPTS=void 0,S.endPTS=void 0,S.appendedPTS=void 0,S.startDTS=void 0,S.endDTS=void 0,S.start=0,S.deltaPTS=void 0,S.maxStartPTS=void 0,S.minEndPTS=void 0,S.stats=new a.LoadStats,S.urlId=0,S.data=void 0,S.bitrateTest=!1,S.title=null,S.initSegment=null,S.type=y,S}E(l,c);var p=l.prototype;return p.createInitializationVector=function(y){for(var h=new Uint8Array(16),S=12;S<16;S++)h[S]=y>>8*(15-S)&255;return h},p.setDecryptDataFromLevelKey=function(y,h){var S=y;return(y==null?void 0:y.method)==="AES-128"&&y.uri&&!y.iv&&((S=b.LevelKey.fromURI(y.uri)).method=y.method,S.iv=this.createInitializationVector(h),S.keyFormat="identity"),S},p.setElementaryStreamInfo=function(y,h,S,D,A,R){R===void 0&&(R=!1);var u=this.elementaryStreams,g=u[y];g?(g.startPTS=Math.min(g.startPTS,h),g.endPTS=Math.max(g.endPTS,S),g.startDTS=Math.min(g.startDTS,D),g.endDTS=Math.max(g.endDTS,A)):u[y]={startPTS:h,endPTS:S,startDTS:D,endDTS:A,partial:R}},p.clearElementaryStreamInfo=function(){var y=this.elementaryStreams;y[i.AUDIO]=null,y[i.VIDEO]=null,y[i.AUDIOVIDEO]=null},L(l,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var y=this.sn;typeof y!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&_.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),y=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,y)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(s.isFiniteNumber)(this.programDateTime))return null;var y=Object(s.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*y}},{key:"encrypted",get:function(){var y;return!((y=this.decryptdata)===null||y===void 0||!y.keyFormat||!this.decryptdata.uri)}}]),l}(k),o=function(c){function l(p,y,h,S,D){var A;(A=c.call(this,h)||this).fragOffset=0,A.duration=0,A.gap=!1,A.independent=!1,A.relurl=void 0,A.fragment=void 0,A.index=void 0,A.stats=new a.LoadStats,A.duration=p.decimalFloatingPoint("DURATION"),A.gap=p.bool("GAP"),A.independent=p.bool("INDEPENDENT"),A.relurl=p.enumeratedString("URI"),A.fragment=y,A.index=S;var R=p.enumeratedString("BYTERANGE");return R&&A.setByteRange(R,D),D&&(A.fragOffset=D.fragOffset+D.duration),A}return E(l,c),L(l,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var p=this.elementaryStreams;return!!(p.audio||p.video||p.audiovideo)}}]),l}(k)},"./src/loader/key-loader.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return f});var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),f=function(){function _(a){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=a,this._registerListeners()}var b=_.prototype;return b._registerListeners=function(){this.hls.on(i.Events.KEY_LOADING,this.onKeyLoading,this)},b._unregisterListeners=function(){this.hls.off(i.Events.KEY_LOADING,this.onKeyLoading)},b.destroy=function(){for(var a in this._unregisterListeners(),this.loaders){var E=this.loaders[a];E&&E.destroy()}this.loaders={}},b.onKeyLoading=function(a,E){var v=E.frag,d=v.type,L=this.loaders[d];if(v.decryptdata){var k=v.decryptdata.uri;if(k!==this.decrypturl||this.decryptkey===null){var m=this.hls.config;if(L&&(s.logger.warn("abort previous key loader for type:"+d),L.abort()),!k)return void s.logger.warn("key uri is falsy");var o=m.loader,c=v.loader=this.loaders[d]=new o(m);this.decrypturl=k,this.decryptkey=null;var l={url:k,frag:v,responseType:"arraybuffer"},p={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:m.fragLoadingRetryDelay,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:0},y={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(l,p,y)}else this.decryptkey&&(v.decryptdata.key=this.decryptkey,this.hls.trigger(i.Events.KEY_LOADED,{frag:v}))}else s.logger.warn("Missing decryption data on fragment in onKeyLoading")},b.loadsuccess=function(a,E,v){var d=v.frag;d.decryptdata?(this.decryptkey=d.decryptdata.key=new Uint8Array(a.data),d.loader=null,delete this.loaders[d.type],this.hls.trigger(i.Events.KEY_LOADED,{frag:d})):s.logger.error("after key load, decryptdata unset")},b.loaderror=function(a,E){var v=E.frag,d=v.loader;d&&d.abort(),delete this.loaders[v.type],this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:v,response:a})},b.loadtimeout=function(a,E){var v=E.frag,d=v.loader;d&&d.abort(),delete this.loaders[v.type],this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:v})},_}()},"./src/loader/level-details.ts":function(e,t,r){r.r(t),r.d(t,"LevelDetails",function(){return s});var i=r("./src/polyfills/number.ts");function n(f,_){for(var b=0;b<_.length;b++){var a=_[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(f,a.key,a)}}var s=function(){function f(a){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=a}var _,b;return f.prototype.reloaded=function(a){if(!a)return this.advanced=!0,void(this.updated=!0);var E=this.lastPartSn-a.lastPartSn,v=this.lastPartIndex-a.lastPartIndex;this.updated=this.endSN!==a.endSN||!!v||!!E,this.advanced=this.endSN>a.endSN||E>0||E===0&&v>0,this.updated||this.advanced?this.misses=Math.floor(.6*a.misses):this.misses=a.misses+1,this.availabilityDelay=a.availabilityDelay},_=f,(b=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(i.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var a=this.driftEndTime-this.driftStartTime;return a>0?1e3*(this.driftEnd-this.driftStart)/a:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var a;return(a=this.fragments)!==null&&a!==void 0&&a.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&n(_.prototype,b),f}()},"./src/loader/level-key.ts":function(e,t,r){r.r(t),r.d(t,"LevelKey",function(){return s});var i=r("./node_modules/url-toolkit/src/url-toolkit.js");function n(f,_){for(var b=0;b<_.length;b++){var a=_[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(f,a.key,a)}}var s=function(){function f(a,E){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=E?Object(i.buildAbsoluteURL)(a,E,{alwaysNormalize:!0}):a}var _,b;return f.fromURL=function(a,E){return new f(a,E)},f.fromURI=function(a){return new f(a)},_=f,(b=[{key:"uri",get:function(){return this._uri}}])&&n(_.prototype,b),f}()},"./src/loader/load-stats.ts":function(e,t,r){r.r(t),r.d(t,"LoadStats",function(){return i});var i=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return o});var i=r("./src/polyfills/number.ts"),n=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/loader/fragment.ts"),f=r("./src/loader/level-details.ts"),_=r("./src/loader/level-key.ts"),b=r("./src/utils/attr-list.ts"),a=r("./src/utils/logger.ts"),E=r("./src/utils/codecs.ts"),v=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,d=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),k=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),m=/\.(mp4|m4s|m4v|m4a)$/i,o=function(){function y(){}return y.findGroup=function(h,S){for(var D=0;D<h.length;D++){var A=h[D];if(A.id===S)return A}},y.convertAVC1ToAVCOTI=function(h){var S=h.split(".");if(S.length>2){var D=S.shift()+".";return D+=parseInt(S.shift()).toString(16),D+=("000"+parseInt(S.shift()).toString(16)).substr(-4)}return h},y.resolve=function(h,S){return n.buildAbsoluteURL(S,h,{alwaysNormalize:!0})},y.parseMasterPlaylist=function(h,S){var D,A=[],R={},u=!1;for(v.lastIndex=0;(D=v.exec(h))!=null;)if(D[1]){var g=new b.AttrList(D[1]),T={attrs:g,bitrate:g.decimalInteger("AVERAGE-BANDWIDTH")||g.decimalInteger("BANDWIDTH"),name:g.NAME,url:y.resolve(D[2],S)},C=g.decimalResolution("RESOLUTION");C&&(T.width=C.width,T.height=C.height),c((g.CODECS||"").split(/[ ,]+/).filter(function(I){return I}),T),T.videoCodec&&T.videoCodec.indexOf("avc1")!==-1&&(T.videoCodec=y.convertAVC1ToAVCOTI(T.videoCodec)),A.push(T)}else if(D[3]){var w=new b.AttrList(D[3]);w["DATA-ID"]&&(u=!0,R[w["DATA-ID"]]=w)}return{levels:A,sessionData:u?R:null}},y.parseMasterPlaylistMedia=function(h,S,D,A){var R;A===void 0&&(A=[]);var u=[],g=0;for(d.lastIndex=0;(R=d.exec(h))!==null;){var T=new b.AttrList(R[1]);if(T.TYPE===D){var C={attrs:T,bitrate:0,id:g++,groupId:T["GROUP-ID"],instreamId:T["INSTREAM-ID"],name:T.NAME||T.LANGUAGE||"",type:D,default:T.bool("DEFAULT"),autoselect:T.bool("AUTOSELECT"),forced:T.bool("FORCED"),lang:T.LANGUAGE,url:T.URI?y.resolve(T.URI,S):""};if(A.length){var w=y.findGroup(A,C.groupId)||A[0];l(C,w,"audioCodec"),l(C,w,"textCodec")}u.push(C)}}return u},y.parseLevelPlaylist=function(h,S,D,A,R){var u,g,T,C=new f.LevelDetails(S),w=C.fragments,I=null,O=0,x=0,P=0,F=0,N=null,U=new s.Fragment(A,S),G=-1,V=!1;for(L.lastIndex=0,C.m3u8=h;(u=L.exec(h))!==null;){V&&(V=!1,(U=new s.Fragment(A,S)).start=P,U.sn=O,U.cc=F,U.level=D,I&&(U.initSegment=I,U.rawProgramDateTime=I.rawProgramDateTime));var X=u[1];if(X){U.duration=parseFloat(X);var j=(" "+u[2]).slice(1);U.title=j||null,U.tagList.push(j?["INF",X,j]:["INF",X])}else if(u[3])Object(i.isFiniteNumber)(U.duration)&&(U.start=P,T&&(U.levelkey=T),U.sn=O,U.level=D,U.cc=F,U.urlId=R,w.push(U),U.relurl=(" "+u[3]).slice(1),p(U,N),N=U,P+=U.duration,O++,x=0,V=!0);else if(u[4]){var z=(" "+u[4]).slice(1);N?U.setByteRange(z,N):U.setByteRange(z)}else if(u[5])U.rawProgramDateTime=(" "+u[5]).slice(1),U.tagList.push(["PROGRAM-DATE-TIME",U.rawProgramDateTime]),G===-1&&(G=w.length);else{if(!(u=u[0].match(k))){a.logger.warn("No matches on slow regex match for level playlist!");continue}for(g=1;g<u.length&&u[g]===void 0;g++);var W=(" "+u[g]).slice(1),$=(" "+u[g+1]).slice(1),ne=u[g+2]?(" "+u[g+2]).slice(1):"";switch(W){case"PLAYLIST-TYPE":C.type=$.toUpperCase();break;case"MEDIA-SEQUENCE":O=C.startSN=parseInt($);break;case"SKIP":var le=new b.AttrList($),ae=le.decimalInteger("SKIPPED-SEGMENTS");if(Object(i.isFiniteNumber)(ae)){C.skippedSegments=ae;for(var M=ae;M--;)w.unshift(null);O+=ae}var B=le.enumeratedString("RECENTLY-REMOVED-DATERANGES");B&&(C.recentlyRemovedDateranges=B.split("	"));break;case"TARGETDURATION":C.targetduration=parseFloat($);break;case"VERSION":C.version=parseInt($);break;case"EXTM3U":break;case"ENDLIST":C.live=!1;break;case"#":($||ne)&&U.tagList.push(ne?[$,ne]:[$]);break;case"DIS":F++;case"GAP":U.tagList.push([W]);break;case"BITRATE":U.tagList.push([W,$]);break;case"DISCONTINUITY-SEQ":F=parseInt($);break;case"KEY":var K,H=new b.AttrList($),q=H.enumeratedString("METHOD"),J=H.URI,ee=H.hexadecimalInteger("IV"),Z=H.enumeratedString("KEYFORMATVERSIONS"),te=H.enumeratedString("KEYID"),Q=(K=H.enumeratedString("KEYFORMAT"))!=null?K:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(Q)>-1){a.logger.warn("Keyformat "+Q+" is not supported from the manifest");continue}if(Q!=="identity")continue;q&&(T=_.LevelKey.fromURL(S,J),J&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(q)>=0&&(T.method=q,T.keyFormat=Q,te&&(T.keyID=te),Z&&(T.keyFormatVersions=Z),T.iv=ee));break;case"START":var oe=new b.AttrList($).decimalFloatingPoint("TIME-OFFSET");Object(i.isFiniteNumber)(oe)&&(C.startTimeOffset=oe);break;case"MAP":var ie=new b.AttrList($);U.relurl=ie.URI,ie.BYTERANGE&&U.setByteRange(ie.BYTERANGE),U.level=D,U.sn="initSegment",T&&(U.levelkey=T),U.initSegment=null,I=U,V=!0;break;case"SERVER-CONTROL":var se=new b.AttrList($);C.canBlockReload=se.bool("CAN-BLOCK-RELOAD"),C.canSkipUntil=se.optionalFloat("CAN-SKIP-UNTIL",0),C.canSkipDateRanges=C.canSkipUntil>0&&se.bool("CAN-SKIP-DATERANGES"),C.partHoldBack=se.optionalFloat("PART-HOLD-BACK",0),C.holdBack=se.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var ce=new b.AttrList($);C.partTarget=ce.decimalFloatingPoint("PART-TARGET");break;case"PART":var de=C.partList;de||(de=C.partList=[]);var me=x>0?de[de.length-1]:void 0,ye=x++,Se=new s.Part(new b.AttrList($),U,S,ye,me);de.push(Se),U.duration+=Se.duration;break;case"PRELOAD-HINT":var Le=new b.AttrList($);C.preloadHint=Le;break;case"RENDITION-REPORT":var We=new b.AttrList($);C.renditionReports=C.renditionReports||[],C.renditionReports.push(We);break;default:a.logger.warn("line parsed but not handled: "+u)}}}N&&!N.relurl?(w.pop(),P-=N.duration,C.partList&&(C.fragmentHint=N)):C.partList&&(p(U,N),U.cc=F,C.fragmentHint=U);var ct=w.length,Be=w[0],yt=w[ct-1];if((P+=C.skippedSegments*C.targetduration)>0&&ct&&yt){C.averagetargetduration=P/ct;var ke=yt.sn;C.endSN=ke!=="initSegment"?ke:0,Be&&(C.startCC=Be.cc,Be.initSegment||C.fragments.every(function(Ie){return Ie.relurl&&(Xe=Ie.relurl,m.test((Ot=(rt=n.parseURL(Xe))===null||rt===void 0?void 0:rt.path)!=null?Ot:""));var Xe,Ot,rt})&&(a.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(U=new s.Fragment(A,S)).relurl=yt.relurl,U.level=D,U.sn="initSegment",Be.initSegment=U,C.needSidxRanges=!0))}else C.endSN=0,C.startCC=0;return C.fragmentHint&&(P+=C.fragmentHint.duration),C.totalduration=P,C.endCC=F,G>0&&function(Ie,Xe){for(var Ot=Ie[Xe],rt=Xe;rt--;){var Pt=Ie[rt];if(!Pt)return;Pt.programDateTime=Ot.programDateTime-1e3*Pt.duration,Ot=Pt}}(w,G),C},y}();function c(y,h){["video","audio","text"].forEach(function(S){var D=y.filter(function(R){return Object(E.isCodecType)(R,S)});if(D.length){var A=D.filter(function(R){return R.lastIndexOf("avc1",0)===0||R.lastIndexOf("mp4a",0)===0});h[S+"Codec"]=A.length>0?A[0]:D[0],y=y.filter(function(R){return D.indexOf(R)===-1})}}),h.unknownCodecs=y}function l(y,h,S){var D=h[S];D&&(y[S]=D)}function p(y,h){y.rawProgramDateTime?y.programDateTime=Date.parse(y.rawProgramDateTime):h!=null&&h.programDateTime&&(y.programDateTime=h.endProgramDateTime),Object(i.isFiniteNumber)(y.programDateTime)||(y.programDateTime=null,y.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/errors.ts"),f=r("./src/utils/logger.ts"),_=r("./src/utils/mp4-tools.ts"),b=r("./src/loader/m3u8-parser.ts"),a=r("./src/types/loader.ts"),E=r("./src/utils/attr-list.ts");function v(L,k){var m=L.url;return m!==void 0&&m.indexOf("data:")!==0||(m=k.url),m}var d=function(){function L(m){this.hls=void 0,this.loaders=Object.create(null),this.hls=m,this.registerListeners()}var k=L.prototype;return k.registerListeners=function(){var m=this.hls;m.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),m.on(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),m.on(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},k.unregisterListeners=function(){var m=this.hls;m.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),m.off(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),m.off(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},k.createInternalLoader=function(m){var o=this.hls.config,c=o.pLoader,l=o.loader,p=new(c||l)(o);return m.loader=p,this.loaders[m.type]=p,p},k.getInternalLoader=function(m){return this.loaders[m.type]},k.resetInternalLoader=function(m){this.loaders[m]&&delete this.loaders[m]},k.destroyInternalLoaders=function(){for(var m in this.loaders){var o=this.loaders[m];o&&o.destroy(),this.resetInternalLoader(m)}},k.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},k.onManifestLoading=function(m,o){var c=o.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:a.PlaylistContextType.MANIFEST,url:c,deliveryDirectives:null})},k.onLevelLoading=function(m,o){var c=o.id,l=o.level,p=o.url,y=o.deliveryDirectives;this.load({id:c,groupId:null,level:l,responseType:"text",type:a.PlaylistContextType.LEVEL,url:p,deliveryDirectives:y})},k.onAudioTrackLoading=function(m,o){var c=o.id,l=o.groupId,p=o.url,y=o.deliveryDirectives;this.load({id:c,groupId:l,level:null,responseType:"text",type:a.PlaylistContextType.AUDIO_TRACK,url:p,deliveryDirectives:y})},k.onSubtitleTrackLoading=function(m,o){var c=o.id,l=o.groupId,p=o.url,y=o.deliveryDirectives;this.load({id:c,groupId:l,level:null,responseType:"text",type:a.PlaylistContextType.SUBTITLE_TRACK,url:p,deliveryDirectives:y})},k.load=function(m){var o,c,l,p,y,h,S=this.hls.config,D=this.getInternalLoader(m);if(D){var A=D.context;if(A&&A.url===m.url)return void f.logger.trace("[playlist-loader]: playlist request ongoing");f.logger.log("[playlist-loader]: aborting previous loader for type: "+m.type),D.abort()}switch(m.type){case a.PlaylistContextType.MANIFEST:c=S.manifestLoadingMaxRetry,l=S.manifestLoadingTimeOut,p=S.manifestLoadingRetryDelay,y=S.manifestLoadingMaxRetryTimeout;break;case a.PlaylistContextType.LEVEL:case a.PlaylistContextType.AUDIO_TRACK:case a.PlaylistContextType.SUBTITLE_TRACK:c=0,l=S.levelLoadingTimeOut;break;default:c=S.levelLoadingMaxRetry,l=S.levelLoadingTimeOut,p=S.levelLoadingRetryDelay,y=S.levelLoadingMaxRetryTimeout}if(D=this.createInternalLoader(m),(o=m.deliveryDirectives)!==null&&o!==void 0&&o.part&&(m.type===a.PlaylistContextType.LEVEL&&m.level!==null?h=this.hls.levels[m.level].details:m.type===a.PlaylistContextType.AUDIO_TRACK&&m.id!==null?h=this.hls.audioTracks[m.id].details:m.type===a.PlaylistContextType.SUBTITLE_TRACK&&m.id!==null&&(h=this.hls.subtitleTracks[m.id].details),h)){var R=h.partTarget,u=h.targetduration;R&&u&&(l=Math.min(1e3*Math.max(3*R,.8*u),l))}var g={timeout:l,maxRetry:c,retryDelay:p,maxRetryDelay:y,highWaterMark:0},T={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};D.load(m,g,T)},k.loadsuccess=function(m,o,c,l){if(l===void 0&&(l=null),c.isSidxRequest)return this.handleSidxRequest(m,c),void this.handlePlaylistLoaded(m,o,c,l);this.resetInternalLoader(c.type);var p=m.data;p.indexOf("#EXTM3U")===0?(o.parsing.start=performance.now(),p.indexOf("#EXTINF:")>0||p.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(m,o,c,l):this.handleMasterPlaylist(m,o,c,l)):this.handleManifestParsingError(m,c,"no EXTM3U delimiter",l)},k.loaderror=function(m,o,c){c===void 0&&(c=null),this.handleNetworkError(o,c,!1,m)},k.loadtimeout=function(m,o,c){c===void 0&&(c=null),this.handleNetworkError(o,c,!0)},k.handleMasterPlaylist=function(m,o,c,l){var p=this.hls,y=m.data,h=v(m,c),S=b.default.parseMasterPlaylist(y,h),D=S.levels,A=S.sessionData;if(D.length){var R=D.map(function(w){return{id:w.attrs.AUDIO,audioCodec:w.audioCodec}}),u=D.map(function(w){return{id:w.attrs.SUBTITLES,textCodec:w.textCodec}}),g=b.default.parseMasterPlaylistMedia(y,h,"AUDIO",R),T=b.default.parseMasterPlaylistMedia(y,h,"SUBTITLES",u),C=b.default.parseMasterPlaylistMedia(y,h,"CLOSED-CAPTIONS");g.length&&(g.some(function(w){return!w.url})||!D[0].audioCodec||D[0].attrs.AUDIO||(f.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new E.AttrList({}),bitrate:0,url:""}))),p.trigger(n.Events.MANIFEST_LOADED,{levels:D,audioTracks:g,subtitles:T,captions:C,url:h,stats:o,networkDetails:l,sessionData:A})}else this.handleManifestParsingError(m,c,"no level found in manifest",l)},k.handleTrackOrLevelPlaylist=function(m,o,c,l){var p=this.hls,y=c.id,h=c.level,S=c.type,D=v(m,c),A=Object(i.isFiniteNumber)(y)?y:0,R=Object(i.isFiniteNumber)(h)?h:A,u=function(I){switch(I.type){case a.PlaylistContextType.AUDIO_TRACK:return a.PlaylistLevelType.AUDIO;case a.PlaylistContextType.SUBTITLE_TRACK:return a.PlaylistLevelType.SUBTITLE;default:return a.PlaylistLevelType.MAIN}}(c),g=b.default.parseLevelPlaylist(m.data,D,R,u,A);if(g.fragments.length){if(S===a.PlaylistContextType.MANIFEST){var T={attrs:new E.AttrList({}),bitrate:0,details:g,name:"",url:D};p.trigger(n.Events.MANIFEST_LOADED,{levels:[T],audioTracks:[],url:D,stats:o,networkDetails:l,sessionData:null})}if(o.parsing.end=performance.now(),g.needSidxRanges){var C,w=(C=g.fragments[0].initSegment)===null||C===void 0?void 0:C.url;this.load({url:w,isSidxRequest:!0,type:S,level:h,levelDetails:g,id:y,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else c.levelDetails=g,this.handlePlaylistLoaded(m,o,c,l)}else p.trigger(n.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:D,reason:"no fragments found in level",level:typeof c.level=="number"?c.level:void 0})},k.handleSidxRequest=function(m,o){var c=Object(_.parseSegmentIndex)(new Uint8Array(m.data));if(c){var l=c.references,p=o.levelDetails;l.forEach(function(y,h){var S=y.info,D=p.fragments[h];D.byteRange.length===0&&D.setByteRange(String(1+S.end-S.start)+"@"+String(S.start)),D.initSegment&&D.initSegment.setByteRange(String(c.moovEndOffset)+"@0")})}},k.handleManifestParsingError=function(m,o,c,l){this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:o.type===a.PlaylistContextType.MANIFEST,url:m.url,reason:c,response:m,context:o,networkDetails:l})},k.handleNetworkError=function(m,o,c,l){c===void 0&&(c=!1),f.logger.warn("[playlist-loader]: A network "+(c?"timeout":"error")+" occurred while loading "+m.type+" level: "+m.level+" id: "+m.id+' group-id: "'+m.groupId+'"');var p=s.ErrorDetails.UNKNOWN,y=!1,h=this.getInternalLoader(m);switch(m.type){case a.PlaylistContextType.MANIFEST:p=c?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,y=!0;break;case a.PlaylistContextType.LEVEL:p=c?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,y=!1;break;case a.PlaylistContextType.AUDIO_TRACK:p=c?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,y=!1;break;case a.PlaylistContextType.SUBTITLE_TRACK:p=c?s.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:s.ErrorDetails.SUBTITLE_LOAD_ERROR,y=!1}h&&this.resetInternalLoader(m.type);var S={type:s.ErrorTypes.NETWORK_ERROR,details:p,fatal:y,url:m.url,loader:h,context:m,networkDetails:o};l&&(S.response=l),this.hls.trigger(n.Events.ERROR,S)},k.handlePlaylistLoaded=function(m,o,c,l){var p=c.type,y=c.level,h=c.id,S=c.groupId,D=c.loader,A=c.levelDetails,R=c.deliveryDirectives;if(A!=null&&A.targetduration){if(D)switch(A.live&&(D.getCacheAge&&(A.ageHeader=D.getCacheAge()||0),D.getCacheAge&&!isNaN(A.ageHeader)||(A.ageHeader=0)),p){case a.PlaylistContextType.MANIFEST:case a.PlaylistContextType.LEVEL:this.hls.trigger(n.Events.LEVEL_LOADED,{details:A,level:y||0,id:h||0,stats:o,networkDetails:l,deliveryDirectives:R});break;case a.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(n.Events.AUDIO_TRACK_LOADED,{details:A,id:h||0,groupId:S||"",stats:o,networkDetails:l,deliveryDirectives:R});break;case a.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADED,{details:A,id:h||0,groupId:S||"",stats:o,networkDetails:l,deliveryDirectives:R})}}else this.handleManifestParsingError(m,c,"invalid target duration",l)},L}();t.default=d},"./src/polyfills/number.ts":function(e,t,r){r.r(t),r.d(t,"isFiniteNumber",function(){return i}),r.d(t,"MAX_SAFE_INTEGER",function(){return n});var i=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(e,t,r){r.r(t);var i=function(){function n(){}return n.getSilentFrame=function(s,f){switch(s){case"mp4a.40.2":if(f===1)return new Uint8Array([0,200,0,128,35,128]);if(f===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(f===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(f===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(f===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(f===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(f===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},n}();t.default=i},"./src/remux/mp4-generator.ts":function(e,t,r){r.r(t);var i=Math.pow(2,32)-1,n=function(){function s(){}return s.init=function(){var f;for(f in s.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},s.types)s.types.hasOwnProperty(f)&&(s.types[f]=[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3)]);var _=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),b=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);s.HDLR_TYPES={video:_,audio:b};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),E=new Uint8Array([0,0,0,0,0,0,0,0]);s.STTS=s.STSC=s.STCO=E,s.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),s.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),s.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),s.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var v=new Uint8Array([105,115,111,109]),d=new Uint8Array([97,118,99,49]),L=new Uint8Array([0,0,0,1]);s.FTYP=s.box(s.types.ftyp,v,L,v,d),s.DINF=s.box(s.types.dinf,s.box(s.types.dref,a))},s.box=function(f){for(var _=8,b=arguments.length,a=new Array(b>1?b-1:0),E=1;E<b;E++)a[E-1]=arguments[E];for(var v=a.length,d=v;v--;)_+=a[v].byteLength;var L=new Uint8Array(_);for(L[0]=_>>24&255,L[1]=_>>16&255,L[2]=_>>8&255,L[3]=255&_,L.set(f,4),v=0,_=8;v<d;v++)L.set(a[v],_),_+=a[v].byteLength;return L},s.hdlr=function(f){return s.box(s.types.hdlr,s.HDLR_TYPES[f])},s.mdat=function(f){return s.box(s.types.mdat,f)},s.mdhd=function(f,_){_*=f;var b=Math.floor(_/(i+1)),a=Math.floor(_%(i+1));return s.box(s.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,f>>24&255,f>>16&255,f>>8&255,255&f,b>>24,b>>16&255,b>>8&255,255&b,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},s.mdia=function(f){return s.box(s.types.mdia,s.mdhd(f.timescale,f.duration),s.hdlr(f.type),s.minf(f))},s.mfhd=function(f){return s.box(s.types.mfhd,new Uint8Array([0,0,0,0,f>>24,f>>16&255,f>>8&255,255&f]))},s.minf=function(f){return f.type==="audio"?s.box(s.types.minf,s.box(s.types.smhd,s.SMHD),s.DINF,s.stbl(f)):s.box(s.types.minf,s.box(s.types.vmhd,s.VMHD),s.DINF,s.stbl(f))},s.moof=function(f,_,b){return s.box(s.types.moof,s.mfhd(f),s.traf(b,_))},s.moov=function(f){for(var _=f.length,b=[];_--;)b[_]=s.trak(f[_]);return s.box.apply(null,[s.types.moov,s.mvhd(f[0].timescale,f[0].duration)].concat(b).concat(s.mvex(f)))},s.mvex=function(f){for(var _=f.length,b=[];_--;)b[_]=s.trex(f[_]);return s.box.apply(null,[s.types.mvex].concat(b))},s.mvhd=function(f,_){_*=f;var b=Math.floor(_/(i+1)),a=Math.floor(_%(i+1)),E=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,f>>24&255,f>>16&255,f>>8&255,255&f,b>>24,b>>16&255,b>>8&255,255&b,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s.box(s.types.mvhd,E)},s.sdtp=function(f){var _,b,a=f.samples||[],E=new Uint8Array(4+a.length);for(_=0;_<a.length;_++)b=a[_].flags,E[_+4]=b.dependsOn<<4|b.isDependedOn<<2|b.hasRedundancy;return s.box(s.types.sdtp,E)},s.stbl=function(f){return s.box(s.types.stbl,s.stsd(f),s.box(s.types.stts,s.STTS),s.box(s.types.stsc,s.STSC),s.box(s.types.stsz,s.STSZ),s.box(s.types.stco,s.STCO))},s.avc1=function(f){var _,b,a,E=[],v=[];for(_=0;_<f.sps.length;_++)a=(b=f.sps[_]).byteLength,E.push(a>>>8&255),E.push(255&a),E=E.concat(Array.prototype.slice.call(b));for(_=0;_<f.pps.length;_++)a=(b=f.pps[_]).byteLength,v.push(a>>>8&255),v.push(255&a),v=v.concat(Array.prototype.slice.call(b));var d=s.box(s.types.avcC,new Uint8Array([1,E[3],E[4],E[5],255,224|f.sps.length].concat(E).concat([f.pps.length]).concat(v))),L=f.width,k=f.height,m=f.pixelRatio[0],o=f.pixelRatio[1];return s.box(s.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,L>>8&255,255&L,k>>8&255,255&k,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,s.box(s.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),s.box(s.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,255&m,o>>24,o>>16&255,o>>8&255,255&o])))},s.esds=function(f){var _=f.config.length;return new Uint8Array([0,0,0,0,3,23+_,0,1,0,4,15+_,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([_]).concat(f.config).concat([6,1,2]))},s.mp4a=function(f){var _=f.samplerate;return s.box(s.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f.channelCount,0,16,0,0,0,0,_>>8&255,255&_,0,0]),s.box(s.types.esds,s.esds(f)))},s.mp3=function(f){var _=f.samplerate;return s.box(s.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f.channelCount,0,16,0,0,0,0,_>>8&255,255&_,0,0]))},s.stsd=function(f){return f.type==="audio"?f.isAAC||f.codec!=="mp3"?s.box(s.types.stsd,s.STSD,s.mp4a(f)):s.box(s.types.stsd,s.STSD,s.mp3(f)):s.box(s.types.stsd,s.STSD,s.avc1(f))},s.tkhd=function(f){var _=f.id,b=f.duration*f.timescale,a=f.width,E=f.height,v=Math.floor(b/(i+1)),d=Math.floor(b%(i+1));return s.box(s.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_>>24&255,_>>16&255,_>>8&255,255&_,0,0,0,0,v>>24,v>>16&255,v>>8&255,255&v,d>>24,d>>16&255,d>>8&255,255&d,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,E>>8&255,255&E,0,0]))},s.traf=function(f,_){var b=s.sdtp(f),a=f.id,E=Math.floor(_/(i+1)),v=Math.floor(_%(i+1));return s.box(s.types.traf,s.box(s.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),s.box(s.types.tfdt,new Uint8Array([1,0,0,0,E>>24,E>>16&255,E>>8&255,255&E,v>>24,v>>16&255,v>>8&255,255&v])),s.trun(f,b.length+16+20+8+16+8+8),b)},s.trak=function(f){return f.duration=f.duration||4294967295,s.box(s.types.trak,s.tkhd(f),s.mdia(f))},s.trex=function(f){var _=f.id;return s.box(s.types.trex,new Uint8Array([0,0,0,0,_>>24,_>>16&255,_>>8&255,255&_,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},s.trun=function(f,_){var b,a,E,v,d,L,k=f.samples||[],m=k.length,o=12+16*m,c=new Uint8Array(o);for(_+=8+o,c.set([0,0,15,1,m>>>24&255,m>>>16&255,m>>>8&255,255&m,_>>>24&255,_>>>16&255,_>>>8&255,255&_],0),b=0;b<m;b++)E=(a=k[b]).duration,v=a.size,d=a.flags,L=a.cts,c.set([E>>>24&255,E>>>16&255,E>>>8&255,255&E,v>>>24&255,v>>>16&255,v>>>8&255,255&v,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,L>>>24&255,L>>>16&255,L>>>8&255,255&L],12+16*b);return s.box(s.types.trun,c)},s.initSegment=function(f){s.types||s.init();var _=s.moov(f),b=new Uint8Array(s.FTYP.byteLength+_.byteLength);return b.set(s.FTYP),b.set(_,s.FTYP.byteLength),b},s}();n.types=void 0,n.HDLR_TYPES=void 0,n.STTS=void 0,n.STSC=void 0,n.STCO=void 0,n.STSZ=void 0,n.VMHD=void 0,n.SMHD=void 0,n.STSD=void 0,n.FTYP=void 0,n.DINF=void 0,t.default=n},"./src/remux/mp4-remuxer.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return m}),r.d(t,"normalizePts",function(){return o});var i=r("./src/polyfills/number.ts"),n=r("./src/remux/aac-helper.ts"),s=r("./src/remux/mp4-generator.ts"),f=r("./src/events.ts"),_=r("./src/errors.ts"),b=r("./src/utils/logger.ts"),a=r("./src/types/loader.ts"),E=r("./src/utils/timescale-conversion.ts");function v(){return(v=Object.assign||function(p){for(var y=1;y<arguments.length;y++){var h=arguments[y];for(var S in h)Object.prototype.hasOwnProperty.call(h,S)&&(p[S]=h[S])}return p}).apply(this,arguments)}var d=null,L=null,k=!1,m=function(){function p(h,S,D,A){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=h,this.config=S,this.typeSupported=D,this.ISGenerated=!1,d===null){var R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);d=R?parseInt(R[1]):0}if(L===null){var u=navigator.userAgent.match(/Safari\/(\d+)/i);L=u?parseInt(u[1]):0}k=!!d&&d<75||!!L&&L<600}var y=p.prototype;return y.destroy=function(){},y.resetTimeStamp=function(h){b.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=h},y.resetNextTimestamp=function(){b.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},y.resetInitSegment=function(){b.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},y.getVideoStartPts=function(h){var S=!1,D=h.reduce(function(A,R){var u=R.pts-A;return u<-4294967296?(S=!0,o(A,R.pts)):u>0?A:R.pts},h[0].pts);return S&&b.logger.debug("PTS rollover detected"),D},y.remux=function(h,S,D,A,R,u,g,T){var C,w,I,O,x,P,F=R,N=R,U=h.pid>-1,G=S.pid>-1,V=S.samples.length,X=h.samples.length>0,j=V>1;if((!U||X)&&(!G||j)||this.ISGenerated||g){this.ISGenerated||(I=this.generateIS(h,S,R));var z=this.isVideoContiguous,W=-1;if(j&&(W=function(M){for(var B=0;B<M.length;B++)if(M[B].key)return B;return-1}(S.samples),!z&&this.config.forceKeyFrameOnDiscontinuity))if(P=!0,W>0){b.logger.warn("[mp4-remuxer]: Dropped "+W+" out of "+V+" video samples due to a missing keyframe");var $=this.getVideoStartPts(S.samples);S.samples=S.samples.slice(W),S.dropped+=W,N+=(S.samples[0].pts-$)/(S.timescale||9e4)}else W===-1&&(b.logger.warn("[mp4-remuxer]: No keyframe found out of "+V+" video samples"),P=!1);if(this.ISGenerated){if(X&&j){var ne=this.getVideoStartPts(S.samples),le=(o(h.samples[0].pts,ne)-ne)/S.inputTimeScale;F+=Math.max(0,le),N+=Math.max(0,-le)}if(X){if(h.samplerate||(b.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),I=this.generateIS(h,S,R)),w=this.remuxAudio(h,F,this.isAudioContiguous,u,G||j||T===a.PlaylistLevelType.AUDIO?N:void 0),j){var ae=w?w.endPTS-w.startPTS:0;S.inputTimeScale||(b.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),I=this.generateIS(h,S,R)),C=this.remuxVideo(S,N,z,ae)}}else j&&(C=this.remuxVideo(S,N,z,0));C&&(C.firstKeyFrame=W,C.independent=W!==-1)}}return this.ISGenerated&&(D.samples.length&&(x=this.remuxID3(D,R)),A.samples.length&&(O=this.remuxText(A,R))),{audio:w,video:C,initSegment:I,independent:P,text:O,id3:x}},y.generateIS=function(h,S,D){var A,R,u,g=h.samples,T=S.samples,C=this.typeSupported,w={},I=!Object(i.isFiniteNumber)(this._initPTS),O="audio/mp4";if(I&&(A=R=1/0),h.config&&g.length&&(h.timescale=h.samplerate,h.isAAC||(C.mpeg?(O="audio/mpeg",h.codec=""):C.mp3&&(h.codec="mp3")),w.audio={id:"audio",container:O,codec:h.codec,initSegment:!h.isAAC&&C.mpeg?new Uint8Array(0):s.default.initSegment([h]),metadata:{channelCount:h.channelCount}},I&&(u=h.inputTimeScale,A=R=g[0].pts-Math.round(u*D))),S.sps&&S.pps&&T.length&&(S.timescale=S.inputTimeScale,w.video={id:"main",container:"video/mp4",codec:S.codec,initSegment:s.default.initSegment([S]),metadata:{width:S.width,height:S.height}},I)){u=S.inputTimeScale;var x=this.getVideoStartPts(T),P=Math.round(u*D);R=Math.min(R,o(T[0].dts,x)-P),A=Math.min(A,x-P)}if(Object.keys(w).length)return this.ISGenerated=!0,I&&(this._initPTS=A,this._initDTS=R),{tracks:w,initPTS:A,timescale:u}},y.remuxVideo=function(h,S,D,A){var R,u,g,T=h.inputTimeScale,C=h.samples,w=[],I=C.length,O=this._initPTS,x=this.nextAvcDts,P=8,F=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,U=0,G=!1;D&&x!==null||(x=S*T-(C[0].pts-o(C[0].dts,C[0].pts)));for(var V=0;V<I;V++){var X=C[V];X.pts=o(X.pts-O,x),X.dts=o(X.dts-O,x),X.dts>X.pts&&(U=Math.max(Math.min(U,X.pts-X.dts),-18e3)),X.dts<C[V>0?V-1:V].dts&&(G=!0)}G&&C.sort(function(rt,Pt){var Na=rt.dts-Pt.dts,Ba=rt.pts-Pt.pts;return Na||Ba}),u=C[0].dts,g=C[C.length-1].dts;var j=Math.round((g-u)/(I-1));if(U<0){if(U<-2*j){b.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(E.toMsFromMpegTsClock)(-j,!0)+" ms");for(var z=U,W=0;W<I;W++)C[W].dts=z=Math.max(z,C[W].pts-j),C[W].pts=Math.max(z,C[W].pts)}else{b.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(E.toMsFromMpegTsClock)(U,!0)+" ms to overcome this issue");for(var $=0;$<I;$++)C[$].dts=C[$].dts+U}u=C[0].dts}if(D){var ne=u-x,le=ne>j;if(le||ne<-1){le?b.logger.warn("AVC: "+Object(E.toMsFromMpegTsClock)(ne,!0)+" ms ("+ne+"dts) hole between fragments detected, filling it"):b.logger.warn("AVC: "+Object(E.toMsFromMpegTsClock)(-ne,!0)+" ms ("+ne+"dts) overlapping between fragments detected"),u=x;var ae=C[0].pts-ne;C[0].dts=u,C[0].pts=ae,b.logger.log("Video: First PTS/DTS adjusted: "+Object(E.toMsFromMpegTsClock)(ae,!0)+"/"+Object(E.toMsFromMpegTsClock)(u,!0)+", delta: "+Object(E.toMsFromMpegTsClock)(ne,!0)+" ms")}}k&&(u=Math.max(0,u));for(var M=0,B=0,K=0;K<I;K++){for(var H=C[K],q=H.units,J=q.length,ee=0,Z=0;Z<J;Z++)ee+=q[Z].data.length;B+=ee,M+=J,H.length=ee,H.dts=Math.max(H.dts,u),H.pts=Math.max(H.pts,H.dts,0),F=Math.min(H.pts,F),N=Math.max(H.pts,N)}g=C[I-1].dts;var te,Q=B+4*M+8;try{te=new Uint8Array(Q)}catch{return void this.observer.emit(f.Events.ERROR,f.Events.ERROR,{type:_.ErrorTypes.MUX_ERROR,details:_.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Q,reason:"fail allocating video mdat "+Q})}var oe=new DataView(te.buffer);oe.setUint32(0,Q),te.set(s.default.types.mdat,4);for(var ie=0;ie<I;ie++){for(var se=C[ie],ce=se.units,de=0,me=0,ye=ce.length;me<ye;me++){var Se=ce[me],Le=Se.data,We=Se.data.byteLength;oe.setUint32(P,We),P+=4,te.set(Le,P),P+=We,de+=4+We}if(ie<I-1)R=C[ie+1].dts-se.dts;else{var ct=this.config,Be=se.dts-C[ie>0?ie-1:ie].dts;if(ct.stretchShortVideoTrack&&this.nextAudioPts!==null){var yt=Math.floor(ct.maxBufferHole*T),ke=(A?F+A*T:this.nextAudioPts)-se.pts;ke>yt?((R=ke-Be)<0&&(R=Be),b.logger.log("[mp4-remuxer]: It is approximately "+ke/90+" ms to the next segment; using duration "+R/90+" ms for the last video frame.")):R=Be}else R=Be}var Ie=Math.round(se.pts-se.dts);w.push(new c(se.key,R,de,Ie))}if(w.length&&d&&d<70){var Xe=w[0].flags;Xe.dependsOn=2,Xe.isNonSync=0}console.assert(R!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=x=g+R,this.isVideoContiguous=!0;var Ot={data1:s.default.moof(h.sequenceNumber++,u,v({},h,{samples:w})),data2:te,startPTS:F/T,endPTS:(N+R)/T,startDTS:u/T,endDTS:x/T,type:"video",hasAudio:!1,hasVideo:!0,nb:w.length,dropped:h.dropped};return h.samples=[],h.dropped=0,console.assert(te.length,"MDAT length must not be zero"),Ot},y.remuxAudio=function(h,S,D,A,R){var u=h.inputTimeScale,g=u/(h.samplerate?h.samplerate:u),T=h.isAAC?1024:1152,C=T*g,w=this._initPTS,I=!h.isAAC&&this.typeSupported.mpeg,O=[],x=h.samples,P=I?0:8,F=this.nextAudioPts||-1,N=S*u;if(this.isAudioContiguous=D=D||x.length&&F>0&&(A&&Math.abs(N-F)<9e3||Math.abs(o(x[0].pts-w,N)-F)<20*C),x.forEach(function(Le){Le.pts=o(Le.pts-w,N)}),!D||F<0){if(!(x=x.filter(function(Le){return Le.pts>=0})).length)return;F=R===0?0:A?Math.max(0,N):x[0].pts}if(h.isAAC)for(var U=R!==void 0,G=this.config.maxAudioFramesDrift,V=0,X=F;V<x.length;V++){var j=x[V],z=j.pts,W=z-X,$=Math.abs(1e3*W/u);if(W<=-G*C&&U)V===0&&(b.logger.warn("Audio frame @ "+(z/u).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*W/u)+" ms."),this.nextAudioPts=F=X=z);else if(W>=G*C&&$<1e4&&U){var ne=Math.round(W/C);(X=z-ne*C)<0&&(ne--,X+=C),V===0&&(this.nextAudioPts=F=X),b.logger.warn("[mp4-remuxer]: Injecting "+ne+" audio frame @ "+(X/u).toFixed(3)+"s due to "+Math.round(1e3*W/u)+" ms gap.");for(var le=0;le<ne;le++){var ae=Math.max(X,0),M=n.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);M||(b.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),M=j.unit.subarray()),x.splice(V,0,{unit:M,pts:ae}),X+=C,V++}}j.pts=X,X+=C}for(var B,K=null,H=null,q=0,J=x.length;J--;)q+=x[J].unit.byteLength;for(var ee=0,Z=x.length;ee<Z;ee++){var te=x[ee],Q=te.unit,oe=te.pts;if(H!==null)O[ee-1].duration=Math.round((oe-H)/g);else{if(D&&h.isAAC&&(oe=F),K=oe,!(q>0))return;q+=P;try{B=new Uint8Array(q)}catch{return void this.observer.emit(f.Events.ERROR,f.Events.ERROR,{type:_.ErrorTypes.MUX_ERROR,details:_.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:q,reason:"fail allocating audio mdat "+q})}I||(new DataView(B.buffer).setUint32(0,q),B.set(s.default.types.mdat,4))}B.set(Q,P);var ie=Q.byteLength;P+=ie,O.push(new c(!0,T,ie,0)),H=oe}var se=O.length;if(se){var ce=O[O.length-1];this.nextAudioPts=F=H+g*ce.duration;var de=I?new Uint8Array(0):s.default.moof(h.sequenceNumber++,K/g,v({},h,{samples:O}));h.samples=[];var me=K/u,ye=F/u,Se={data1:de,data2:B,startPTS:me,endPTS:ye,startDTS:me,endDTS:ye,type:"audio",hasAudio:!0,hasVideo:!1,nb:se};return this.isAudioContiguous=!0,console.assert(B.length,"MDAT length must not be zero"),Se}},y.remuxEmptyAudio=function(h,S,D,A){var R=h.inputTimeScale,u=R/(h.samplerate?h.samplerate:R),g=this.nextAudioPts,T=(g!==null?g:A.startDTS*R)+this._initDTS,C=A.endDTS*R+this._initDTS,w=1024*u,I=Math.ceil((C-T)/w),O=n.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);if(b.logger.warn("[mp4-remuxer]: remux empty Audio"),O){for(var x=[],P=0;P<I;P++){var F=T+P*w;x.push({unit:O,pts:F,dts:F})}return h.samples=x,this.remuxAudio(h,S,D,!1)}b.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},y.remuxID3=function(h,S){var D=h.samples.length;if(D){for(var A=h.inputTimeScale,R=this._initPTS,u=this._initDTS,g=0;g<D;g++){var T=h.samples[g];T.pts=o(T.pts-R,S*A)/A,T.dts=o(T.dts-u,S*A)/A}var C=h.samples;return h.samples=[],{samples:C}}},y.remuxText=function(h,S){var D=h.samples.length;if(D){for(var A=h.inputTimeScale,R=this._initPTS,u=0;u<D;u++){var g=h.samples[u];g.pts=o(g.pts-R,S*A)/A}h.samples.sort(function(C,w){return C.pts-w.pts});var T=h.samples;return h.samples=[],{samples:T}}},p}();function o(p,y){var h;if(y===null)return p;for(h=y<p?-8589934592:8589934592;Math.abs(p-y)>4294967296;)p+=h;return p}var c=function(p,y,h,S){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=y,this.size=h,this.cts=S,this.flags=new l(p)},l=function(p){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=p?2:1,this.isNonSync=p?0:1}},"./src/remux/passthrough-remuxer.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/utils/mp4-tools.ts"),s=r("./src/loader/fragment.ts"),f=r("./src/utils/logger.ts"),_=function(){function E(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var v=E.prototype;return v.destroy=function(){},v.resetTimeStamp=function(d){this.initPTS=d,this.lastEndDTS=null},v.resetNextTimestamp=function(){this.lastEndDTS=null},v.resetInitSegment=function(d,L,k){this.audioCodec=L,this.videoCodec=k,this.generateInitSegment(d),this.emitInitSegment=!0},v.generateInitSegment=function(d){var L=this.audioCodec,k=this.videoCodec;if(!d||!d.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var m=this.initData=Object(n.parseInitSegment)(d);L||(L=a(m.audio,s.ElementaryStreamTypes.AUDIO)),k||(k=a(m.video,s.ElementaryStreamTypes.VIDEO));var o={};m.audio&&m.video?o.audiovideo={container:"video/mp4",codec:L+","+k,initSegment:d,id:"main"}:m.audio?o.audio={container:"audio/mp4",codec:L,initSegment:d,id:"audio"}:m.video?o.video={container:"video/mp4",codec:k,initSegment:d,id:"main"}:f.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o},v.remux=function(d,L,k,m,o){var c=this.initPTS,l=this.lastEndDTS,p={audio:void 0,video:void 0,text:m,id3:k,initSegment:void 0};Object(i.isFiniteNumber)(l)||(l=this.lastEndDTS=o||0);var y=L.samples;if(!y||!y.length)return p;var h={initPTS:void 0,timescale:1},S=this.initData;if(S&&S.length||(this.generateInitSegment(y),S=this.initData),!S||!S.length)return f.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1),Object(i.isFiniteNumber)(c)||(this.initPTS=h.initPTS=c=b(S,y,l));var D=Object(n.getDuration)(y,S),A=l,R=D+A;Object(n.offsetStartDTS)(S,y,c),D>0?this.lastEndDTS=R:(f.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var u=!!S.audio,g=!!S.video,T="";u&&(T+="audio"),g&&(T+="video");var C={data1:y,startPTS:A,startDTS:A,endPTS:R,endDTS:R,type:T,hasAudio:u,hasVideo:g,nb:1,dropped:0};return p.audio=C.type==="audio"?C:void 0,p.video=C.type!=="audio"?C:void 0,p.text=m,p.id3=k,p.initSegment=h,p},E}(),b=function(E,v,d){return Object(n.getStartDTS)(E,v)-d};function a(E,v){var d=E==null?void 0:E.codec;return d&&d.length>4?d:d==="hvc1"?"hvc1.1.c.L120.90":d==="av01"?"av01.0.04M.08":d==="avc1"||v===s.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}t.default=_},"./src/task-loop.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var s=n.prototype;return s.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},s.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},s.onHandlerDestroyed=function(){},s.hasInterval=function(){return!!this._tickInterval},s.hasNextTick=function(){return!!this._tickTimer},s.setInterval=function(f){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,f),!0)},s.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},s.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},s.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},s.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},s.doTick=function(){},n}()},"./src/types/level.ts":function(e,t,r){function i(a,E){for(var v=0;v<E.length;v++){var d=E[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}var n,s;function f(a,E){var v=a.canSkipUntil,d=a.canSkipDateRanges,L=a.endSN;return v&&(E!==void 0?E-L:0)<v?d?n.v2:n.Yes:n.No}r.r(t),r.d(t,"HlsSkip",function(){return n}),r.d(t,"getSkipValue",function(){return f}),r.d(t,"HlsUrlParameters",function(){return _}),r.d(t,"Level",function(){return b}),(s=n||(n={})).No="",s.Yes="YES",s.v2="v2";var _=function(){function a(E,v,d){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=E,this.part=v,this.skip=d}return a.prototype.addDirectives=function(E){var v=new self.URL(E);return this.msn!==void 0&&v.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&v.searchParams.set("_HLS_part",this.part.toString()),this.skip&&v.searchParams.set("_HLS_skip",this.skip),v.toString()},a}(),b=function(){function a(d){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[d.url],this.attrs=d.attrs,this.bitrate=d.bitrate,d.details&&(this.details=d.details),this.id=d.id||0,this.name=d.name,this.width=d.width||0,this.height=d.height||0,this.audioCodec=d.audioCodec,this.videoCodec=d.videoCodec,this.unknownCodecs=d.unknownCodecs,this.codecSet=[d.videoCodec,d.audioCodec].filter(function(L){return L}).join(",").replace(/\.[^.,]+/g,"")}var E,v;return E=a,(v=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(d){var L=d%this.url.length;this._urlId!==L&&(this.details=void 0,this._urlId=L)}}])&&i(E.prototype,v),a}()},"./src/types/loader.ts":function(e,t,r){var i,n,s,f;r.r(t),r.d(t,"PlaylistContextType",function(){return i}),r.d(t,"PlaylistLevelType",function(){return s}),(n=i||(i={})).MANIFEST="manifest",n.LEVEL="level",n.AUDIO_TRACK="audioTrack",n.SUBTITLE_TRACK="subtitleTrack",(f=s||(s={})).MAIN="main",f.AUDIO="audio",f.SUBTITLE="subtitle"},"./src/types/transmuxer.ts":function(e,t,r){r.r(t),r.d(t,"ChunkMetadata",function(){return i});var i=function(n,s,f,_,b,a){_===void 0&&(_=0),b===void 0&&(b=-1),a===void 0&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=n,this.sn=s,this.id=f,this.size=_,this.part=b,this.partial=a}},"./src/utils/attr-list.ts":function(e,t,r){r.r(t),r.d(t,"AttrList",function(){return s});var i=/^(\d+)x(\d+)$/,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function f(b){for(var a in typeof b=="string"&&(b=f.parseAttrList(b)),b)b.hasOwnProperty(a)&&(this[a]=b[a])}var _=f.prototype;return _.decimalInteger=function(b){var a=parseInt(this[b],10);return a>Number.MAX_SAFE_INTEGER?1/0:a},_.hexadecimalInteger=function(b){if(this[b]){var a=(this[b]||"0x").slice(2);a=(1&a.length?"0":"")+a;for(var E=new Uint8Array(a.length/2),v=0;v<a.length/2;v++)E[v]=parseInt(a.slice(2*v,2*v+2),16);return E}return null},_.hexadecimalIntegerAsNumber=function(b){var a=parseInt(this[b],16);return a>Number.MAX_SAFE_INTEGER?1/0:a},_.decimalFloatingPoint=function(b){return parseFloat(this[b])},_.optionalFloat=function(b,a){var E=this[b];return E?parseFloat(E):a},_.enumeratedString=function(b){return this[b]},_.bool=function(b){return this[b]==="YES"},_.decimalResolution=function(b){var a=i.exec(this[b]);if(a!==null)return{width:parseInt(a[1],10),height:parseInt(a[2],10)}},f.parseAttrList=function(b){var a,E={};for(n.lastIndex=0;(a=n.exec(b))!==null;){var v=a[2];v.indexOf('"')===0&&v.lastIndexOf('"')===v.length-1&&(v=v.slice(1,-1)),E[a[1]]=v}return E},f}()},"./src/utils/binary-search.ts":function(e,t,r){r.r(t),t.default={search:function(i,n){for(var s=0,f=i.length-1,_=null,b=null;s<=f;){var a=n(b=i[_=(s+f)/2|0]);if(a>0)s=_+1;else{if(!(a<0))return b;f=_-1}}return null}}},"./src/utils/buffer-helper.ts":function(e,t,r){r.r(t),r.d(t,"BufferHelper",function(){return s});var i=r("./src/utils/logger.ts"),n={length:0,start:function(){return 0},end:function(){return 0}},s=function(){function f(){}return f.isBuffered=function(_,b){try{if(_){for(var a=f.getBuffered(_),E=0;E<a.length;E++)if(b>=a.start(E)&&b<=a.end(E))return!0}}catch{}return!1},f.bufferInfo=function(_,b,a){try{if(_){var E,v=f.getBuffered(_),d=[];for(E=0;E<v.length;E++)d.push({start:v.start(E),end:v.end(E)});return this.bufferedInfo(d,b,a)}}catch{}return{len:0,start:b,end:b,nextStart:void 0}},f.bufferedInfo=function(_,b,a){b=Math.max(0,b),_.sort(function(h,S){var D=h.start-S.start;return D||S.end-h.end});var E=[];if(a)for(var v=0;v<_.length;v++){var d=E.length;if(d){var L=E[d-1].end;_[v].start-L<a?_[v].end>L&&(E[d-1].end=_[v].end):E.push(_[v])}else E.push(_[v])}else E=_;for(var k,m=0,o=b,c=b,l=0;l<E.length;l++){var p=E[l].start,y=E[l].end;if(b+a>=p&&b<y)o=p,m=(c=y)-b;else if(b+a<p){k=p;break}}return{len:m,start:o||0,end:c||0,nextStart:k}},f.getBuffered=function(_){try{return _.buffered}catch(b){return i.logger.log("failed to get media.buffered",b),n}},f}()},"./src/utils/cea-608-parser.ts":function(e,t,r){r.r(t),r.d(t,"Row",function(){return p}),r.d(t,"CaptionScreen",function(){return y});var i,n,s=r("./src/utils/logger.ts"),f={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},_=function(R){var u=R;return f.hasOwnProperty(R)&&(u=f[R]),String.fromCharCode(u)},b=15,a=100,E={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},v={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},L={25:2,26:4,29:6,30:8,31:10,27:13,28:15},k=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(n=i||(i={}))[n.ERROR=0]="ERROR",n[n.TEXT=1]="TEXT",n[n.WARNING=2]="WARNING",n[n.INFO=2]="INFO",n[n.DEBUG=3]="DEBUG",n[n.DATA=3]="DATA";var m=function(){function R(){this.time=null,this.verboseLevel=i.ERROR}return R.prototype.log=function(u,g){this.verboseLevel>=u&&s.logger.log(this.time+" ["+u+"] "+g)},R}(),o=function(R){for(var u=[],g=0;g<R.length;g++)u.push(R[g].toString(16));return u},c=function(){function R(g,T,C,w,I){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=g||"white",this.underline=T||!1,this.italics=C||!1,this.background=w||"black",this.flash=I||!1}var u=R.prototype;return u.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},u.setStyles=function(g){for(var T=["foreground","underline","italics","background","flash"],C=0;C<T.length;C++){var w=T[C];g.hasOwnProperty(w)&&(this[w]=g[w])}},u.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},u.equals=function(g){return this.foreground===g.foreground&&this.underline===g.underline&&this.italics===g.italics&&this.background===g.background&&this.flash===g.flash},u.copy=function(g){this.foreground=g.foreground,this.underline=g.underline,this.italics=g.italics,this.background=g.background,this.flash=g.flash},u.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},R}(),l=function(){function R(g,T,C,w,I,O){this.uchar=void 0,this.penState=void 0,this.uchar=g||" ",this.penState=new c(T,C,w,I,O)}var u=R.prototype;return u.reset=function(){this.uchar=" ",this.penState.reset()},u.setChar=function(g,T){this.uchar=g,this.penState.copy(T)},u.setPenState=function(g){this.penState.copy(g)},u.equals=function(g){return this.uchar===g.uchar&&this.penState.equals(g.penState)},u.copy=function(g){this.uchar=g.uchar,this.penState.copy(g.penState)},u.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},R}(),p=function(){function R(g){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var T=0;T<a;T++)this.chars.push(new l);this.logger=g,this.pos=0,this.currPenState=new c}var u=R.prototype;return u.equals=function(g){for(var T=!0,C=0;C<a;C++)if(!this.chars[C].equals(g.chars[C])){T=!1;break}return T},u.copy=function(g){for(var T=0;T<a;T++)this.chars[T].copy(g.chars[T])},u.isEmpty=function(){for(var g=!0,T=0;T<a;T++)if(!this.chars[T].isEmpty()){g=!1;break}return g},u.setCursor=function(g){this.pos!==g&&(this.pos=g),this.pos<0?(this.logger.log(i.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>a&&(this.logger.log(i.DEBUG,"Too large cursor position "+this.pos),this.pos=a)},u.moveCursor=function(g){var T=this.pos+g;if(g>1)for(var C=this.pos+1;C<T+1;C++)this.chars[C].setPenState(this.currPenState);this.setCursor(T)},u.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},u.insertChar=function(g){g>=144&&this.backSpace();var T=_(g);this.pos>=a?this.logger.log(i.ERROR,"Cannot insert "+g.toString(16)+" ("+T+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(T,this.currPenState),this.moveCursor(1))},u.clearFromPos=function(g){var T;for(T=g;T<a;T++)this.chars[T].reset()},u.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},u.clearToEndOfRow=function(){this.clearFromPos(this.pos)},u.getTextString=function(){for(var g=[],T=!0,C=0;C<a;C++){var w=this.chars[C].uchar;w!==" "&&(T=!1),g.push(w)}return T?"":g.join("")},u.setPenStyles=function(g){this.currPenState.setStyles(g),this.chars[this.pos].setPenState(this.currPenState)},R}(),y=function(){function R(g){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var T=0;T<b;T++)this.rows.push(new p(g));this.logger=g,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var u=R.prototype;return u.reset=function(){for(var g=0;g<b;g++)this.rows[g].clear();this.currRow=14},u.equals=function(g){for(var T=!0,C=0;C<b;C++)if(!this.rows[C].equals(g.rows[C])){T=!1;break}return T},u.copy=function(g){for(var T=0;T<b;T++)this.rows[T].copy(g.rows[T])},u.isEmpty=function(){for(var g=!0,T=0;T<b;T++)if(!this.rows[T].isEmpty()){g=!1;break}return g},u.backSpace=function(){this.rows[this.currRow].backSpace()},u.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},u.insertChar=function(g){this.rows[this.currRow].insertChar(g)},u.setPen=function(g){this.rows[this.currRow].setPenStyles(g)},u.moveCursor=function(g){this.rows[this.currRow].moveCursor(g)},u.setCursor=function(g){this.logger.log(i.INFO,"setCursor: "+g),this.rows[this.currRow].setCursor(g)},u.setPAC=function(g){this.logger.log(i.INFO,"pacData = "+JSON.stringify(g));var T=g.row-1;if(this.nrRollUpRows&&T<this.nrRollUpRows-1&&(T=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==T){for(var C=0;C<b;C++)this.rows[C].clear();var w=this.currRow+1-this.nrRollUpRows,I=this.lastOutputScreen;if(I){var O=I.rows[w].cueStartTime,x=this.logger.time;if(O&&x!==null&&O<x)for(var P=0;P<this.nrRollUpRows;P++)this.rows[T-this.nrRollUpRows+P+1].copy(I.rows[w+P])}}this.currRow=T;var F=this.rows[this.currRow];if(g.indent!==null){var N=g.indent,U=Math.max(N-1,0);F.setCursor(g.indent),g.color=F.chars[U].penState.foreground}var G={foreground:g.color,underline:g.underline,italics:g.italics,background:"black",flash:!1};this.setPen(G)},u.setBkgData=function(g){this.logger.log(i.INFO,"bkgData = "+JSON.stringify(g)),this.backSpace(),this.setPen(g),this.insertChar(32)},u.setRollUpRows=function(g){this.nrRollUpRows=g},u.rollUp=function(){if(this.nrRollUpRows!==null){this.logger.log(i.TEXT,this.getDisplayText());var g=this.currRow+1-this.nrRollUpRows,T=this.rows.splice(g,1)[0];T.clear(),this.rows.splice(this.currRow,0,T),this.logger.log(i.INFO,"Rolling up")}else this.logger.log(i.DEBUG,"roll_up but nrRollUpRows not set yet")},u.getDisplayText=function(g){g=g||!1;for(var T=[],C="",w=-1,I=0;I<b;I++){var O=this.rows[I].getTextString();O&&(w=I+1,g?T.push("Row "+w+": '"+O+"'"):T.push(O.trim()))}return T.length>0&&(C=g?"["+T.join(" | ")+"]":T.join(`
`)),C},u.getTextAndFormat=function(){return this.rows},R}(),h=function(){function R(g,T,C){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=g,this.outputFilter=T,this.mode=null,this.verbose=0,this.displayedMemory=new y(C),this.nonDisplayedMemory=new y(C),this.lastOutputScreen=new y(C),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=C}var u=R.prototype;return u.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},u.getHandler=function(){return this.outputFilter},u.setHandler=function(g){this.outputFilter=g},u.setPAC=function(g){this.writeScreen.setPAC(g)},u.setBkgData=function(g){this.writeScreen.setBkgData(g)},u.setMode=function(g){g!==this.mode&&(this.mode=g,this.logger.log(i.INFO,"MODE="+g),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=g)},u.insertChars=function(g){for(var T=0;T<g.length;T++)this.writeScreen.insertChar(g[T]);var C=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(i.INFO,C+": "+this.writeScreen.getDisplayText(!0)),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(i.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},u.ccRCL=function(){this.logger.log(i.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},u.ccBS=function(){this.logger.log(i.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},u.ccAOF=function(){},u.ccAON=function(){},u.ccDER=function(){this.logger.log(i.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},u.ccRU=function(g){this.logger.log(i.INFO,"RU("+g+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(g)},u.ccFON=function(){this.logger.log(i.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},u.ccRDC=function(){this.logger.log(i.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},u.ccTR=function(){this.logger.log(i.INFO,"TR"),this.setMode("MODE_TEXT")},u.ccRTD=function(){this.logger.log(i.INFO,"RTD"),this.setMode("MODE_TEXT")},u.ccEDM=function(){this.logger.log(i.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},u.ccCR=function(){this.logger.log(i.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},u.ccENM=function(){this.logger.log(i.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},u.ccEOC=function(){if(this.logger.log(i.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var g=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=g,this.writeScreen=this.nonDisplayedMemory,this.logger.log(i.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},u.ccTO=function(g){this.logger.log(i.INFO,"TO("+g+") - Tab Offset"),this.writeScreen.moveCursor(g)},u.ccMIDROW=function(g){var T={flash:!1};if(T.underline=g%2==1,T.italics=g>=46,T.italics)T.foreground="white";else{var C=Math.floor(g/2)-16;T.foreground=["white","green","blue","cyan","red","yellow","magenta"][C]}this.logger.log(i.INFO,"MIDROW: "+JSON.stringify(T)),this.writeScreen.setPen(T)},u.outputDataUpdate=function(g){g===void 0&&(g=!1);var T=this.logger.time;T!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,T,this.lastOutputScreen),g&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:T):this.cueStartTime=T,this.lastOutputScreen.copy(this.displayedMemory))},u.cueSplitAtTime=function(g){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,g,this.displayedMemory),this.cueStartTime=g))},R}(),S=function(){function R(g,T,C){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var w=new m;this.channels=[null,new h(g,T,w),new h(g+1,C,w)],this.cmdHistory={a:null,b:null},this.logger=w}var u=R.prototype;return u.getHandler=function(g){return this.channels[g].getHandler()},u.setHandler=function(g,T){this.channels[g].setHandler(T)},u.addData=function(g,T){var C,w,I,O=!1;this.logger.time=g;for(var x=0;x<T.length;x+=2)if(w=127&T[x],I=127&T[x+1],w!==0||I!==0){if(this.logger.log(i.DATA,"["+o([T[x],T[x+1]])+"] -> ("+o([w,I])+")"),(C=this.parseCmd(w,I))||(C=this.parseMidrow(w,I)),C||(C=this.parsePAC(w,I)),C||(C=this.parseBackgroundAttributes(w,I)),!C&&(O=this.parseChars(w,I))){var P=this.currentChannel;P&&P>0?this.channels[P].insertChars(O):this.logger.log(i.WARNING,"No channel found yet. TEXT-MODE?")}C||O||this.logger.log(i.WARNING,"Couldn't parse cleaned data "+o([w,I])+" orig: "+o([T[x],T[x+1]]))}},u.parseCmd=function(g,T){var C=this.cmdHistory;if(!((g===20||g===28||g===21||g===29)&&T>=32&&T<=47||(g===23||g===31)&&T>=33&&T<=35))return!1;if(A(g,T,C))return D(null,null,C),this.logger.log(i.DEBUG,"Repeated command ("+o([g,T])+") is dropped"),!0;var w=g===20||g===21||g===23?1:2,I=this.channels[w];return g===20||g===21||g===28||g===29?T===32?I.ccRCL():T===33?I.ccBS():T===34?I.ccAOF():T===35?I.ccAON():T===36?I.ccDER():T===37?I.ccRU(2):T===38?I.ccRU(3):T===39?I.ccRU(4):T===40?I.ccFON():T===41?I.ccRDC():T===42?I.ccTR():T===43?I.ccRTD():T===44?I.ccEDM():T===45?I.ccCR():T===46?I.ccENM():T===47&&I.ccEOC():I.ccTO(T-32),D(g,T,C),this.currentChannel=w,!0},u.parseMidrow=function(g,T){var C=0;if((g===17||g===25)&&T>=32&&T<=47){if((C=g===17?1:2)!==this.currentChannel)return this.logger.log(i.ERROR,"Mismatch channel in midrow parsing"),!1;var w=this.channels[C];return!!w&&(w.ccMIDROW(T),this.logger.log(i.DEBUG,"MIDROW ("+o([g,T])+")"),!0)}return!1},u.parsePAC=function(g,T){var C,w=this.cmdHistory;if(!((g>=17&&g<=23||g>=25&&g<=31)&&T>=64&&T<=127||(g===16||g===24)&&T>=64&&T<=95))return!1;if(A(g,T,w))return D(null,null,w),!0;var I=g<=23?1:2;C=T>=64&&T<=95?I===1?E[g]:d[g]:I===1?v[g]:L[g];var O=this.channels[I];return!!O&&(O.setPAC(this.interpretPAC(C,T)),D(g,T,w),this.currentChannel=I,!0)},u.interpretPAC=function(g,T){var C,w={color:null,italics:!1,indent:null,underline:!1,row:g};return C=T>95?T-96:T-64,w.underline=(1&C)==1,C<=13?w.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(w.italics=!0,w.color="white"):w.indent=4*Math.floor((C-16)/2),w},u.parseChars=function(g,T){var C,w,I=null,O=null;if(g>=25?(C=2,O=g-8):(C=1,O=g),O>=17&&O<=19?(w=O===17?T+80:O===18?T+112:T+144,this.logger.log(i.INFO,"Special char '"+_(w)+"' in channel "+C),I=[w]):g>=32&&g<=127&&(I=T===0?[g]:[g,T]),I){var x=o(I);this.logger.log(i.DEBUG,"Char codes =  "+x.join(",")),D(g,T,this.cmdHistory)}return I},u.parseBackgroundAttributes=function(g,T){var C;if(!((g===16||g===24)&&T>=32&&T<=47||(g===23||g===31)&&T>=45&&T<=47))return!1;var w={};g===16||g===24?(C=Math.floor((T-32)/2),w.background=k[C],T%2==1&&(w.background=w.background+"_semi")):T===45?w.background="transparent":(w.foreground="black",T===47&&(w.underline=!0));var I=g<=23?1:2;return this.channels[I].setBkgData(w),D(g,T,this.cmdHistory),!0},u.reset=function(){for(var g=0;g<Object.keys(this.channels).length;g++){var T=this.channels[g];T&&T.reset()}this.cmdHistory={a:null,b:null}},u.cueSplitAtTime=function(g){for(var T=0;T<this.channels.length;T++){var C=this.channels[T];C&&C.cueSplitAtTime(g)}},R}();function D(R,u,g){g.a=R,g.b=u}function A(R,u,g){return g.a===R&&g.b===u}t.default=S},"./src/utils/codecs.ts":function(e,t,r){r.r(t),r.d(t,"isCodecType",function(){return n}),r.d(t,"isCodecSupportedInMp4",function(){return s});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function n(f,_){var b=i[_];return!!b&&b[f.slice(0,4)]===!0}function s(f,_){return MediaSource.isTypeSupported((_||"video")+'/mp4;codecs="'+f+'"')}},"./src/utils/cues.ts":function(e,t,r){r.r(t);var i=r("./src/utils/vttparser.ts"),n=r("./src/utils/webvtt-parser.ts"),s=r("./src/utils/texttrack-utils.ts"),f=/\s/,_={newCue:function(b,a,E,v){for(var d,L,k,m,o,c=[],l=self.VTTCue||self.TextTrackCue,p=0;p<v.rows.length;p++)if(k=!0,m=0,o="",!(d=v.rows[p]).isEmpty()){for(var y=0;y<d.chars.length;y++)f.test(d.chars[y].uchar)&&k?m++:(o+=d.chars[y].uchar,k=!1);d.cueStartTime=a,a===E&&(E+=1e-4),m>=16?m--:m++;var h=Object(i.fixLineBreaks)(o.trim()),S=Object(n.generateCueId)(a,E,h);b&&b.cues&&b.cues.getCueById(S)||((L=new l(a,E,h)).id=S,L.line=p+1,L.align="left",L.position=10+Math.min(80,10*Math.floor(8*m/32)),c.push(L))}return b&&c.length&&(c.sort(function(D,A){return D.line==="auto"||A.line==="auto"?0:D.line>8&&A.line>8?A.line-D.line:D.line-A.line}),c.forEach(function(D){return Object(s.addCueToTrack)(b,D)})),c}};t.default=_},"./src/utils/discontinuities.ts":function(e,t,r){r.r(t),r.d(t,"findFirstFragWithCC",function(){return f}),r.d(t,"shouldAlignOnDiscontinuities",function(){return _}),r.d(t,"findDiscontinuousReferenceFrag",function(){return b}),r.d(t,"adjustSlidingStart",function(){return E}),r.d(t,"alignStream",function(){return v}),r.d(t,"alignPDT",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/logger.ts"),s=r("./src/controller/level-helper.ts");function f(L,k){for(var m=null,o=0,c=L.length;o<c;o++){var l=L[o];if(l&&l.cc===k){m=l;break}}return m}function _(L,k,m){return!(!k.details||!(m.endCC>m.startCC||L&&L.cc<m.startCC))}function b(L,k){var m=L.fragments,o=k.fragments;if(o.length&&m.length){var c=f(m,o[0].cc);if(c&&(!c||c.startPTS))return c;n.logger.log("No frag in previous level to align on")}else n.logger.log("No fragments to align")}function a(L,k){if(L){var m=L.start+k;L.start=L.startPTS=m,L.endPTS=m+L.duration}}function E(L,k){for(var m=k.fragments,o=0,c=m.length;o<c;o++)a(m[o],L);k.fragmentHint&&a(k.fragmentHint,L),k.alignedSliding=!0}function v(L,k,m){k&&(function(o,c,l){if(_(o,l,c)){var p=b(l.details,c);p&&Object(i.isFiniteNumber)(p.start)&&(n.logger.log("Adjusting PTS using last level due to CC increase within current level "+c.url),E(p.start,c))}}(L,m,k),!m.alignedSliding&&k.details&&d(m,k.details),m.alignedSliding||!k.details||m.skippedSegments||Object(s.adjustSliding)(k.details,m))}function d(L,k){if(k.fragments.length&&L.hasProgramDateTime&&k.hasProgramDateTime){var m=k.fragments[0].programDateTime,o=L.fragments[0].programDateTime,c=(o-m)/1e3+k.fragments[0].start;c&&Object(i.isFiniteNumber)(c)&&(n.logger.log("Adjusting PTS using programDateTime delta "+(o-m)+"ms, sliding:"+c.toFixed(3)+" "+L.url+" "),E(c,L))}}},"./src/utils/ewma-bandwidth-estimator.ts":function(e,t,r){r.r(t);var i=r("./src/utils/ewma.ts"),n=function(){function s(_,b,a){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(_),this.fast_=new i.default(b)}var f=s.prototype;return f.update=function(_,b){var a=this.slow_,E=this.fast_;this.slow_.halfLife!==_&&(this.slow_=new i.default(_,a.getEstimate(),a.getTotalWeight())),this.fast_.halfLife!==b&&(this.fast_=new i.default(b,E.getEstimate(),E.getTotalWeight()))},f.sample=function(_,b){var a=(_=Math.max(_,this.minDelayMs_))/1e3,E=8*b/a;this.fast_.sample(a,E),this.slow_.sample(a,E)},f.canEstimate=function(){var _=this.fast_;return _&&_.getTotalWeight()>=this.minWeight_},f.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},f.destroy=function(){},s}();t.default=n},"./src/utils/ewma.ts":function(e,t,r){r.r(t);var i=function(){function n(f,_,b){_===void 0&&(_=0),b===void 0&&(b=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=f,this.alpha_=f?Math.exp(Math.log(.5)/f):0,this.estimate_=_,this.totalWeight_=b}var s=n.prototype;return s.sample=function(f,_){var b=Math.pow(this.alpha_,f);this.estimate_=_*(1-b)+b*this.estimate_,this.totalWeight_+=f},s.getTotalWeight=function(){return this.totalWeight_},s.getEstimate=function(){if(this.alpha_){var f=1-Math.pow(this.alpha_,this.totalWeight_);if(f)return this.estimate_/f}return this.estimate_},n}();t.default=i},"./src/utils/fetch-loader.ts":function(e,t,r){r.r(t),r.d(t,"fetchSupported",function(){return v});var i=r("./src/polyfills/number.ts"),n=r("./src/loader/load-stats.ts"),s=r("./src/demux/chunk-cache.ts");function f(m){var o=typeof Map=="function"?new Map:void 0;return(f=function(c){if(c===null||(l=c,Function.toString.call(l).indexOf("[native code]")===-1))return c;var l;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(c))return o.get(c);o.set(c,p)}function p(){return _(c,arguments,E(this).constructor)}return p.prototype=Object.create(c.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),a(p,c)})(m)}function _(m,o,c){return(_=b()?Reflect.construct:function(l,p,y){var h=[null];h.push.apply(h,p);var S=new(Function.bind.apply(l,h));return y&&a(S,y.prototype),S}).apply(null,arguments)}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(m,o){return(a=Object.setPrototypeOf||function(c,l){return c.__proto__=l,c})(m,o)}function E(m){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(m)}function v(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var d=function(){function m(c){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=c.fetchSetup||L,this.controller=new self.AbortController,this.stats=new n.LoadStats}var o=m.prototype;return o.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function(){var c=this.response;c&&c.ok||(this.stats.aborted=!0,this.controller.abort())},o.abort=function(){var c;this.abortInternal(),(c=this.callbacks)!==null&&c!==void 0&&c.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function(c,l,p){var y=this,h=this.stats;if(h.loading.start)throw new Error("Loader can only be used once.");h.loading.start=self.performance.now();var S=function(u,g){var T={method:"GET",mode:"cors",credentials:"same-origin",signal:g};return u.rangeEnd&&(T.headers=new self.Headers({Range:"bytes="+u.rangeStart+"-"+String(u.rangeEnd-1)})),T}(c,this.controller.signal),D=p.onProgress,A=c.responseType==="arraybuffer",R=A?"byteLength":"length";this.context=c,this.config=l,this.callbacks=p,this.request=this.fetchSetup(c,S),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){y.abortInternal(),p.onTimeout(h,c,y.response)},l.timeout),self.fetch(this.request).then(function(u){if(y.response=y.loader=u,!u.ok){var g=u.status,T=u.statusText;throw new k(T||"fetch, bad network response",g,u)}return h.loading.first=Math.max(self.performance.now(),h.loading.start),h.total=parseInt(u.headers.get("Content-Length")||"0"),D&&Object(i.isFiniteNumber)(l.highWaterMark)?y.loadProgressively(u,h,c,l.highWaterMark,D):A?u.arrayBuffer():u.text()}).then(function(u){var g=y.response;self.clearTimeout(y.requestTimeout),h.loading.end=Math.max(self.performance.now(),h.loading.first),h.loaded=h.total=u[R];var T={url:g.url,data:u};D&&!Object(i.isFiniteNumber)(l.highWaterMark)&&D(h,c,u,g),p.onSuccess(T,h,c,g)}).catch(function(u){if(self.clearTimeout(y.requestTimeout),!h.aborted){var g=u.code||0;p.onError({code:g,text:u.message},c,u.details)}})},o.getCacheAge=function(){var c=null;if(this.response){var l=this.response.headers.get("age");c=l?parseFloat(l):null}return c},o.loadProgressively=function(c,l,p,y,h){y===void 0&&(y=0);var S=new s.default,D=c.body.getReader();return function A(){return D.read().then(function(R){if(R.done)return S.dataLength&&h(l,p,S.flush(),c),Promise.resolve(new ArrayBuffer(0));var u=R.value,g=u.length;return l.loaded+=g,g<y||S.dataLength?(S.push(u),S.dataLength>=y&&h(l,p,S.flush(),c)):h(l,p,u,c),A()}).catch(function(){return Promise.reject()})}()},m}();function L(m,o){return new self.Request(m.url,o)}var k=function(m){var o,c;function l(p,y,h){var S;return(S=m.call(this,p)||this).code=void 0,S.details=void 0,S.code=y,S.details=h,S}return c=m,(o=l).prototype=Object.create(c.prototype),o.prototype.constructor=o,a(o,c),l}(f(Error));t.default=d},"./src/utils/imsc1-ttml-parser.ts":function(e,t,r){r.r(t),r.d(t,"IMSC1_CODEC",function(){return E}),r.d(t,"parseIMSC1",function(){return k});var i=r("./src/utils/mp4-tools.ts"),n=r("./src/utils/vttparser.ts"),s=r("./src/utils/vttcue.ts"),f=r("./src/demux/id3.ts"),_=r("./src/utils/timescale-conversion.ts"),b=r("./src/utils/webvtt-parser.ts");function a(){return(a=Object.assign||function(h){for(var S=1;S<arguments.length;S++){var D=arguments[S];for(var A in D)Object.prototype.hasOwnProperty.call(D,A)&&(h[A]=D[A])}return h}).apply(this,arguments)}var E="stpp.ttml.im1t",v=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,d=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,L={left:"start",center:"center",right:"end",start:"start",end:"end"};function k(h,S,D,A,R){var u=Object(i.findBox)(new Uint8Array(h),["mdat"]);if(u.length!==0){var g=u[0],T=Object(f.utf8ArrayToStr)(new Uint8Array(h,g.start,g.end-g.start)),C=Object(_.toTimescaleFromScale)(S,1,D);try{A(function(w,I){var O=new DOMParser().parseFromString(w,"text/xml").getElementsByTagName("tt")[0];if(!O)throw new Error("Invalid ttml");var x={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(x).reduce(function(V,X){return V[X]=O.getAttribute("ttp:"+X)||x[X],V},{}),F=O.getAttribute("xml:space")!=="preserve",N=o(m(O,"styling","style")),U=o(m(O,"layout","region")),G=m(O,"body","[begin]");return[].map.call(G,function(V){var X=c(V,F);if(!X||!V.hasAttribute("begin"))return null;var j=y(V.getAttribute("begin"),P),z=y(V.getAttribute("dur"),P),W=y(V.getAttribute("end"),P);if(j===null)throw p(V);if(W===null){if(z===null)throw p(V);W=j+z}var $=new s.default(j-I,W-I,X);$.id=Object(b.generateCueId)($.startTime,$.endTime,$.text);var ne=U[V.getAttribute("region")],le=N[V.getAttribute("style")];$.position=10,$.size=80;var ae=function(K,H){var q="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(J,ee){var Z=l(H,q,ee)||l(K,q,ee);return Z&&(J[ee]=Z),J},{})}(ne,le),M=ae.textAlign;if(M){var B=L[M];B&&($.lineAlign=B),$.align=M}return a($,ae),$}).filter(function(V){return V!==null})}(T,C))}catch(w){R(w)}}else R(new Error("Could not parse IMSC1 mdat"))}function m(h,S,D){var A=h.getElementsByTagName(S)[0];return A?[].slice.call(A.querySelectorAll(D)):[]}function o(h){return h.reduce(function(S,D){var A=D.getAttribute("xml:id");return A&&(S[A]=D),S},{})}function c(h,S){return[].slice.call(h.childNodes).reduce(function(D,A,R){var u;return A.nodeName==="br"&&R?D+`
`:(u=A.childNodes)!==null&&u!==void 0&&u.length?c(A,S):S?D+A.textContent.trim().replace(/\s+/g," "):D+A.textContent},"")}function l(h,S,D){return h.hasAttributeNS(S,D)?h.getAttributeNS(S,D):null}function p(h){return new Error("Could not parse ttml timestamp "+h)}function y(h,S){if(!h)return null;var D=Object(n.parseTimeStamp)(h);return D===null&&(v.test(h)?D=function(A,R){var u=v.exec(A),g=(0|u[4])+(0|u[5])/R.subFrameRate;return 3600*(0|u[1])+60*(0|u[2])+(0|u[3])+g/R.frameRate}(h,S):d.test(h)&&(D=function(A,R){var u=d.exec(A),g=Number(u[1]);switch(u[2]){case"h":return 3600*g;case"m":return 60*g;case"ms":return 1e3*g;case"f":return g/R.frameRate;case"t":return g/R.tickRate}return g}(h,S))),D}},"./src/utils/logger.ts":function(e,t,r){r.r(t),r.d(t,"enableLogs",function(){return _}),r.d(t,"logger",function(){return b});var i=function(){},n={trace:i,debug:i,log:i,warn:i,info:i,error:i},s=n;function f(a){var E=self.console[a];return E?E.bind(self.console,"["+a+"] >"):i}function _(a){if(self.console&&a===!0||typeof a=="object"){(function(E){for(var v=arguments.length,d=new Array(v>1?v-1:0),L=1;L<v;L++)d[L-1]=arguments[L];d.forEach(function(k){s[k]=E[k]?E[k].bind(E):f(k)})})(a,"debug","log","info","warn","error");try{s.log()}catch{s=n}}else s=n}var b=n},"./src/utils/mediakeys-helper.ts":function(e,t,r){var i,n;r.r(t),r.d(t,"KeySystems",function(){return i}),r.d(t,"requestMediaKeySystemAccess",function(){return s}),(n=i||(i={})).WIDEVINE="com.widevine.alpha",n.PLAYREADY="com.microsoft.playready";var s=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(e,t,r){function i(){return self.MediaSource||self.WebKitMediaSource}r.r(t),r.d(t,"getMediaSource",function(){return i})},"./src/utils/mp4-tools.ts":function(e,t,r){r.r(t),r.d(t,"bin2str",function(){return _}),r.d(t,"readUint16",function(){return b}),r.d(t,"readUint32",function(){return a}),r.d(t,"writeUint32",function(){return E}),r.d(t,"findBox",function(){return v}),r.d(t,"parseSegmentIndex",function(){return d}),r.d(t,"parseInitSegment",function(){return L}),r.d(t,"getStartDTS",function(){return k}),r.d(t,"getDuration",function(){return m}),r.d(t,"computeRawDurationFromSamples",function(){return o}),r.d(t,"offsetStartDTS",function(){return c}),r.d(t,"segmentValidRange",function(){return l}),r.d(t,"appendUint8Array",function(){return p});var i=r("./src/utils/typed-array.ts"),n=r("./src/loader/fragment.ts"),s=Math.pow(2,32)-1,f=[].push;function _(y){return String.fromCharCode.apply(null,y)}function b(y,h){"data"in y&&(h+=y.start,y=y.data);var S=y[h]<<8|y[h+1];return S<0?65536+S:S}function a(y,h){"data"in y&&(h+=y.start,y=y.data);var S=y[h]<<24|y[h+1]<<16|y[h+2]<<8|y[h+3];return S<0?4294967296+S:S}function E(y,h,S){"data"in y&&(h+=y.start,y=y.data),y[h]=S>>24,y[h+1]=S>>16&255,y[h+2]=S>>8&255,y[h+3]=255&S}function v(y,h){var S,D,A,R=[];if(!h.length)return R;"data"in y?(S=y.data,D=y.start,A=y.end):(D=0,A=(S=y).byteLength);for(var u=D;u<A;){var g=a(S,u),T=g>1?u+g:A;if(_(S.subarray(u+4,u+8))===h[0])if(h.length===1)R.push({data:S,start:u+8,end:T});else{var C=v({data:S,start:u+8,end:T},h.slice(1));C.length&&f.apply(R,C)}u=T}return R}function d(y){var h=v(y,["moov"])[0],S=h?h.end:null,D=v(y,["sidx"]);if(!D||!D[0])return null;var A=[],R=D[0],u=R.data[0],g=u===0?8:16,T=a(R,g);g+=4,g+=u===0?8:16,g+=2;var C=R.end+0,w=b(R,g);g+=2;for(var I=0;I<w;I++){var O=g,x=a(R,O);O+=4;var P=2147483647&x;if((2147483648&x)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var F=a(R,O);O+=4,A.push({referenceSize:P,subsegmentDuration:F,info:{duration:F/T,start:C,end:C+P-1}}),C+=P,g=O+=4}return{earliestPresentationTime:0,timescale:T,version:u,referencesCount:w,references:A,moovEndOffset:S}}function L(y){for(var h=[],S=v(y,["moov","trak"]),D=0;D<S.length;D++){var A=S[D],R=v(A,["tkhd"])[0];if(R){var u=R.data[R.start],g=u===0?12:20,T=a(R,g),C=v(A,["mdia","mdhd"])[0];if(C){var w=a(C,g=(u=C.data[C.start])===0?12:20),I=v(A,["mdia","hdlr"])[0];if(I){var O=_(I.data.subarray(I.start+8,I.start+12)),x={soun:n.ElementaryStreamTypes.AUDIO,vide:n.ElementaryStreamTypes.VIDEO}[O];if(x){var P=v(A,["mdia","minf","stbl","stsd"])[0],F=void 0;P&&(F=_(P.data.subarray(P.start+12,P.start+16))),h[T]={timescale:w,type:x},h[x]={timescale:w,id:T,codec:F}}}}}}return v(y,["moov","mvex","trex"]).forEach(function(N){var U=a(N,4),G=h[U];G&&(G.default={duration:a(N,12),flags:a(N,20)})}),h}function k(y,h){return v(h,["moof","traf"]).reduce(function(S,D){var A=v(D,["tfdt"])[0],R=A.data[A.start],u=v(D,["tfhd"]).reduce(function(g,T){var C=a(T,4),w=y[C];if(w){var I=a(A,4);R===1&&(I*=Math.pow(2,32),I+=a(A,8));var O=I/(w.timescale||9e4);if(isFinite(O)&&(g===null||O<g))return O}return g},null);return u!==null&&isFinite(u)&&(S===null||u<S)?u:S},null)||0}function m(y,h){for(var S=0,D=0,A=0,R=v(y,["moof","traf"]),u=0;u<R.length;u++){var g=R[u],T=v(g,["tfhd"])[0],C=h[a(T,4)];if(C){var w=C.default,I=a(T,0)|(w==null?void 0:w.flags),O=w==null?void 0:w.duration;8&I&&(O=a(T,2&I?12:8));for(var x=C.timescale||9e4,P=v(g,["trun"]),F=0;F<P.length;F++)S=O?O*a(P[F],4):o(P[F]),C.type===n.ElementaryStreamTypes.VIDEO?D+=S/x:C.type===n.ElementaryStreamTypes.AUDIO&&(A+=S/x)}}if(D===0&&A===0){var N=d(y);if(N!=null&&N.references)return N.references.reduce(function(U,G){return U+G.info.duration||0},0)}return D||A}function o(y){var h=a(y,0),S=8;1&h&&(S+=4),4&h&&(S+=4);for(var D=0,A=a(y,4),R=0;R<A;R++)256&h&&(D+=a(y,S),S+=4),512&h&&(S+=4),1024&h&&(S+=4),2048&h&&(S+=4);return D}function c(y,h,S){v(h,["moof","traf"]).forEach(function(D){v(D,["tfhd"]).forEach(function(A){var R=a(A,4),u=y[R];if(u){var g=u.timescale||9e4;v(D,["tfdt"]).forEach(function(T){var C=T.data[T.start],w=a(T,4);if(C===0)E(T,4,w-S*g);else{w*=Math.pow(2,32),w+=a(T,8),w-=S*g,w=Math.max(w,0);var I=Math.floor(w/(s+1)),O=Math.floor(w%(s+1));E(T,4,I),E(T,8,O)}})}})})}function l(y){var h={valid:null,remainder:null},S=v(y,["moof"]);if(!S)return h;if(S.length<2)return h.remainder=y,h;var D=S[S.length-1];return h.valid=Object(i.sliceUint8)(y,0,D.start-8),h.remainder=Object(i.sliceUint8)(y,D.start-8),h}function p(y,h){var S=new Uint8Array(y.length+h.length);return S.set(y),S.set(h,y.length),S}},"./src/utils/output-filter.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(f,_){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=f,this.trackName=_}var s=n.prototype;return s.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},s.newCue=function(f,_,b){(this.startTime===null||this.startTime>f)&&(this.startTime=f),this.endTime=_,this.screen=b,this.timelineController.createCaptionsTrack(this.trackName)},s.reset=function(){this.cueRanges=[]},n}()},"./src/utils/texttrack-utils.ts":function(e,t,r){r.r(t),r.d(t,"sendAddTrackEvent",function(){return n}),r.d(t,"addCueToTrack",function(){return s}),r.d(t,"clearCurrentCues",function(){return f}),r.d(t,"removeCuesInRange",function(){return _}),r.d(t,"getCuesInRange",function(){return b});var i=r("./src/utils/logger.ts");function n(a,E){var v;try{v=new Event("addtrack")}catch{(v=document.createEvent("Event")).initEvent("addtrack",!1,!1)}v.track=a,E.dispatchEvent(v)}function s(a,E){var v=a.mode;if(v==="disabled"&&(a.mode="hidden"),a.cues&&!a.cues.getCueById(E.id))try{if(a.addCue(E),!a.cues.getCueById(E.id))throw new Error("addCue is failed for: "+E)}catch(L){i.logger.debug("[texttrack-utils]: "+L);var d=new self.TextTrackCue(E.startTime,E.endTime,E.text);d.id=E.id,a.addCue(d)}v==="disabled"&&(a.mode=v)}function f(a){var E=a.mode;if(E==="disabled"&&(a.mode="hidden"),a.cues)for(var v=a.cues.length;v--;)a.removeCue(a.cues[v]);E==="disabled"&&(a.mode=E)}function _(a,E,v){var d=a.mode;if(d==="disabled"&&(a.mode="hidden"),a.cues&&a.cues.length>0)for(var L=b(a.cues,E,v),k=0;k<L.length;k++)a.removeCue(L[k]);d==="disabled"&&(a.mode=d)}function b(a,E,v){var d=[],L=function(c,l){if(l<c[0].startTime)return 0;var p=c.length-1;if(l>c[p].endTime)return-1;for(var y=0,h=p;y<=h;){var S=Math.floor((h+y)/2);if(l<c[S].startTime)h=S-1;else{if(!(l>c[S].startTime&&y<p))return S;y=S+1}}return c[y].startTime-l<l-c[h].startTime?y:h}(a,E);if(L>-1)for(var k=L,m=a.length;k<m;k++){var o=a[k];if(o.startTime>=E&&o.endTime<=v)d.push(o);else if(o.startTime>v)return d}return d}},"./src/utils/time-ranges.ts":function(e,t,r){r.r(t),t.default={toString:function(i){for(var n="",s=i.length,f=0;f<s;f++)n+="["+i.start(f).toFixed(3)+","+i.end(f).toFixed(3)+"]";return n}}},"./src/utils/timescale-conversion.ts":function(e,t,r){function i(_,b,a,E){a===void 0&&(a=1),E===void 0&&(E=!1);var v=_*b*a;return E?Math.round(v):v}function n(_,b,a,E){return a===void 0&&(a=1),E===void 0&&(E=!1),i(_,b,1/a,E)}function s(_,b){return b===void 0&&(b=!1),i(_,1e3,1/9e4,b)}function f(_,b){return b===void 0&&(b=1),i(_,9e4,1/b)}r.r(t),r.d(t,"toTimescaleFromBase",function(){return i}),r.d(t,"toTimescaleFromScale",function(){return n}),r.d(t,"toMsFromMpegTsClock",function(){return s}),r.d(t,"toMpegTsClockFromTimescale",function(){return f})},"./src/utils/typed-array.ts":function(e,t,r){function i(n,s,f){return Uint8Array.prototype.slice?n.slice(s,f):new Uint8Array(Array.prototype.slice.call(n,s,f))}r.r(t),r.d(t,"sliceUint8",function(){return i})},"./src/utils/vttcue.ts":function(e,t,r){r.r(t),t.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var i=["","lr","rl"],n=["start","middle","end","left","right"];function s(a,E){if(typeof E!="string"||!Array.isArray(a))return!1;var v=E.toLowerCase();return!!~a.indexOf(v)&&v}function f(a){return s(n,a)}function _(a){for(var E=arguments.length,v=new Array(E>1?E-1:0),d=1;d<E;d++)v[d-1]=arguments[d];for(var L=1;L<arguments.length;L++){var k=arguments[L];for(var m in k)a[m]=k[m]}return a}function b(a,E,v){var d=this,L={enumerable:!0};d.hasBeenReset=!1;var k="",m=!1,o=a,c=E,l=v,p=null,y="",h=!0,S="auto",D="start",A=50,R="middle",u=50,g="middle";Object.defineProperty(d,"id",_({},L,{get:function(){return k},set:function(T){k=""+T}})),Object.defineProperty(d,"pauseOnExit",_({},L,{get:function(){return m},set:function(T){m=!!T}})),Object.defineProperty(d,"startTime",_({},L,{get:function(){return o},set:function(T){if(typeof T!="number")throw new TypeError("Start time must be set to a number.");o=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",_({},L,{get:function(){return c},set:function(T){if(typeof T!="number")throw new TypeError("End time must be set to a number.");c=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",_({},L,{get:function(){return l},set:function(T){l=""+T,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",_({},L,{get:function(){return p},set:function(T){p=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",_({},L,{get:function(){return y},set:function(T){var C=function(w){return s(i,w)}(T);if(C===!1)throw new SyntaxError("An invalid or illegal string was specified.");y=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",_({},L,{get:function(){return h},set:function(T){h=!!T,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",_({},L,{get:function(){return S},set:function(T){if(typeof T!="number"&&T!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");S=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",_({},L,{get:function(){return D},set:function(T){var C=f(T);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");D=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",_({},L,{get:function(){return A},set:function(T){if(T<0||T>100)throw new Error("Position must be between 0 and 100.");A=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",_({},L,{get:function(){return R},set:function(T){var C=f(T);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");R=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",_({},L,{get:function(){return u},set:function(T){if(T<0||T>100)throw new Error("Size must be between 0 and 100.");u=T,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",_({},L,{get:function(){return g},set:function(T){var C=f(T);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");g=C,this.hasBeenReset=!0}})),d.displayState=void 0}return b.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},b}()},"./src/utils/vttparser.ts":function(e,t,r){r.r(t),r.d(t,"parseTimeStamp",function(){return s}),r.d(t,"fixLineBreaks",function(){return v}),r.d(t,"VTTParser",function(){return d});var i=r("./src/utils/vttcue.ts"),n=function(){function L(){}return L.prototype.decode=function(k,m){if(!k)return"";if(typeof k!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(k))},L}();function s(L){function k(o,c,l,p){return 3600*(0|o)+60*(0|c)+(0|l)+parseFloat(p||0)}var m=L.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return m?parseFloat(m[2])>59?k(m[2],m[3],0,m[4]):k(m[1],m[2],m[3],m[4]):null}var f=function(){function L(){this.values=Object.create(null)}var k=L.prototype;return k.set=function(m,o){this.get(m)||o===""||(this.values[m]=o)},k.get=function(m,o,c){return c?this.has(m)?this.values[m]:o[c]:this.has(m)?this.values[m]:o},k.has=function(m){return m in this.values},k.alt=function(m,o,c){for(var l=0;l<c.length;++l)if(o===c[l]){this.set(m,o);break}},k.integer=function(m,o){/^-?\d+$/.test(o)&&this.set(m,parseInt(o,10))},k.percent=function(m,o){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(o)){var c=parseFloat(o);if(c>=0&&c<=100)return this.set(m,c),!0}return!1},L}();function _(L,k,m,o){var c=o?L.split(o):[L];for(var l in c)if(typeof c[l]=="string"){var p=c[l].split(m);p.length===2&&k(p[0],p[1])}}var b=new i.default(0,0,""),a=b.align==="middle"?"middle":"center";function E(L,k,m){var o=L;function c(){var p=s(L);if(p===null)throw new Error("Malformed timestamp: "+o);return L=L.replace(/^[^\sa-zA-Z-]+/,""),p}function l(){L=L.replace(/^\s+/,"")}if(l(),k.startTime=c(),l(),L.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+o);L=L.substr(3),l(),k.endTime=c(),l(),function(p,y){var h=new f;_(p,function(A,R){var u;switch(A){case"region":for(var g=m.length-1;g>=0;g--)if(m[g].id===R){h.set(A,m[g].region);break}break;case"vertical":h.alt(A,R,["rl","lr"]);break;case"line":u=R.split(","),h.integer(A,u[0]),h.percent(A,u[0])&&h.set("snapToLines",!1),h.alt(A,u[0],["auto"]),u.length===2&&h.alt("lineAlign",u[1],["start",a,"end"]);break;case"position":u=R.split(","),h.percent(A,u[0]),u.length===2&&h.alt("positionAlign",u[1],["start",a,"end","line-left","line-right","auto"]);break;case"size":h.percent(A,R);break;case"align":h.alt(A,R,["start",a,"end","left","right"])}},/:/,/\s/),y.region=h.get("region",null),y.vertical=h.get("vertical","");var S=h.get("line","auto");S==="auto"&&b.line===-1&&(S=-1),y.line=S,y.lineAlign=h.get("lineAlign","start"),y.snapToLines=h.get("snapToLines",!0),y.size=h.get("size",100),y.align=h.get("align",a);var D=h.get("position","auto");D==="auto"&&b.position===50&&(D=y.align==="start"||y.align==="left"?0:y.align==="end"||y.align==="right"?100:50),y.position=D}(L,k)}function v(L){return L.replace(/<br(?: \/)?>/gi,`
`)}var d=function(){function L(){this.state="INITIAL",this.buffer="",this.decoder=new n,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var k=L.prototype;return k.parse=function(m){var o=this;function c(){var S=o.buffer,D=0;for(S=v(S);D<S.length&&S[D]!=="\r"&&S[D]!==`
`;)++D;var A=S.substr(0,D);return S[D]==="\r"&&++D,S[D]===`
`&&++D,o.buffer=S.substr(D),A}m&&(o.buffer+=o.decoder.decode(m,{stream:!0}));try{var l="";if(o.state==="INITIAL"){if(!/\r\n|\n/.test(o.buffer))return this;var p=(l=c()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!p||!p[0])throw new Error("Malformed WebVTT signature.");o.state="HEADER"}for(var y=!1;o.buffer;){if(!/\r\n|\n/.test(o.buffer))return this;switch(y?y=!1:l=c(),o.state){case"HEADER":/:/.test(l)?_(l,function(S,D){},/:/):l||(o.state="ID");continue;case"NOTE":l||(o.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){o.state="NOTE";break}if(!l)continue;if(o.cue=new i.default(0,0,""),o.state="CUE",l.indexOf("-->")===-1){o.cue.id=l;continue}case"CUE":if(!o.cue){o.state="BADCUE";continue}try{E(l,o.cue,o.regionList)}catch{o.cue=null,o.state="BADCUE";continue}o.state="CUETEXT";continue;case"CUETEXT":var h=l.indexOf("-->")!==-1;if(!l||h&&(y=!0)){o.oncue&&o.cue&&o.oncue(o.cue),o.cue=null,o.state="ID";continue}if(o.cue===null)continue;o.cue.text&&(o.cue.text+=`
`),o.cue.text+=l;continue;case"BADCUE":l||(o.state="ID")}}}catch{o.state==="CUETEXT"&&o.cue&&o.oncue&&o.oncue(o.cue),o.cue=null,o.state=o.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},k.flush=function(){var m=this;try{if((m.cue||m.state==="HEADER")&&(m.buffer+=`

`,m.parse()),m.state==="INITIAL"||m.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(o){m.onparsingerror&&m.onparsingerror(o)}return m.onflush&&m.onflush(),this},L}()},"./src/utils/webvtt-parser.ts":function(e,t,r){r.r(t),r.d(t,"generateCueId",function(){return v}),r.d(t,"parseWebVTT",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/vttparser.ts"),s=r("./src/demux/id3.ts"),f=r("./src/utils/timescale-conversion.ts"),_=r("./src/remux/mp4-remuxer.ts"),b=/\r\n|\n\r|\n|\r/g,a=function(L,k,m){return m===void 0&&(m=0),L.substr(m,k.length)===k},E=function(L){for(var k=5381,m=L.length;m;)k=33*k^L.charCodeAt(--m);return(k>>>0).toString()};function v(L,k,m){return E(L.toString())+E(k.toString())+E(m)}function d(L,k,m,o,c,l,p,y){var h,S=new n.VTTParser,D=Object(s.utf8ArrayToStr)(new Uint8Array(L)).trim().replace(b,`
`).split(`
`),A=[],R=Object(f.toMpegTsClockFromTimescale)(k,m),u="00:00.000",g=0,T=0,C=!0,w=!1;S.oncue=function(I){var O=o[c],x=o.ccOffset,P=(g-R)/9e4;if(O!=null&&O.new&&(T!==void 0?x=o.ccOffset=O.start:function(G,V,X){var j=G[V],z=G[j.prevCC];if(!z||!z.new&&j.new)return G.ccOffset=G.presentationOffset=j.start,void(j.new=!1);for(;(W=z)!==null&&W!==void 0&&W.new;){var W;G.ccOffset+=j.start-z.start,j.new=!1,z=G[(j=z).prevCC]}G.presentationOffset=X}(o,c,P)),P&&(x=P-o.presentationOffset),w){var F=I.endTime-I.startTime,N=Object(_.normalizePts)(9e4*(I.startTime+x-T),9e4*l)/9e4;I.startTime=N,I.endTime=N+F}var U=I.text.trim();I.text=decodeURIComponent(encodeURIComponent(U)),I.id||(I.id=v(I.startTime,I.endTime,U)),I.endTime>0&&A.push(I)},S.onparsingerror=function(I){h=I},S.onflush=function(){h?y(h):p(A)},D.forEach(function(I){if(C){if(a(I,"X-TIMESTAMP-MAP=")){C=!1,w=!0,I.substr(16).split(",").forEach(function(O){a(O,"LOCAL:")?u=O.substr(6):a(O,"MPEGTS:")&&(g=parseInt(O.substr(7)))});try{T=function(O){var x=parseInt(O.substr(-3)),P=parseInt(O.substr(-6,2)),F=parseInt(O.substr(-9,2)),N=O.length>9?parseInt(O.substr(0,O.indexOf(":"))):0;if(!(Object(i.isFiniteNumber)(x)&&Object(i.isFiniteNumber)(P)&&Object(i.isFiniteNumber)(F)&&Object(i.isFiniteNumber)(N)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+O);return x+=1e3*P,(x+=6e4*F)+36e5*N}(u)/1e3}catch(O){w=!1,h=O}return}I===""&&(C=!1)}S.parse(I+`
`)}),S.flush()}},"./src/utils/xhr-loader.ts":function(e,t,r){r.r(t);var i=r("./src/utils/logger.ts"),n=r("./src/loader/load-stats.ts"),s=/^age:\s*[\d.]+\s*$/m,f=function(){function _(a){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=a?a.xhrSetup:null,this.stats=new n.LoadStats,this.retryDelay=0}var b=_.prototype;return b.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},b.abortInternal=function(){var a=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),a&&(a.onreadystatechange=null,a.onprogress=null,a.readyState!==4&&(this.stats.aborted=!0,a.abort()))},b.abort=function(){var a;this.abortInternal(),(a=this.callbacks)!==null&&a!==void 0&&a.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},b.load=function(a,E,v){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=a,this.config=E,this.callbacks=v,this.retryDelay=E.retryDelay,this.loadInternal()},b.loadInternal=function(){var a=this.config,E=this.context;if(a){var v=this.loader=new self.XMLHttpRequest,d=this.stats;d.loading.first=0,d.loaded=0;var L=this.xhrSetup;try{if(L)try{L(v,E.url)}catch{v.open("GET",E.url,!0),L(v,E.url)}v.readyState||v.open("GET",E.url,!0)}catch(k){return void this.callbacks.onError({code:v.status,text:k.message},E,v)}E.rangeEnd&&v.setRequestHeader("Range","bytes="+E.rangeStart+"-"+(E.rangeEnd-1)),v.onreadystatechange=this.readystatechange.bind(this),v.onprogress=this.loadprogress.bind(this),v.responseType=E.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),v.send()}},b.readystatechange=function(){var a=this.context,E=this.loader,v=this.stats;if(a&&E){var d=E.readyState,L=this.config;if(!v.aborted&&d>=2)if(self.clearTimeout(this.requestTimeout),v.loading.first===0&&(v.loading.first=Math.max(self.performance.now(),v.loading.start)),d===4){E.onreadystatechange=null,E.onprogress=null;var k=E.status;if(k>=200&&k<300){var m,o;if(v.loading.end=Math.max(self.performance.now(),v.loading.first),o=a.responseType==="arraybuffer"?(m=E.response).byteLength:(m=E.responseText).length,v.loaded=v.total=o,!this.callbacks)return;var c=this.callbacks.onProgress;if(c&&c(v,a,m,E),!this.callbacks)return;var l={url:E.responseURL,data:m};this.callbacks.onSuccess(l,v,a,E)}else v.retry>=L.maxRetry||k>=400&&k<499?(i.logger.error(k+" while loading "+a.url),this.callbacks.onError({code:k,text:E.statusText},a,E)):(i.logger.warn(k+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,L.maxRetryDelay),v.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),L.timeout)}},b.loadtimeout=function(){i.logger.warn("timeout while loading "+this.context.url);var a=this.callbacks;a&&(this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader))},b.loadprogress=function(a){var E=this.stats;E.loaded=a.loaded,a.lengthComputable&&(E.total=a.total)},b.getCacheAge=function(){var a=null;if(this.loader&&s.test(this.loader.getAllResponseHeaders())){var E=this.loader.getResponseHeader("age");a=E?parseFloat(E):null}return a},_}();t.default=f}}).default);var kn=jd(Oa.exports);const Gd={name:"d-icon"},Qe=Object.assign(Gd,{props:{icon:String,size:[Number,String]},setup:function(e){const t=e,r=Ce(()=>({fontSize:/^\d+$/.test(t.size)?t.size+"px":t.size}));return(i,n)=>(he(),ve("i",{class:lt(["d-icon iconfont",e.icon]),style:ot(re(r))},null,6))}});Qe.__scopeId="data-v-0c690e66";Ct("data-v-4cb76d59");const Kd={class:"d-player-top"},Hd={class:"top-title"},Vd={class:"top-title"};wt();const zd={props:{title:{default:""}},setup(e){Date.prototype.format=function(i){let n={"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};for(var s in n)new RegExp("("+s+")").test(i)&&(i=i.replace(RegExp.$1,RegExp.$1.length==1?n[s]:("00"+n[s]).substr((""+n[s]).length)));return i};let t=ht("00:00:00");t.value=new Date().format("hh:mm:ss");let r=null;return r=setInterval(()=>{t.value=new Date().format("hh:mm:ss")},1e3),Or(()=>{clearInterval(r)}),(i,n)=>(he(),ve("div",Kd,[Y("p",Hd,De(e.title||""),1),Y("p",Vd,De(re(t)),1)]))},__scopeId:"data-v-4cb76d59"};Ct("data-v-ac2469ec");const Wd={class:"d-status"},qd={class:"d-flex-center"},Yd={class:"d-flex-center"},$d=pe("5X速播放中 ");wt();var Pa=It({props:["state"],setup:e=>(t,r)=>Ge((he(),ve("div",Wd,[Ge(Y("li",qd,[ue(Qe,{size:"18",class:"d-status-icon",icon:"icon-volume-"+(e.state.volume==0?"mute":e.state.volume>.5?"up":"down")},null,8,["icon"]),pe(" "+De(~~(100*e.state.volume))+"% ",1)],512),[[Ve,e.state.handleType=="volume"]]),Ge(Y("li",Yd,[ue(Qe,{size:"12",icon:"icon-play"}),ue(Qe,{size:"12",icon:"icon-play",style:{"margin-right":"5px"}}),$d],512),[[Ve,e.state.handleType=="playbackRate"||e.state.isMultiplesPlay]])],512)),[[Ve,e.state.handleType||e.state.isMultiplesPlay]])});Pa.__scopeId="data-v-ac2469ec",Ct("data-v-385f7870");const Xd=["checked","true-value","false-value"],Qd=Y("span",{class:"d-switch_action"},null,-1);wt();var Vr=It({props:{modelValue:{type:[Number,String,Boolean]},width:{type:String,default:"40px"},trueValue:{type:[Number,String,Boolean],default:!0},falseValue:{type:[Number,String,Boolean],default:!0},activeColor:{type:[String],default:"#409EFF"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const r=e;pi(f=>({"014e5dc0":e.width,e4e32852:e.activeColor}));const i=ht(null),n=Ce(()=>r.modelValue===r.trueValue),s=()=>{sn(()=>{const f=i.value.checked;t("update:modelValue",f),t("change",f)})};return(f,_)=>(he(),ve("div",{class:lt(["d-switch",{"is-checked":re(n)}])},[Y("input",{class:"d-switch__input",ref:i,type:"checkbox",checked:re(n),onChange:s,"true-value":e.trueValue,"false-value":e.falseValue},null,40,Xd),Qd],2))}});Vr.__scopeId="data-v-385f7870",Ct("data-v-b2384226");const Jd={key:0},Zd=Y("i",{class:"rotating iconfont icon-loading f50"},null,-1),ef=[Y("i",{class:"rotating iconfont icon-loading f50"},null,-1),Y("p",null,"正在缓冲...",-1)],tf=[Y("i",{class:"iconfont icon-replay f24 mr5"},null,-1),pe("重新播放 ")],rf=[Y("i",{class:"iconfont icon-replay f24 mr5"},null,-1),pe("请求错误 ")];wt();var Fa=It({props:{loadType:String,text:{type:String,default:""}},setup(e){const t=e,{proxy:r}=fn(),i=["loadstart","waiting","ended","error","stalled"],n=()=>{r.$parent.play()},s=Ce(()=>{let f="background: rgba(0, 0, 0, .1);z-index:1";return t.loadType=="loadstart"&&(f="background: rgba(0, 0, 0, 1);;z-index:3"),f});return(f,_)=>Ge((he(),ve("div",{class:"d-loading",style:ot(re(s))},[Y("div",null,[e.loadType=="loadstart"?(he(),ve("span",Jd,[Zd,Y("p",null,De(e.text),1)])):je("",!0),Ge(Y("span",null,ef,512),[[Ve,e.loadType=="waiting"]]),Ge(Y("span",null,[Y("p",{onClick:n,class:"d-flex-x d-pointer"},tf)],512),[[Ve,e.loadType=="ended"]]),Ge(Y("span",null,[Y("p",{onClick:n,class:"d-flex-x d-pointer"},rf)],512),[[Ve,e.loadType=="error"||e.loadType=="stalled"]])])],4)),[[Ve,i.includes(e.loadType)]])}});Fa.__scopeId="data-v-b2384226";const Vt=function(e,t,r,i=!1){e&&t&&r&&e.addEventListener(t,r,i)},He=function(e,t,r,i=!1){e&&t&&r&&e.removeEventListener(t,r,i)};Ct("data-v-5a794390");const nf=["onMousedown"];wt();var rr=It(qn(Wn({},{name:"DSlider"}),{props:{modelValue:{required:!0,type:Number,default:0},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},hoverText:{type:String,default:""},preload:{type:Number,default:0},size:{type:String,default:"10px"}},emits:["update:modelValue","change","onMousemove"],setup:function(e,{emit:t}){const r=e;pi(o=>({"5242b67b":e.size}));const i=ht(null),n=ht(null),s=vt({dragging:!1,hoverPosition:0,hoverTipsLeft:"50%"}),f=Ce(()=>{let o=r.modelValue<0?0:r.modelValue>1?1:r.modelValue;return r.vertical?`height:${100*o}%`:`width:${100*o}%`}),_=Ce(()=>{let o=r.preload<0?0:r.preload>1?1:r.preload;return r.vertical?`height:${100*o}%`:`width:${100*o}%`}),b=Ce(()=>{let o=s.hoverPosition<0?0:s.hoverPosition>1?1:s.hoverPosition;return r.vertical?`bottom:${100*o}%`:`left:${100*o}%`}),a=o=>{o.preventDefault()},E=o=>{r.disabled||(o.preventDefault(),s.dragging=!0,d(o),Vt(window,"mousemove",k),Vt(window,"touchmove",k),Vt(window,"mouseup",m),Vt(window,"touchend",m))},v=o=>{if(!r.hover)return;let c=L(o);if(t("onMousemove",o,c),s.hoverPosition=c,r.vertical)return;let l=i.value,p=n.value.clientWidth/2,y=o.clientX-l.getBoundingClientRect().left;y<p?s.hoverTipsLeft=p-y+"px":l.clientWidth-y<p?s.hoverTipsLeft=l.clientWidth-y-p+"px":s.hoverTipsLeft="50%"},d=o=>{let c=L(o);t("update:modelValue",c),t("change",o,c)},L=o=>{let c=i.value,l=0;if(r.vertical){let p=c.clientHeight;l=(c.getBoundingClientRect().bottom-o.clientY)/p}else l=(o.clientX-c.getBoundingClientRect().left)/c.clientWidth;return l<0?0:l>1?1:l},k=o=>{d(o)},m=o=>{s.dragging&&(He(window,"mousemove",k),He(window,"touchmove",k),He(window,"mouseup",m),He(window,"touchend",m),He(window,"contextmenu",m),setTimeout(()=>{s.dragging=!1},0))};return(o,c)=>(he(),ve("div",{ref:i,class:lt(["d-slider",{"is-vertical":r.vertical}]),onMousedown:cu(E,["stop"]),onContextmenu:a},[Y("div",{class:"d-slider__runway",onMousemove:v},[Ge(Y("div",{class:"d-slider__cursor",style:ot(re(b))},[Ge(Y("div",{class:"d-slider__tips",ref:n,style:ot({left:re(s).hoverTipsLeft})},De(r.hoverText),5),[[Ve,r.hoverText]])],4),[[Ve,r.hover]]),Y("div",{class:"d-slider__preload",style:ot(re(_))},null,4),Y("div",{class:"d-slider__bar",style:ot(re(f))},null,4)],32)],42,nf))}}));rr.__scopeId="data-v-5a794390";Ct("data-v-570fa0d1");const sf={key:0,class:"d-player-dialog"},af={class:"d-player-dialog-body"},of={class:"d-player-dialog-title"},lf={class:"d-player-hotkey-panel"},uf={class:"d-player-filter-panel"},cf={class:"d-player-filter-panel-item"},df=Y("span",null,"饱和度",-1),ff={class:"d-player-filter-panel-item"},hf=Y("span",null,"亮度",-1),gf={class:"d-player-filter-panel-item"},pf=Y("span",null,"对比度",-1),vf={key:0,class:"d-player-contextmenu"},mf=["dplayerKeyCode"],yf=Y("input",{class:"d-player-copyText"},null,-1);wt();var Ma=It({setup(e){const t=vt({show:!1,dialogType:"",dialogTitle:"",version:"1.3.1-beta.6",mouseX:0,mouseY:0}),r=[{label:"视频色彩调整",key:"filter"},{label:"快捷键说明",key:"hotkey"},{label:"复制视频网址",key:"copy"},{label:"版本：1.3.1-beta.6",key:"version"}],i=[{key:"Space",label:"播放/暂停"},{key:"→",label:"单次快进10s，长按5倍速播放"},{key:"←",label:"快退5s"},{key:"↑",label:"音量增加10%"},{key:"↓",label:"音量增加降低10%"},{key:"Esc",label:"退出全屏/退出网页全屏"},{key:"F",label:"全屏/退出全屏"}],n=vt({saturate:.392,brightness:.392,contrast:.392}),s=Ce(()=>({left:t.mouseX+"px",top:t.mouseY+"px"}));tr(n,E=>{let v=document.querySelector("#dPlayerVideo"),d=(2.55*E.saturate).toFixed(2),L=(2.55*E.brightness).toFixed(2),k=(2.55*E.contrast).toFixed(2);v.style.filter=`saturate(${d}) brightness(${L}) contrast(${k})`});const f=()=>{n.saturate=.392,n.brightness=.392,n.contrast=.392},_=E=>{E.key=="Escape"&&a(0)},b=E=>{E.preventDefault(),Vt(window,"keydown",_),Vt(window,"click",a);let v=document.querySelector("#refPlayerWrap"),d=v.clientWidth;v.clientHeight,t.mouseX=E.clientX-v.getBoundingClientRect().left,d-t.mouseX<130&&(t.mouseX=t.mouseX+(d-t.mouseX-130)),t.mouseY=E.clientY-v.getBoundingClientRect().top,t.show=!0},a=E=>{let v=E.path[0].tagName=="LI",d=E.path[0].attributes.dplayerKeyCode&&E.path[0].attributes.dplayerKeyCode.value,L=r.map(k=>k.key);if(v&&L.includes(d))if(t.dialogTitle=E.path[0].innerText,t.dialogType=d,d=="copy"){let k=document.querySelector(".d-player-copyText");k.value=window.location.href,k.select(),document.execCommand("copy"),t.dialogType=""}else d=="version"&&(t.dialogType="");t.show=!1,He(window,"keydown",_),He(window,"click",a)};return xr(()=>{let E=document.querySelector("#refPlayerWrap");He(window,"keydown",_),He(window,"click",a),He(E,"contextmenu",b),Vt(E,"contextmenu",b)}),Or(()=>{let E=document.querySelector("#refPlayerWrap");He(window,"keydown",_),He(window,"click",a),He(E,"contextmenu",b)}),(E,v)=>(he(),ve("div",null,[ue(Cr,{name:"d-fade-in"},{default:Re(()=>[re(t).dialogType?(he(),ve("div",sf,[Y("div",af,[Y("h5",of,[pe(De(re(t).dialogTitle)+" ",1),Y("i",{onClick:v[0]||(v[0]=d=>re(t).dialogType=!1),class:"icon icon-close"},"X")]),Ge(Y("ul",lf,[(he(),ve(xe,null,Yr(i,d=>Y("li",{class:"d-player-hotkey-panel-item",key:d.key},[Y("span",null,De(d.key),1),Y("span",null,De(d.label),1)])),64))],512),[[Ve,re(t).dialogType=="hotkey"]]),Ge(Y("ul",uf,[Y("li",cf,[df,ue(rr,{class:"filter-panel-slider",size:"5px",modelValue:re(n).saturate,"onUpdate:modelValue":v[1]||(v[1]=d=>re(n).saturate=d)},null,8,["modelValue"]),Y("span",null,De(Math.round(255*re(n).saturate)),1)]),Y("li",ff,[hf,ue(rr,{class:"filter-panel-slider",size:"5px",modelValue:re(n).brightness,"onUpdate:modelValue":v[2]||(v[2]=d=>re(n).brightness=d)},null,8,["modelValue"]),Y("span",null,De(Math.round(255*re(n).brightness)),1)]),Y("li",gf,[pf,ue(rr,{class:"filter-panel-slider",size:"5px",modelValue:re(n).contrast,"onUpdate:modelValue":v[3]||(v[3]=d=>re(n).contrast=d)},null,8,["modelValue"]),Y("span",null,De(Math.round(255*re(n).contrast)),1)]),Y("span",{onClick:f,title:"重置","aria-label":"重置",class:"d-player-filter-reset"},"重置")],512),[[Ve,re(t).dialogType=="filter"]])])])):je("",!0)]),_:1}),re(t).show?(he(),ve("div",vf,[Y("ul",{class:"d-player-contextmenu-body",style:ot(re(s))},[(he(),ve(xe,null,Yr(r,d=>Y("li",{dplayerKeyCode:d.key,key:d.key},De(d.label),9,mf)),64))],4),yf])):je("",!0)]))}});Ma.__scopeId="data-v-570fa0d1";const Rn=e=>{let t=~~(e/3600),r=~~(e%3600/60),i=~~(e%60);return t=t<10?"0"+t:t,r=r<10?"0"+r:r,i=i<10?"0"+i:i,`${t}:${r}:${i}`},gr="ontouchstart"in window,Ss=["loadstart","play","pause","playing","seeking","seeked","waiting","durationchange","progress","canplay","timeupdate","ended","error","stalled"],Ef={width:{type:String,default:"800px"},height:{type:String,default:"450px"},color:{type:String,default:"#409eff"},src:{required:!0,type:String,default:""},title:{type:String,default:""},type:{type:String,default:"video/mp4"},poster:{type:String,default:""},webFullScreen:{type:Boolean,default:!1},speed:{type:Boolean,default:!0},currentTime:{type:Number,default:0},playsinline:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},speedRate:{type:Array,default:()=>["2.0","1.5","1.25","1.0","0.75","0.5"]},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},mirror:{type:Boolean,default:!1},ligthOff:{type:Boolean,default:!1},volume:{type:[String,Number],default:.3},control:{type:Boolean,default:!0},controlBtns:{type:Array,default:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},preload:{type:String,default:"auto"}};Ct("data-v-01791e9e");const Tf={class:"d-player-video",id:"dPlayerVideo"},bf=["controls","webkit-playsinline","playsinline","volume","muted","loop","preload","src","poster"],Sf={class:"d-player-lightoff"},_f={key:1,class:"d-player-state"},Af={class:"d-play-btn"},Lf=["onKeyup","onKeydown"],kf={class:"d-control-progress"},Rf={class:"d-tool-bar"},Df={key:0,class:"d-tool-item d-tool-time audioTrack-btn"},Cf=Y("span",{style:{margin:"0 3px"}},"/",-1),wf={class:"total-time"},If={class:"d-tool-bar"},xf={key:0,class:"d-tool-item quality-btn"},Of={class:"d-tool-item-main"},Pf={class:"speed-main",style:{"text-align":"center"}},Ff=["onClick"],Mf={key:1,class:"d-tool-item speedRate-btn"},Nf={class:"d-tool-item-main"},Bf={class:"speed-main"},Uf=["onClick"],jf={key:2,class:"d-tool-item volume-btn"},Gf={class:"d-tool-item-main volume-box",style:{width:"52px"}},Kf={class:"volume-text-size"},Hf={key:3,class:"d-tool-item setting-btn"},Vf={class:"d-tool-item-main"},zf={class:"speed-main"},Wf=pe(" 镜像画面 "),qf=pe(" 循环播放 "),Yf=pe(" 关灯模式 "),$f=Y("div",{class:"d-tool-item-main"},"画中画",-1),Xf=Y("div",{class:"d-tool-item-main"},"网页全屏",-1),Qf=Y("div",{class:"d-tool-item-main"},"全屏",-1);wt();var Ir=It(qn(Wn({},{name:"vue3VideoPlay",inheritAttrs:!1}),{props:Ef,emits:[...Ss,"mirrorChange","loopChange","lightOffChange"],setup:function(e,{expose:t,emit:r}){const i=e;pi(x=>({"51d4439c":re(L),"77e758a6":x.width,b8a1afc0:x.height}));const n=new kn({fragLoadingTimeOut:2e3}),s=ht(null),f=ht(null),_=ht(null),b=ht(null),a=vt(qn(Wn({dVideo:null},i),{muted:i.muted,playBtnState:i.autoPlay?"pause":"play",loadStateType:"loadstart",fullScreen:!1,handleType:"",currentTime:"00:00:00",preloadBar:0,totalTime:"00:00:00",isVideoHovering:!0,speedActive:"1.0",playProgress:0,isMultiplesPlay:!1,longPressTimeout:null,progressCursorTime:"00:00:00",qualityLevels:[],currentLevel:0})),E=(...x)=>P=>x.reverse().reduce((F,N)=>N(F),P),v=Ss.reduce((x,P)=>{var F;return x[`on${F=P,F.charAt(0).toUpperCase()+F.slice(1)}`]=N=>{a.loadStateType=P,r(P,N)},x},{});v.onCanplay=E(v.onCanplay,()=>{a.playBtnState!="play"&&a.dVideo.play(),a.autoPlay&&(a.dVideo.play(),a.playBtnState="pause")}),v.onEnded=E(v.onEnded,()=>{a.playBtnState="replay"}),v.onDurationchange=x=>{r("durationchange",x),i.currentTime!=0&&(a.dVideo.currentTime=i.currentTime),v.onTimeupdate(x)},v.onProgress=x=>{console.log("缓冲中..."),r("progress",x);let P=x.target.duration,F=x.target.buffered,N=x.target.buffered.length&&x.target.buffered.end(F-1);a.preloadBar=N/P},v.onTimeupdate=x=>{r("timeupdate",x);let P=x.duration||x.target.duration||0,F=x.currentTime||x.target.currentTime;a.playProgress=F/P,a.currentTime=Rn(F),a.totalTime=Rn(P)},v.onError=E(v.onError,()=>{a.playBtnState="replay"});let d=Fl();for(let x in d)v[x]=d[x];const L=(k=a.color,`${parseInt("0x"+k.slice(1,3))},${parseInt("0x"+k.slice(3,5))},${parseInt("0x"+k.slice(5,7))}`);var k;const m=bs(500,()=>{a.handleType=""}),o=x=>{x.preventDefault(),x.code=="ArrowUp"?a.volume=a.volume+.1>1?1:a.volume+.1:a.volume=a.volume-.1<0?0:a.volume-.1,a.muted=!1,a.handleType="volume",m()},c=x=>{i.speed&&(a.dVideo.currentTime=a.dVideo.currentTime<10?.1:a.dVideo.currentTime-10,v.onTimeupdate(a.dVideo),y())},l=x=>{x.preventDefault();let P=x.type;if(x.key=="ArrowRight"){if(y(),P=="keyup"){if(clearTimeout(a.longPressTimeout),!i.speed&&!a.longPressTimeout)return;a.isMultiplesPlay?(a.dVideo.playbackRate=a.speedActive,a.isMultiplesPlay=!1):(a.dVideo.currentTime=a.dVideo.currentTime+10,v.onTimeupdate(a.dVideo))}else if(P=="keydown"){if(!i.speed)return;a.isMultiplesPlay&&clearTimeout(a.longPressTimeout),a.longPressTimeout=setTimeout(()=>{a.isMultiplesPlay=!0,a.dVideo.playbackRate=5,a.handleType="playbackRate",m()},500)}}},p=()=>{gr||b.value.focus()},y=()=>{a.loadStateType="play",a.dVideo.play().catch(()=>{setTimeout(()=>{a.playBtnState="replay",a.loadStateType="error"},500)}),a.playBtnState="pause"},h=()=>{a.dVideo.pause(),a.playBtnState="play"},S=x=>{x&&x.preventDefault(),a.playBtnState=="play"||a.playBtnState=="replay"?y():a.playBtnState=="pause"&&h()},D=()=>{a.muted=!a.muted,a.volume==0&&(a.volume=.05)},A=(x,P)=>{let F=a.dVideo.duration||a.dVideo.target.duration;a.dVideo.currentTime=F*P,a.playBtnState=="play"&&(a.dVideo.play(),a.playBtnState="pause")},R=(x,P)=>{a.progressCursorTime=Rn(a.dVideo.duration*P)},u=bs(2500,()=>{a.isVideoHovering=!1}),g=x=>{a.isVideoHovering=!0,u()},T=x=>{r("mirrorChange",x,a.dVideo)},C=x=>{r("loopChange",x,a.dVideo)},w=x=>{r("lightOffChange",x,a.dVideo)},I=()=>{var x;x=a.dVideo,document.pictureInPictureElement?document.exitPictureInPicture().catch(P=>{console.log(P,"Video failed to leave Picture-in-Picture mode.")}):x.requestPictureInPicture().catch(P=>{console.log(P,"Video failed to enter Picture-in-Picture mode.")})},O=()=>{a.fullScreen=(x=>{let P=document,F=P.webkitIsFullScreen||P.fullscreen;return F?(document.exitFullscreen||P.webkitExitFullScreen).call(P):(x.requestFullscreen||x.webkitRequestFullScreen).call(x),!F})(s.value)};return tr(()=>i.src,()=>{sn(()=>{a.dVideo.canPlayType(i.type)||a.dVideo.canPlayType("application/vnd.apple.mpegurl")?a.muted=i.autoPlay:kn.isSupported()&&(n.detachMedia(),n.attachMedia(a.dVideo),n.on(kn.Events.MEDIA_ATTACHED,()=>{n.loadSource(i.src),n.on("hlsManifestParsed",(x,P)=>{console.log(P),a.currentLevel=P.level,a.qualityLevels=P.levels||[]})}),n.on("hlsLevelSwitching",(x,P)=>{console.log(P),console.log("LEVEL_SWITCHING")}),n.on("hlsLevelSwitched",(x,P)=>{a.currentLevel=P.level,console.log("LEVEL_SWITCHED")}))})},{immediate:!0}),xr(()=>{a.dVideo=f,p()}),t({play:y,pause:h,togglePlay:S}),(x,P)=>(he(),ve("div",{ref:s,id:"refPlayerWrap",class:lt(["d-player-wrap",{"web-full-screen":re(a).webFullScreen,"is-lightoff":re(a).lightOff,"d-player-wrap-hover":re(a).playBtnState=="play"||re(a).isVideoHovering}]),onMousemove:g},[Y("div",Tf,[Y("video",hi({ref:f,class:["d-player-video-main",{"video-mirror":re(a).mirror}],id:"dPlayerVideoMain",controls:!(!re(gr)||!re(a).speed),"webkit-playsinline":i.playsinline,playsinline:i.playsinline},re(v),{volume:re(a).volume,muted:re(a).muted,loop:re(a).loop,preload:x.preload,width:"100%",height:"100%",src:i.src,poster:i.poster}),"您的浏览器不支持Video标签。",16,bf)]),ue(Cr,{name:"d-fade-in"},{default:Re(()=>[Ge(Y("div",Sf,null,512),[[Ve,re(a).lightOff]])]),_:1}),re(a).fullScreen?(he(),di(zd,{key:0,title:i.title},null,8,["title"])):je("",!0),re(gr)?je("",!0):(he(),ve("div",_f,[ue(Cr,{name:"d-scale-out"},{default:Re(()=>[Ge(Y("div",Af,[ue(Qe,{icon:"icon-play",size:40})],512),[[Ve,re(a).playBtnState=="play"]])]),_:1}),ue(Pa,{state:re(a)},null,8,["state"])])),re(gr)?je("",!0):(he(),ve("input",{key:2,type:"input",readonly:"readonly",ref:b,onDblclick:O,onKeyup:[cr(O,["f"]),P[0]||(P[0]=cr(F=>re(a).webFullScreen=!1,["esc"])),l],onClick:S,onKeydown:[cr(S,["space"]),cr(c,["arrow-left"]),cr(o,["arrow-up","arrow-down"]),l],class:"d-player-input",maxlength:"0"},null,40,Lf)),ue(Fa,{loadType:re(a).loadStateType},null,8,["loadType"]),ue(Ma),!re(gr)&&re(a).control?(he(),ve("div",{key:3,class:"d-player-control",ref:_},[Y("div",kf,[ue(rr,{class:"d-progress-bar",onOnMousemove:R,onChange:A,disabled:!re(a).speed,hoverText:re(a).progressCursorTime,modelValue:re(a).playProgress,"onUpdate:modelValue":P[1]||(P[1]=F=>re(a).playProgress=F),preload:re(a).preloadBar},null,8,["disabled","hoverText","modelValue","preload"])]),Y("div",{class:"d-control-tool",onClick:p},[Y("div",Rf,[Y("div",{class:"d-tool-item",onClick:S},[ue(Qe,{size:"24",icon:`icon-${re(a).playBtnState}`},null,8,["icon"])]),i.controlBtns.includes("audioTrack")?(he(),ve("div",Df,[Y("span",null,De(re(a).currentTime),1),Cf,Y("span",wf,De(re(a).totalTime),1)])):je("",!0)]),Y("div",If,[re(a).qualityLevels.length&&i.controlBtns.includes("quality")?(he(),ve("div",xf,[pe(De(re(a).qualityLevels.length&&(re(a).qualityLevels[re(a).currentLevel]||{}).height)+"P ",1),Y("div",Of,[Y("ul",Pf,[(he(!0),ve(xe,null,Yr(re(a).qualityLevels,(F,N)=>(he(),ve("li",{class:lt({"speed-active":re(a).currentLevel==N}),onClick:U=>((G,V)=>{n.currentLevel=V,a.currentLevel=V})(0,N),key:F},De(F.height)+"P",11,Ff))),128))])])])):je("",!0),i.controlBtns.includes("speedRate")?(he(),ve("div",Mf,[pe(De(re(a).speedActive=="1.0"?"倍速":re(a).speedActive+"x")+" ",1),Y("div",Nf,[Y("ul",Bf,[(he(!0),ve(xe,null,Yr(re(a).speedRate,F=>(he(),ve("li",{class:lt({"speed-active":re(a).speedActive==F}),onClick:N=>(U=>{a.speedActive=U,a.dVideo.playbackRate=U})(F),key:F},De(F)+"x",11,Uf))),128))])])])):je("",!0),i.controlBtns.includes("volume")?(he(),ve("div",jf,[Y("div",Gf,[Y("div",{class:lt(["volume-main",{"is-muted":re(a).muted}])},[Y("span",Kf,De(re(a).muted?0:~~(100*re(a).volume))+"%",1),ue(rr,{onChange:P[2]||(P[2]=F=>re(a).muted=!1),hover:!1,size:"5px",vertical:!0,modelValue:re(a).volume,"onUpdate:modelValue":P[3]||(P[3]=F=>re(a).volume=F)},null,8,["modelValue"])],2)]),Y("span",{onClick:D,style:{display:"flex"}},[ue(Qe,{size:"20",icon:"icon-volume-"+(re(a).volume==0||re(a).muted?"mute":re(a).volume>.5?"up":"down")},null,8,["icon"])])])):je("",!0),i.controlBtns.includes("setting")?(he(),ve("div",Hf,[ue(Qe,{size:"20",class:"rotateHover",icon:"icon-settings"}),Y("div",Vf,[Y("ul",zf,[Y("li",null,[Wf,ue(Vr,{onChange:T,modelValue:re(a).mirror,"onUpdate:modelValue":P[4]||(P[4]=F=>re(a).mirror=F)},null,8,["modelValue"])]),Y("li",null,[qf,ue(Vr,{onChange:C,modelValue:re(a).loop,"onUpdate:modelValue":P[5]||(P[5]=F=>re(a).loop=F)},null,8,["modelValue"])]),Y("li",null,[Yf,ue(Vr,{onChange:w,modelValue:re(a).lightOff,"onUpdate:modelValue":P[6]||(P[6]=F=>re(a).lightOff=F)},null,8,["modelValue"])])])])])):je("",!0),i.controlBtns.includes("pip")?(he(),ve("div",{key:4,class:"d-tool-item pip-btn",onClick:I},[ue(Qe,{size:"20",icon:"icon-pip"}),$f])):je("",!0),i.controlBtns.includes("pageFullScreen")?(he(),ve("div",{key:5,class:"d-tool-item pip-btn",onClick:P[7]||(P[7]=F=>re(a).webFullScreen=!re(a).webFullScreen)},[ue(Qe,{size:"20",icon:"icon-web-screen"}),Xf])):je("",!0),i.controlBtns.includes("fullScreen")?(he(),ve("div",{key:6,class:"d-tool-item fullScreen-btn",onClick:O},[Qf,ue(Qe,{size:"20",icon:"icon-screen"})])):je("",!0)])])],512)):je("",!0)],34))}}));function Jf(e){e.component(Ir.name,Ir)}Ir.__scopeId="data-v-01791e9e",Ir.install=Jf;const Ei=gu(wc);Ei.use(Pd);Ei.use(Ir);Ei.mount("#app");export{xt as _,Y as a,ve as c,he as o};
